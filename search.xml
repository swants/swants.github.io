<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Swift ç½‘ç»œå•å…ƒæµ‹è¯•å®Œå…¨æ‰‹å†Œ]]></title>
    <url>%2F2018%2F03%2F17%2FSwift-%E7%BD%91%E7%BB%9C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%AE%8C%E5%85%A8%E6%89%8B%E5%86%8C.html</url>
    <content type="text"><![CDATA[ä¸å¾—ä¸æ‰¿è®¤ï¼Œå¯¹äºŽ iOS å¼€å‘å†™æµ‹è¯•å¹¶ä¸æ˜¯å¾ˆæ™®é(è‡³å°‘å’ŒåŽç«¯å†™æµ‹è¯•ç¨‹åº¦ç›¸æ¯”)ã€‚æˆ‘è¿‡åŽ»æ˜¯ä¸ªç‹¬ç«‹å¼€å‘è€…è€Œä¸”æœ€åˆä¹Ÿæ²¡ç»è¿‡åŽŸç”Ÿâ€œæµ‹è¯•é©±åŠ¨â€çš„å¼€å‘åŸ¹è®­ï¼Œå› æ­¤æˆ‘èŠ±è´¹äº†å¤§é‡çš„æ—¶é—´æ¥å­¦ä¹ å¦‚ä½•ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œå¦‚ä½•å†™å‡ºå¯æµ‹è¯•çš„ä»£ç ã€‚è¿™ä¹Ÿæ˜¯æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„åˆè¡·ï¼Œæˆ‘æƒ³æŠŠè‡ªå·±ç”¨ Swift å†™æµ‹è¯•æ—¶æ‘¸ç´¢åˆ°çš„å¿ƒå¾—åˆ†äº«ç»™å¤§å®¶ï¼Œå¸Œæœ›æˆ‘çš„è§è§£èƒ½å¤Ÿå¸®åŠ©å¤§å®¶èŠ‚çœå­¦ä¹ æ—¶é—´ï¼Œå°‘èµ°äº›å¼¯è·¯ã€‚ åœ¨è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†ä¼šè®¨è®ºç€æ‰‹å†™æµ‹è¯•çš„å…¥é—¨çŸ¥è¯†ï¼šä¾èµ–æ³¨å…¥ã€‚ æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­¤æ—¶æ­£åœ¨å†™æµ‹è¯•ã€‚å¦‚æžœä½ çš„æµ‹è¯•å¯¹è±¡(è¢«æµ‹ç³»ç»Ÿ)æ˜¯å’ŒçœŸå®žä¸–ç•Œç›¸è¿žçš„ï¼Œæ¯”å¦‚ Networking å’Œ CoreDataï¼Œç¼–å†™æµ‹è¯•ä»£ç å°†ä¼šéžå¸¸å¤æ‚ã€‚åŽŸåˆ™ä¸Šè®²ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æˆ‘ä»¬çš„æµ‹è¯•ä»£ç è¢«å®¢è§‚ä¸–ç•Œçš„äº‹ç‰©æ‰€å½±å“ã€‚è¢«æµ‹ç³»ç»Ÿä¸åº”ä¾èµ–äºŽå…¶ä»–çš„å¤æ‚ç³»ç»Ÿï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å¤Ÿä¿è¯åœ¨æ—¶é—´æ’å®šå’ŒçŽ¯å¢ƒæ’å®šæ¡ä»¶ä¸‹è¿…é€Ÿå®Œæˆæµ‹è¯•ã€‚å†µä¸”ï¼Œä¿è¯æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ä¸ä¼šâ€œæ±¡æŸ“â€ç”Ÿäº§çŽ¯å¢ƒä¹Ÿæ˜¯ååˆ†é‡è¦çš„ã€‚â€œæ±¡æŸ“â€æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ„å‘³ç€æˆ‘ä»¬çš„æµ‹è¯•ä»£ç å°†ä¸€äº›æµ‹è¯•å¯¹è±¡å†™è¿›äº†æ•°æ®åº“ï¼Œæäº¤äº†äº›æµ‹è¯•æ•°æ®åˆ°ç”Ÿäº§æœåŠ¡å™¨ç­‰ç­‰ã€‚è€Œé¿å…è¿™äº›æƒ…å†µçš„å‘ç”Ÿå°±æ˜¯ ä¾èµ–æ³¨å…¥ å­˜åœ¨çš„æ„ä¹‰ã€‚ è®©æˆ‘ä»¬ä»Žä¸€ä¸ªä¾‹å­å¼€å§‹ã€‚å‡è®¾ä½ æ‹¿åˆ°ä¸ªåº”è¯¥è”ç½‘å¹¶ä¸”åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸‹æ‰èƒ½è¢«æ‰§è¡Œçš„ç±»ï¼Œè”ç½‘éƒ¨åˆ†å°±è¢«ç§°ä½œè¯¥ç±»çš„ ä¾èµ–ã€‚å¦‚ä¹‹å‰æ‰€è¨€ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œæµ‹è¯•æ—¶è¿™ä¸ªç±»çš„è”ç½‘éƒ¨åˆ†å¿…é¡»èƒ½å¤Ÿè¢«æ¨¡æ‹Ÿçš„ï¼Œæˆ–è€…å‡çš„çŽ¯å¢ƒæ‰€æ›¿æ¢ã€‚æ¢å¥è¯è¯´ï¼Œè¯¥ç±»çš„ä¾èµ–å¿…é¡»æ”¯æŒâ€œå¯æ³¨å…¥â€ï¼Œä¾èµ–æ³¨å…¥ä½¿æˆ‘ä»¬çš„ç³»ç»Ÿæ›´åŠ çµæ´»ã€‚æˆ‘ä»¬èƒ½å¤Ÿä¸ºç”Ÿäº§ä»£ç â€œæ³¨å…¥â€çœŸå®žçš„ç½‘ç»œçŽ¯å¢ƒï¼›ä¸Žæ­¤åŒæ—¶ï¼Œä¹Ÿèƒ½å¤Ÿâ€œæ³¨å…¥â€æ¨¡æ‹Ÿçš„ç½‘ç»œçŽ¯å¢ƒæ¥è®©æˆ‘ä»¬åœ¨ä¸è®¿é—®äº’è”ç½‘çš„æ¡ä»¶ä¸‹è¿è¡Œæµ‹è¯•ä»£ç ã€‚ TL;DR è¯‘è€…æ³¨ï¼šTL;DR æ˜¯ Too long;Donâ€™t read çš„ç¼©å†™ã€‚åœ¨è¿™é‡Œçš„æ„æ€æ˜¯ç¯‡å¹…è¾ƒé•¿ï¼Œä¸æƒ³æ·±å…¥ç ”ç©¶ï¼Œè¯·ç›´æŽ¥çœ‹æ–‡ç« æ€»ç»“ã€‚ åœ¨è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å°†ä¼šè®¨è®ºï¼š å¦‚ä½•ä½¿ç”¨ ä¾èµ–æ³¨å…¥ æŠ€æœ¯è®¾è®¡ä¸€ä¸ªå¯¹è±¡ åœ¨ Swift ä¸­å¦‚ä½•ä½¿ç”¨åè®®è®¾è®¡ä¸€ä¸ªæ¨¡æ‹Ÿå¯¹è±¡ å¦‚ä½•æµ‹è¯•å¯¹è±¡ä½¿ç”¨çš„æ•°æ®åŠå¦‚ä½•æµ‹è¯•å¯¹è±¡çš„è¡Œä¸º ä¾èµ–æ³¨å…¥å¼€å§‹åŠ¨æ‰‹å§! çŽ°åœ¨æˆ‘ä»¬æ‰“ç®—å®žçŽ°ä¸€ä¸ªå«åš HttpClient çš„ç±»ã€‚è¿™ä¸ª HttpClient åº”è¯¥æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼š HttpClient è·Ÿåˆå§‹çš„ç½‘ç»œç»„ä»¶å¯¹äºŽåŒä¸€ URL åº”æäº¤åŒæ ·çš„ requestã€‚ HttpClient åº”èƒ½å¤Ÿæäº¤ requestã€‚ æ‰€ä»¥æˆ‘ä»¬å¯¹ HttpClient çš„åˆæ¬¡å®žçŽ°æ˜¯è¿™æ ·çš„ï¼š 1234567891011class HttpClient &#123; typealias completeClosure = ( _ data: Data?, _ error: Error?)-&gt;Void func get( url: URL, callback: @escaping completeClosure ) &#123; let request = NSMutableURLRequest(url: url) request.httpMethod = "GET" let task = URLSession.shared.dataTask(with: request) &#123; (data, response, error) in callback(data, error) &#125; task.resume() &#125;&#125; HttpClient çœ‹èµ·æ¥å¯ä»¥æäº¤ä¸€ä¸ª â€œGETâ€ è¯·æ±‚ï¼Œå¹¶é€šè¿‡ â€œcallbackâ€ é—­åŒ…å°†è¿”å›žå€¼å›žä¼ ã€‚ 1HttpClient().get(url: url) &#123; (success, response) in // Return data &#125; HttpClient çš„ç”¨æ³•ã€‚ è¿™å°±æ˜¯é—®é¢˜æ‰€åœ¨ï¼šæˆ‘ä»¬æ€Žä¹ˆå¯¹å®ƒæµ‹è¯•ï¼Ÿæˆ‘ä»¬å¦‚ä½•ç¡®ä¿è¿™äº›ä»£ç è¾¾åˆ°ä¸Šè¿°çš„ä¸¤ç‚¹è¦æ±‚ï¼Ÿå‡­ç›´è§‰ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ HttpClient ä¼ å…¥ä¸€ä¸ª URLï¼Œè¿è¡Œä»£ç ï¼Œç„¶åŽåœ¨é—­åŒ…é‡Œè§‚å¯Ÿå¾—åˆ°çš„ç»“æžœã€‚ä½†æ˜¯è¿™äº›æ“ä½œæ„å‘³ç€æˆ‘ä»¬åœ¨è¿è¡Œ HttpClient æ—¶å¿…é¡»æ¯æ¬¡éƒ½è¿žæŽ¥äº’è”ç½‘ã€‚æ›´ç³Ÿç³•çš„æ˜¯å¦‚æžœä½ æµ‹è¯•çš„ URL æ˜¯è¿žæŽ¥ç”Ÿäº§æœåŠ¡å™¨ï¼šä½ çš„æµ‹è¯•åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šå½±å“æœåŠ¡å™¨æ€§èƒ½ï¼Œè€Œä¸”ä½ æäº¤çš„æµ‹è¯•æ•°æ®å°†ä¼šè¢«æäº¤åˆ°çœŸå®žçš„ä¸–ç•Œã€‚å°±åƒæˆ‘ä»¬ä¹‹å‰æè¿°çš„ï¼Œæˆ‘ä»¬å¿…é¡»è®© HttpClient â€œå¯æµ‹è¯•â€ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸‹ URLSessionã€‚URLSession æ˜¯ HttpClient çš„ä¸€ç§â€˜çŽ¯å¢ƒâ€™ï¼Œæ˜¯ HttpClient è¿žæŽ¥äº’è”ç½‘çš„å…¥å£ã€‚è¿˜è®°å¾—æˆ‘ä»¬åˆšè®¨è®ºçš„â€œå¯æµ‹è¯•â€ä»£ç å—ï¼Ÿ æˆ‘ä»¬éœ€è¦å°†äº’è”ç½‘éƒ¨åˆ†å˜å¾—å¯æ›¿æ¢ï¼ŒäºŽæ˜¯æˆ‘ä»¬ä¿®æ”¹äº† HttpClient çš„å®žçŽ°ï¼š 123456789101112131415class HttpClient &#123; typealias completeClosure = ( _ data: Data?, _ error: Error?)-&gt;Void private let session: URLSession init(session: URLSessionProtocol) &#123; self.session = session &#125; func get( url: URL, callback: @escaping completeClosure ) &#123; let request = NSMutableURLRequest(url: url) request.httpMethod = "GET" let task = session.dataTask(with: request) &#123; (data, response, error) in callback(data, error) &#125; task.resume() &#125;&#125; æˆ‘ä»¬å°† 1let task = URLSession.shared.dataTask() ä¿®æ”¹æˆäº† 1let task = session.dataTask() æˆ‘ä»¬å¢žåŠ äº†æ–°çš„å˜é‡ï¼šsessionï¼Œå¹¶æ·»åŠ äº†å¯¹åº”çš„ init æ–¹æ³•ã€‚ä¹‹åŽæ¯å½“æˆ‘ä»¬åˆ›å»º HttpClient å¯¹è±¡æ—¶ï¼Œå°±å¿…é¡»åˆå§‹åŒ– sessionã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å·²ç»å°† session â€œæ³¨å…¥â€åˆ°äº†æˆ‘ä»¬åˆ›å»ºçš„ HttpClient å¯¹è±¡ä¸­ã€‚çŽ°åœ¨æˆ‘ä»¬å°±èƒ½å¤Ÿåœ¨è¿è¡Œç”Ÿäº§ä»£ç æ—¶æ³¨å…¥ â€˜URLSession.sharedâ€™ï¼Œè€Œè¿è¡Œæµ‹è¯•ä»£ç æ—¶æ³¨å…¥ä¸€ä¸ªæ¨¡æ‹Ÿçš„ sessionã€‚Bingo! è¿™æ—¶ HttpClient çš„ç”¨æ³•å°±å˜æˆäº†ï¼šHttpClient(session: SomeURLSession() ).get(url: url) { (success, response) in // Return data } ç»™æ­¤æ—¶çš„ HttpClient å†™æµ‹è¯•ä»£ç å°±ä¼šå˜å¾—éžå¸¸ç®€å•ã€‚å› æ­¤æˆ‘ä»¬å¼€å§‹å¸ƒç½®æˆ‘ä»¬çš„æµ‹è¯•çŽ¯å¢ƒï¼š 1234567891011class HttpClientTests: XCTestCase &#123; var httpClient: HttpClient! let session = MockURLSession() override func setUp() &#123; super.setUp() httpClient = HttpClient(session: session) &#125; override func tearDown() &#123; super.tearDown() &#125;&#125; è¿™æ˜¯ä¸ªè§„èŒƒçš„ XCTestCase è®¾ç½®ã€‚httpClient å˜é‡å°±æ˜¯è¢«æµ‹ç³»ç»Ÿï¼Œsession å˜é‡æ˜¯æˆ‘ä»¬å°†ä¸º httpClient æ³¨å…¥çš„çŽ¯å¢ƒã€‚å› ä¸ºæˆ‘ä»¬è¦åœ¨æµ‹è¯•çŽ¯å¢ƒè¿è¡Œä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬å°† MockURLSession å¯¹è±¡ä¼ ç»™ sessionã€‚è¿™æ—¶æˆ‘ä»¬å°†æ¨¡æ‹Ÿçš„ session æ³¨å…¥åˆ°äº† httpClientï¼Œä½¿å¾— httpClient åœ¨ URLSession.shared è¢«æ›¿æ¢æˆ MockURLSession çš„æƒ…å†µä¸‹è¿è¡Œã€‚ æµ‹è¯•æ•°æ®çŽ°åœ¨è®©æˆ‘ä»¬æ³¨æ„ä¸‹ç¬¬ä¸€ç‚¹è¦æ±‚ï¼š HttpClient å’Œåˆå§‹çš„ç½‘ç»œç»„ä»¶å¯¹äºŽåŒä¸€ URL åº”æäº¤åŒæ ·çš„ request ã€‚ æˆ‘ä»¬æƒ³è¾¾åˆ°çš„æ•ˆæžœæ˜¯ç¡®ä¿è¯¥ request çš„ url å’Œæˆ‘ä»¬ä¼ å…¥ â€œgetâ€ æ–¹æ³•çš„ url å®Œå…¨ä¸€è‡´ã€‚ ä»¥ä¸‹æ˜¯æˆ‘ä»¬çš„æµ‹è¯•ç”¨ä¾‹ï¼š 123456789func test_get_request_withURL() &#123; guard let url = URL(string: "https://mockurl") else &#123; fatalError("URL can't be empty") &#125; httpClient.get(url: url) &#123; (success, response) in // Return data &#125; // Assert &#125; è¿™ä¸ªæµ‹è¯•ç”¨ä¾‹å¯è¡¨ç¤ºä¸ºï¼š Precondition: Given a url â€œhttps://mockurlâ€ When: Submit a http GET request Assert: The submitted url should be equal to â€œhttps://mockurlâ€ æˆ‘ä»¬è¿˜éœ€è¦å†™æ–­è¨€éƒ¨åˆ†ã€‚ ä½†æ˜¯æˆ‘ä»¬æ€Žä¹ˆçŸ¥é“ HttpClient çš„ â€œgetâ€ æ–¹æ³•ç¡®å®žæäº¤äº†æ­£ç¡®çš„ url å‘¢ï¼Ÿè®©æˆ‘ä»¬å†çœ‹çœ¼ä¾èµ–ï¼šURLSessionã€‚é€šå¸¸ï¼Œâ€œgetâ€ æ–¹æ³•ä¼šç”¨æ‹¿åˆ°çš„ url åˆ›å»ºä¸€ä¸ª requestï¼Œå¹¶æŠŠ request ä¼ ç»™ URLSession æ¥å®Œæˆæäº¤: 1234let task = session.dataTask(with: request) &#123; (data, response, error) in callback(data, error)&#125;task.resume() æŽ¥ä¸‹æ¥ï¼Œåœ¨æµ‹è¯•çŽ¯å¢ƒä¸­ request å°†ä¼šä¼ ç»™ MockURLSessionï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦ hack è¿›æˆ‘ä»¬è‡ªå·±çš„ MockURLSession å°±å¯ä»¥æŸ¥çœ‹ request æ˜¯å¦è¢«æ­£ç¡®åˆ›å»ºäº†ã€‚ ä¸‹é¢æ˜¯ MockURLSession çš„ç²—ç•¥å®žçŽ°ï¼š 12345678class MockURLSession &#123; private (set) var lastURL: URL? func dataTask(with request: NSURLRequest, completionHandler: @escaping DataTaskResult) -&gt; URLSessionDataTask &#123; lastURL = request.url completionHandler(nextData, successHttpURLResponse(request: request), nextError) return // dataTask, will be impletmented later &#125;&#125; MockURLSession çš„ä½œç”¨å’Œ URLSession ä¸€æ ·ï¼ŒURLSession å’Œ MockURLSession æœ‰åŒæ ·çš„ dataTask() æ–¹æ³•å’Œç›¸åŒçš„å›žè°ƒé—­åŒ…ç±»åž‹ã€‚è™½ç„¶ URLSession æ¯” MockURLSession çš„ dataTask() åšäº†æ›´å¤šçš„å·¥ä½œï¼Œä½†å®ƒä»¬çš„æŽ¥å£æ˜¯ç±»ä¼¼çš„ã€‚æ­£æ˜¯ç”±äºŽå®ƒä»¬çš„æŽ¥å£ç›¸ä¼¼ï¼Œæˆ‘ä»¬æ‰èƒ½ä¸éœ€è¦ä¿®æ”¹ â€œgetâ€ æ–¹æ³•å¤ªå¤šä»£ç å°±å¯ä»¥ç”¨ MockURLSession æ›¿æ¢æŽ‰ URLSessionã€‚æŽ¥ç€æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª lastURL å˜é‡æ¥è·Ÿè¸ª â€œgetâ€ æ–¹æ³•æäº¤çš„æœ€ç»ˆ url ã€‚ç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯å½“æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ³¨å…¥ MockURLSession çš„ HttpClientï¼Œç„¶åŽè§‚å¯Ÿ url æ˜¯å¦å‰åŽç›¸åŒã€‚ ä»¥ä¸‹æ˜¯æµ‹è¯•ç”¨ä¾‹çš„å¤§æ¦‚å®žçŽ°ï¼š 123456789func test_get_request_withURL() &#123; guard let url = URL(string: "https://mockurl") else &#123; fatalError("URL can't be empty") &#125; httpClient.get(url: url) &#123; (success, response) in // Return data &#125; XCTAssert(session.lastURL == url)&#125; æˆ‘ä»¬ä¸º lastURL å’Œ url æ·»åŠ æ–­è¨€ï¼Œè¿™æ ·å°±ä¼šå¾—çŸ¥æ³¨å…¥åŽçš„ â€œgetâ€ æ–¹æ³•æ˜¯å¦æ­£ç¡®åˆ›å»ºäº†å¸¦æœ‰æ­£ç¡® url çš„ requestã€‚ ä¸Šé¢çš„ä»£ç ä»æœ‰ä¸€å¤„åœ°æ–¹éœ€è¦å®žçŽ°ï¼šreturn // dataTaskã€‚åœ¨ URLSession ä¸­è¿”å›žå€¼å¿…é¡»æ˜¯ä¸ª URLSessionDataTask å¯¹è±¡ï¼Œä½†æ˜¯ URLSessionDataTask å·²ç»ä¸èƒ½æ­£å¸¸åˆ›å»ºäº†ï¼Œæ‰€ä»¥è¿™ä¸ª URLSessionDataTask å¯¹è±¡ä¹Ÿéœ€è¦è¢«æ¨¡æ‹Ÿåˆ›å»ºï¼š 123class MockURLSessionDataTask &#123; func resume() &#123; &#125;&#125; ä½œä¸º URLSessionDataTaskï¼Œæ¨¡æ‹Ÿå¯¹è±¡éœ€è¦æœ‰ç›¸åŒçš„æ–¹æ³• resume()ã€‚è¿™æ ·æ‰ä¼šæŠŠæ¨¡æ‹Ÿå¯¹è±¡å½“åš dataTask() çš„è¿”å›žå€¼ã€‚ å¦‚æžœä½ è·Ÿç€æˆ‘ä¸€å—æ•²ä»£ç ï¼Œå°±ä¼šå‘çŽ°ä½ çš„ä»£ç ä¼šè¢«ç¼–è¯‘å™¨æŠ¥é”™ï¼š 1234567891011class HttpClientTests: XCTestCase &#123; var httpClient: HttpClient! let session = MockURLSession() override func setUp() &#123; super.setUp() httpClient = HttpClient(session: session) // Doesn't compile &#125; override func tearDown() &#123; super.tearDown() &#125;&#125; è¿™æ˜¯å› ä¸º MockURLSession å’Œ URLSession çš„æŽ¥å£ä¸ä¸€æ ·ã€‚æ‰€ä»¥å½“æˆ‘ä»¬è¯•ç€æ³¨å…¥ MockURLSession çš„æ—¶å€™ä¼šå‘çŽ° MockURLSession å¹¶ä¸èƒ½è¢«ç¼–è¯‘å™¨è¯†åˆ«ã€‚æˆ‘ä»¬å¿…é¡»è®©æ¨¡æ‹Ÿçš„å¯¹è±¡å’ŒçœŸå®žå¯¹è±¡æ‹¥æœ‰ç›¸åŒçš„æŽ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼•å…¥äº† â€œåè®®â€ ! HttpClient çš„ä¾èµ–ï¼š 1private let session: URLSession æˆ‘ä»¬å¸Œæœ›ä¸è®º URLSession è¿˜æ˜¯ MockURLSession éƒ½å¯ä»¥ä½œä¸º session å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬å°† session çš„ URLSession ç±»åž‹æ”¹ä¸º URLSessionProtocol åè®®ï¼š 1private let session: URLSessionProtocol è¿™æ ·æˆ‘ä»¬å°±èƒ½å¤Ÿæ³¨å…¥ URLSession æˆ– MockURLSession æˆ–è€…å…¶å®ƒéµå¾ªè¿™ä¸ªåè®®çš„å¯¹è±¡ã€‚ ä»¥ä¸‹æ˜¯åè®®çš„å®žçŽ°ï¼š 123protocol URLSessionProtocol &#123; typealias DataTaskResult = (Data?, URLResponse?, Error?) -&gt; Void func dataTask(with request: NSURLRequest, completionHandler: @escaping DataTaskResult) -&gt; URLSessionDataTaskProtocol&#125; æµ‹è¯•ä»£ç ä¸­æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæ–¹æ³•ï¼šdataTask(NSURLRequest, DataTaskResult)ï¼Œå› æ­¤åœ¨åè®®ä¸­æˆ‘ä»¬ä¹Ÿåªéœ€å®šä¹‰ä¸€ä¸ªå¿…é¡»å®žçŽ°çš„æ–¹æ³•ã€‚å½“æˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿä¸å±žäºŽæˆ‘ä»¬çš„å¯¹è±¡æ—¶è¿™ä¸ªæŠ€æœ¯é€šå¸¸å¾ˆé€‚ç”¨ã€‚ è¿˜è®°å¾— MockURLDataTask å—ï¼Ÿå¦ä¸€ä¸ªä¸å±žäºŽæˆ‘ä»¬çš„å¯¹è±¡ï¼Œæ˜¯çš„ï¼Œæˆ‘ä»¬è¦å†åˆ›å»ºä¸ªåè®®ã€‚ 1protocol URLSessionDataTaskProtocol &#123; func resume() &#125; æˆ‘ä»¬è¿˜éœ€è®©çœŸå®žçš„å¯¹è±¡éµå¾ªè¿™ä¸ªåè®®ã€‚ 12extension URLSession: URLSessionProtocol &#123;&#125;extension URLSessionDataTask: URLSessionDataTaskProtocol &#123;&#125; URLSessionDataTask æœ‰ä¸ªåŒæ ·çš„ resume() åè®®æ–¹æ³•ï¼Œæ‰€ä»¥è¿™é¡¹ä¿®æ”¹å¯¹äºŽ URLSessionDataTask æ˜¯æ²¡æœ‰å½±å“çš„ã€‚ é—®é¢˜æ˜¯ URLSession æ²¡æœ‰ dataTask() æ–¹æ³•æ¥è¿”å›ž URLSessionDataTaskProtocol åè®®ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æ‹“å±•æ–¹æ³•æ¥éµå¾ªåè®®ã€‚ 12345extension URLSession: URLSessionProtocol &#123; func dataTask(with request: NSURLRequest, completionHandler: @escaping DataTaskResult) -&gt; URLSessionDataTaskProtocol &#123; return dataTask(with: request, completionHandler: completionHandler) as URLSessionDataTaskProtocol &#125;&#125; è¿™ä¸ªç®€å•çš„æ–¹æ³•åªæ˜¯å°†è¿”å›žç±»åž‹ä»Ž URLSessionDataTask æ”¹æˆäº† URLSessionDataTaskProtocolï¼Œä¸ä¼šå½±å“åˆ° dataTask() çš„å…¶å®ƒè¡Œä¸ºã€‚ çŽ°åœ¨æˆ‘ä»¬å°±èƒ½å¤Ÿè¡¥å…¨ MockURLSession ç¼ºå¤±çš„éƒ¨åˆ†äº†ï¼š 12345678class MockURLSession &#123; private (set) var lastURL: URL? func dataTask(with request: NSURLRequest, completionHandler: @escaping DataTaskResult) -&gt; URLSessionDataTask &#123; lastURL = request.url completionHandler(nextData, successHttpURLResponse(request: request), nextError) return // dataTask, will be impletmented later &#125;&#125; æˆ‘ä»¬å·²ç»çŸ¥é“ // dataTaskâ€¦ å¯ä»¥æ˜¯ä¸€ä¸ª MockURLSessionDataTaskï¼š 123456789class MockURLSession: URLSessionProtocol &#123; var nextDataTask = MockURLSessionDataTask() private (set) var lastURL: URL? func dataTask(with request: NSURLRequest, completionHandler: @escaping DataTaskResult) -&gt; URLSessionDataTaskProtocol &#123; lastURL = request.url completionHandler(nextData, successHttpURLResponse(request: request), nextError) return nextDataTask &#125;&#125; åœ¨æµ‹è¯•çŽ¯å¢ƒä¸­æ¨¡æ‹Ÿå¯¹è±¡å°±ä¼šå……å½“ URLSession çš„è§’è‰²ï¼Œå¹¶ä¸” url ä¹Ÿèƒ½å¤Ÿè¢«è®°å½•ä¾›æ–­è¨€åˆ¤æ–­ã€‚æ˜¯ä¸æ˜¯æœ‰ç§ä¸‡ä¸ˆé«˜æ¥¼å¹³åœ°èµ·çš„æ„Ÿè§‰! æ‰€æœ‰çš„ä»£ç éƒ½å·²ç»ç¼–è¯‘å®Œæˆå¹¶ä¸”æµ‹è¯•ä¹Ÿé¡ºåˆ©é€šè¿‡ï¼ è®©æˆ‘ä»¬ç»§ç»­ã€‚ æµ‹è¯•è¡Œä¸ºç¬¬äºŒç‚¹è¦æ±‚æ˜¯ï¼š The HttpClient should submit the request æˆ‘ä»¬å¸Œæœ› HttpClient çš„ â€œgetâ€ æ–¹æ³•å°† request å¦‚é¢„æœŸåœ°æäº¤ã€‚ å’Œä¹‹å‰éªŒè¯æ•°æ®æ˜¯å¦æ­£ç¡®çš„æµ‹è¯•ä¸åŒï¼Œæˆ‘ä»¬çŽ°åœ¨è¦æµ‹è¯•çš„æ˜¯æ–¹æ³•æ˜¯å¦è¢«é¡ºåˆ©è°ƒç”¨ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ URLSessionDataTask.resume() æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨äº†ã€‚è®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨åˆšæ‰çš„è€æŠŠæˆï¼šæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„ resumeWasCalled å˜é‡æ¥è®°å½• resume() æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨ã€‚ æˆ‘ä»¬ç®€å•å†™ä¸€ä¸ªæµ‹è¯•ï¼š 1234567891011func test_get_resume_called() &#123; let dataTask = MockURLSessionDataTask() session.nextDataTask = dataTask guard let url = URL(string: "https://mockurl") else &#123; fatalError("URL can't be empty") &#125; httpClient.get(url: url) &#123; (success, response) in // Return data &#125; XCTAssert(dataTask.resumeWasCalled)&#125; dataTask å˜é‡æ˜¯æˆ‘ä»¬è‡ªå·±æ‹¥æœ‰çš„æ¨¡æ‹Ÿå¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªå±žæ€§æ¥ç›‘æŽ§ resume() æ–¹æ³•çš„è¡Œä¸ºï¼š 123456class MockURLSessionDataTask: URLSessionDataTaskProtocol &#123; private (set) var resumeWasCalled = false func resume() &#123; resumeWasCalled = true &#125;&#125; å¦‚æžœ resume() æ–¹æ³•è¢«è°ƒç”¨äº†ï¼ŒresumeWasCalled å°±ä¼šè¢«è®¾ç½®æˆ true! :) å¾ˆç®€å•ï¼Œå¯¹ä¸å¯¹ï¼Ÿ æ€»ç»“é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å­¦åˆ°ï¼š å¦‚ä½•è°ƒæ•´ä¾èµ–æ³¨å…¥æ¥æ”¹å˜ç”Ÿäº§/æµ‹è¯•çŽ¯å¢ƒã€‚ å¦‚ä½•åˆ©ç”¨åè®®æ¥åˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡ã€‚ å¦‚ä½•æ£€æµ‹ä¼ å€¼çš„æ­£ç¡®æ€§ã€‚ å¦‚ä½•æ–­è¨€æŸä¸ªå‡½æ•°çš„è¡Œä¸ºã€‚ åˆšèµ·æ­¥æ—¶ï¼Œä½ å¿…é¡»èŠ±è´¹å¤§é‡æ—¶é—´æ¥å†™ç®€å•çš„æµ‹è¯•ï¼Œè€Œä¸”æµ‹è¯•ä»£ç ä¹Ÿæ˜¯ä»£ç ï¼Œæ‰€ä»¥ä½ ä»éœ€è¦ä¿æŒæµ‹è¯•ä»£ç çš„ç®€æ´å’Œè‰¯å¥½çš„æž¶æž„ã€‚ä½†ç¼–å†™æµ‹è¯•ç”¨ä¾‹å¾—åˆ°çš„å¥½å¤„ä¹Ÿæ˜¯å¼¥è¶³çè´µçš„ï¼Œä»£ç åªæœ‰åœ¨æ°å½“çš„æµ‹è¯•åŽæ‰èƒ½è¢«æ‰©å±•ï¼Œæµ‹è¯•å¸®ä½ å…äºŽçç¢Ž bug çš„å›°æ‰°ã€‚æ‰€ä»¥è®©æˆ‘ä»¬ä¸€èµ·åŠ æ²¹å†™å¥½æµ‹è¯•å§! æ‰€æœ‰çš„ç¤ºä¾‹ä»£ç éƒ½åœ¨ GitHub ä¸Šï¼Œä»£ç æ˜¯ä»¥ Playground çš„å½¢å¼å±•ç¤ºçš„ï¼Œæˆ‘è¿˜åœ¨ä¸Šé¢æ·»åŠ äº†ä¸ªé¢å¤–çš„æµ‹è¯•ã€‚ ä½ å¯ä»¥è‡ªç”±ä¸‹è½½æˆ– fork è¿™äº›ä»£ç ï¼Œå¹¶ä¸”æ¬¢è¿Žä»»ä½•åé¦ˆï¼ æ„Ÿè°¢é˜…è¯»æˆ‘çš„æ–‡ç«  ðŸ’š ã€‚ å‚è€ƒæ–‡çŒ® Mocking Classes You Donâ€™t Own Dependency Injection Test-Driven iOS Development with Swift æ„Ÿè°¢ Lisa Dziuba å’Œ Ahmed Sulaiman. è¯‘æ–‡å‡ºè‡ªï¼šæŽ˜é‡‘ç¿»è¯‘è®¡åˆ’ è¯‘è€…ï¼š Swants æ ¡å¯¹è€…ï¼š pthtc ZhiyuanSun]]></content>
  </entry>
  <entry>
    <title><![CDATA[Xcode çŽ¯å¢ƒé…ç½®æœ€ä½³å®žè·µ]]></title>
    <url>%2F2018%2F01%2F12%2FXcode-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5.html</url>
    <content type="text"><![CDATA[å‰è¨€å·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨ã€‚åœ¨ iOS ä¸­,å¦‚ä½•å¤„ç† é…ç½®çŽ¯å¢ƒ å’Œæ ¹æ®éœ€æ±‚è‡ªå®šä¹‰çš„ è®¾ç½® å…³ç³»ä¹Ÿå°¤ä¸ºé‡è¦ã€‚è™½ç„¶ Xcode æä¾›äº†ä¸€ç³»åˆ—çš„å·¥å…·å¸®åŠ©æˆ‘ä»¬è¿›è¡Œå¦¥å–„åœ°é…ç½®ã€‚ä½†é—æ†¾çš„æ˜¯ï¼Œæˆ‘è§è¿‡çš„å¾ˆå¤šå›¢é˜Ÿåœ¨ç»å¤§å¤šæ•°æ—¶å€™éƒ½æ²¡æœ‰å……åˆ†åˆ©ç”¨è¿™äº›è¾…åŠ©å·¥å…·ã€‚è¿™å¹¶ä¸æ˜¯ä»–ä»¬çš„é”™ï¼šè‹¹æžœåªä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›ä¸æ€Žä¹ˆå¥½ç”¨çš„é»˜è®¤é…ç½®ï¼Œè€Œæ²¡æœ‰æ›´å¥½çš„å¸®åŠ©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•è¾¾åˆ°æœ€ä½³å®žè·µã€‚ åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å°†æŽ¢ç´¢å¦‚ä½•æ›´å¥½åœ°åˆ©ç”¨ Xcode é…ç½®ï¼Œå¦‚ä½•æŠŠ APP çš„è®¾ç½®å®šä¹‰å¾—æ›´åŠ æœ‰æ¡ç†ã€‚ Xcode é…ç½®Xcode å¯ä»¥é€šè¿‡å„ç§é…ç½®æž„å»ºä¸åŒè®¾ç½®çš„åŒ…ã€‚é€šä¿—åœ°è®²ï¼Œé…ç½®å°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨å¦‚ä½•æž„å»ºç‰ˆæœ¬çš„ä¸€ç³»åˆ—è®¾ç½®ã€‚IDE å…è®¸ä½ æ ¹æ®ä¸åŒçš„é…ç½®æ¥è‡ªå®šä¹‰ä¸€äº›è®¾ç½®ã€‚ä½ å¯èƒ½ç»å¸¸çœ‹åˆ°è¿™äº›ï¼š ç­‰ç­‰â€¦ Debug vs. ReleaseDebug å’Œ Release æ˜¯ Xcode æä¾›çš„ä¸¤ç§é»˜è®¤é…ç½®ã€‚ä½ å®Œå…¨ä¹Ÿå¯ä»¥åˆ›å»ºä½ è‡ªå·±çš„é…ç½®ï¼Œä½†æˆ‘ä»¬é€šå¸¸ä¸è¿™ä¹ˆåšï¼Œå› ä¸ºè‡ªå®šä¹‰çš„é…ç½®æ˜¯å¦æœ‰æ•ˆå¯èƒ½å–å†³äºŽé¡¹ç›®ï¼ŒiOS å¼€å‘è€…ä»¬å¯¹å“ªäº›é…ç½®å¯ä»¥å¯¹é¡¹ç›®æ™®éæœ‰æ•ˆè¿˜æ²¡æœ‰è¾¾æˆå…±è¯†ã€‚ è¿™ä¸¤ç§é»˜è®¤é…ç½®æœ‰å‡ å¤„å·®åˆ«ï¼Œå…·ä½“çš„å·®åˆ«åœ¨è¿™é‡Œæˆ‘ä¸ä¼šè¯¦ç»†è®¨è®ºï¼Œåªæ˜¯ç®€å•æ¦‚æ‹¬ä¸‹ï¼š åœ¨ debug æž„å»ºçš„ç‰ˆæœ¬ä¸­ï¼ŒXcode ä¼šç»™æˆ‘ä»¬å‘é€å®Œæ•´çš„ç¬¦å·è°ƒè¯•ä¿¡æ¯æ¥å¸®åŠ©æˆ‘ä»¬è°ƒè¯•åº”ç”¨ï¼Œå¹¶ä¸” Xcode ä¸ä¼šå¯¹ä»£ç è¿›è¡Œä¼˜åŒ–ï¼ˆæ›´å¿«çš„æž„å»ºé€Ÿåº¦ï¼‰ã€‚è€Œåœ¨ release æž„å»ºçš„ç‰ˆæœ¬ä¸­ï¼Œä¸ä¼šå‘é€è°ƒè¯•ä¿¡æ¯å¹¶ä¸”ä»£ç ä¼šè¢«ä¼˜åŒ–ï¼ˆè¾ƒæ…¢çš„æž„å»ºé€Ÿåº¦ï¼‰ã€‚ è‡³äºŽè¿™ä¸¤ç§é…ç½®çš„ç”¨é€”ï¼Œdebug é€šå¸¸ä¼šåœ¨æˆ‘ä»¬æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨ã€‚è€Œ release æˆ‘ä»¬é€šå¸¸ä¼šåœ¨éœ€è¦å°† APP åˆ†å‘ç»™å…¶ä»–éžå¼€å‘äººå‘˜å¦‚ï¼šæµ‹è¯•äººå‘˜ã€é¡¹ç›®ç»ç†ã€å®¢æˆ·æˆ–ç”¨æˆ·æ—¶ä½¿ç”¨ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªé…ç½®é€šå¸¸æ˜¯ä¸èƒ½å®Œå…¨æ»¡è¶³éœ€æ±‚çš„ã€‚è€Œä¸”å¼€å‘è€…ç»å¸¸æŠŠ â‰ªdebug vs. releaseâ‰« å’Œ â‰ªstaging vs. productionâ‰« è¿™ä¸¤ä¸ªæ¦‚å¿µæžæ··ï¼Œè¿™å®Œå…¨æ˜¯ä¸åº”è¯¥çš„ã€‚ æˆ‘ä»¬å¯ä»¥ç»§ç»­å®Œå–„ä¸€äº›é¡¹ç›®ä½¿ç”¨ä¸åŒçš„é…ç½®çŽ¯å¢ƒï¼šå¼€å‘çŽ¯å¢ƒã€ä¸´æ—¶çŽ¯å¢ƒã€ç”Ÿäº§çŽ¯å¢ƒã€é¢„ç”Ÿäº§çŽ¯å¢ƒç­‰ç­‰ï¼Œç”¨ä½ æœ€æƒ³ç”¨çš„é‚£ä¸ªå°±å¥½ã€‚è¿™ç§åˆ†ç±»æ–¹å¼å’Œä¸Šé¢è®¨è®ºçš„ä¸¤ç§é»˜è®¤é…ç½®æ²¡æœ‰ç›´æŽ¥è”ç³»ã€‚å°±ç®—æˆ‘ä»¬å¼ºåˆ¶è¿™ä¹ˆåˆ†ç±»ï¼Œç”¨çš„æ—¶å€™è¾¾åˆ°çš„æ•ˆæžœä¹Ÿæ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£æ ·å¥½ã€‚æ¯”å¦‚ï¼Œä½ æƒ³å‡†å¤‡æž„å»ºä¸€ä¸ª release ç‰ˆæœ¬ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ä½ çš„ APP ä¸€å®šè¦æŒ‡å‘ ç”Ÿäº§ æœåŠ¡å™¨ï¼šæƒ³åƒä¸€ä¸‹ï¼Œä½ éœ€è¦ä¸º QA æ‰“ä¸ª release çš„ç‰ˆæœ¬çš„åŒ…ï¼Œè€Œè¿™ä¸ªåŒ…éœ€è¦åœ¨ä¸´æ—¶æœåŠ¡å™¨ä¸Šè¿›è¡Œæµ‹è¯•ã€‚ è¿™æ—¶å°±è¿ž debug &amp; release ä¸¤ä¸ªé»˜è®¤çš„é…ç½®ä¹Ÿä¸èƒ½æ»¡è¶³éœ€æ±‚äº†ã€‚ å› æ­¤ï¼Œæˆ‘æƒ³ç”¨å¯ä»¥æ»¡è¶³æˆ‘ä»¬æ›´å¤šéœ€æ±‚çš„å…¶ä»–é…ç½®æ–¹æ¡ˆæ¥ä»£æ›¿åŸºæœ¬çš„ debug &amp; release é…ç½®ã€‚ä¸ºäº†è¶³å¤Ÿç®€å•ï¼Œåœ¨æˆ‘çš„æ–¹æ¡ˆä¸­åªä¼šä¿ç•™ä¸´æ—¶çŽ¯å¢ƒå’Œç”Ÿäº§çŽ¯å¢ƒï¼Œåœ¨ä½ éœ€è¦ä½¿ç”¨å…¶å®ƒçŽ¯å¢ƒé…ç½®æ—¶ï¼Œä½ ä¼šå‘çŽ°åœ¨æˆ‘çš„æ–¹æ¡ˆé‡Œå¯ä»¥è½»æ¾æ·»åŠ ã€‚ è®©æˆ‘ä»¬é‡æ–°å®šä¹‰é…ç½®çŽ¯å¢ƒæˆ‘ä»¬å¯ä»¥å®šä¹‰å››ç§é…ç½®çŽ¯å¢ƒï¼š Debug Staging Debug Production TestFlight Staging TestFlight Production ä»Žå®ƒä»¬çš„åå­—ä¸Šï¼Œä½ å°±èƒ½çŒœåˆ°å®ƒä»¬å¤§æ¦‚çš„è®¾ç½®ï¼Œä¸‹é¢å°±æ˜¯å®ƒä»¬çš„è¯¦ç»†è®¾ç½®ï¼š å‰ä¸¤ä¸ªï¼ˆDebug Staging &amp; Debug Productionï¼‰å’Œé»˜è®¤çš„ Debug é…ç½®ä¸€æ ·ï¼Œä½† æ¯ä¸ªéƒ½æŒ‡å‘ä¸åŒçš„æœåŠ¡å™¨çŽ¯å¢ƒã€‚ åŽä¸¤ä¸ªé…ç½®çŽ¯å¢ƒï¼ˆä¸¤ä¸ª TestFlight é…ç½®çŽ¯å¢ƒ ï¼‰ä¹Ÿæ˜¯è¿™æ ·ï¼Œå®ƒä»¬å’Œé»˜è®¤çš„ Release é…ç½®ä¸€æ ·ï¼Œä¸åŒ…å«è°ƒè¯•ä¿¡æ¯å¹¶è¿›è¡Œäº†ä»£ç ä¼˜åŒ–ï¼Œä½† æ¯ä¸ªéƒ½åœ¨å¯¹åº”çš„æœåŠ¡å™¨çŽ¯å¢ƒä¸‹ä½¿ç”¨ã€‚ å®žçŽ°çš„æ“ä½œä¹Ÿæ˜¯éžå¸¸ç®€å•ï¼Œæ‰¾åˆ° project çš„ Settings &gt; Info &gt; Configurationsï¼Œç„¶åŽç‚¹å‡» + æŒ‰é’®ã€‚æ‹·è´ä¸€ä»½ Debug é…ç½®ï¼Œå¹¶å°†é»˜è®¤çš„é…ç½®å‘½åä¸º â€œDebug Stagingâ€ï¼Œæ‹·è´å‡ºæ¥çš„é…ç½®å‘½åä¸º â€œDebug Productionâ€ã€‚æŒ‰ç…§è¿™ä¸ªæ–¹å¼å¯¹ Release è¿›è¡Œå¤„ç†ã€‚ å½“ä½ æ“ä½œå®ŒåŽæ˜¯è¿™ä¸ªæ•ˆæžœï¼š ä¸€ä¸ª project åŒ…å«å››ç§ä¸åŒçš„é…ç½®çŽ¯å¢ƒã€‚ ç¬¬äº”ç§é…ç½®çŽ¯å¢ƒæˆ‘ä½¿ç”¨ â€œ TestFlightâ€ å‘½å release é…ç½®ï¼Œè€Œä¸æ˜¯ä½¿ç”¨åŽŸæ¥çš„ â€œReleaseâ€ å‘½åæ˜¯æœ‰åŽŸå› çš„ã€‚å› ä¸ºä»£ç ä¸­æœ‰äº›ç‰¹å®šäº‹ä»¶åªåœ¨æœ€ç»ˆç”¨æˆ·ä½¿ç”¨æ—¶è§¦å‘ï¼Œè€Œåœ¨æµ‹è¯•äººå‘˜å’Œå®¢æˆ·ä½¿ç”¨æ—¶ä¸è§¦å‘ã€‚ä¸€ä¸ªå…·ä½“çš„åœºæ™¯å°±æ˜¯ä½¿ç”¨ç”¨æˆ·ç»Ÿè®¡æ¥è·Ÿè¸ªäº‹ä»¶ï¼Œè¿™å¯èƒ½è¦æ±‚è·Ÿè¸ªäº‹ä»¶ä»…ä½œç”¨äºŽæœ€ç»ˆç”¨æˆ·ï¼Œè€Œä¸æ˜¯ç”Ÿäº§çŽ¯å¢ƒä¸‹çš„æµ‹è¯•äººå‘˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ æˆ‘ä»¬å°±è¦è€ƒè™‘ TestFlight Production é…ç½®å…·æœ‰çš„ç»†å¾®å·®åˆ«ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªé…ç½®ç»§ç»­ç»†åˆ†ä¸‹åŽ»ã€‚å¼•è¿›ç¬¬äº”ç§é…ç½®ï¼š AppStore ä½ å¯ä»¥å¿«é€Ÿåœ°æ‹·è´ä¸€ä»½ TestFlight Production æ¥æ·»åŠ è¿™ä¸ªé…ç½®ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªé…ç½®å¯èƒ½ä¸€ç›´ä¸ä¼šç”¨åˆ°ï¼Œå› ä¸ºä½ ä¸ä¸€å®šä¼šé‡åˆ°éœ€è¦ç»†åˆ† TestFlight Production é…ç½®çš„éœ€æ±‚ã€‚ é‚£ä¹ˆï¼ŒçŽ°åœ¨ä½ å¯èƒ½å¾ˆæƒ³çŸ¥é“ å¦‚ä½•æ ¹æ®æ‰€é€‰é…ç½®æ¥ç®¡ç† APP ä¸­çš„è§¦å‘äº‹ä»¶ã€‚è¿™äº›å°†ä¼šåœ¨æŽ¥ä¸‹æ¥éƒ¨åˆ†è¯¦ç»†ä»‹ç»ã€‚ è‡ªå®šä¹‰è®¾ç½®æœ‰å¾ˆå¤šæ–¹å¼å¯ä»¥åšåˆ°æ ¹æ®æ‰€é€‰ä¸åŒé…ç½®æ¥æ‰§è¡Œä¸åŒçš„æ“ä½œï¼šé¢„ç¼–è¯‘å™¨æŒ‡ä»¤ã€çŽ¯å¢ƒå˜é‡ã€å„ç§ plist æ–‡ä»¶ç­‰ç­‰ã€‚è¿™äº›æ–¹å¼éƒ½æœ‰è‡ªå·±çš„ä¼˜ç¼ºç‚¹ï¼Œè¿™é‡Œåªè®¨è®ºæˆ‘å°†é‡‡å–çš„æ¯”è¾ƒçº¯å‡€çš„æ–¹å¼ã€‚ éœ€è¦æ ¹æ®é…ç½®æ‰§è¡Œçš„å„ç§æ“ä½œé€šå¸¸å¯ä»¥ç”±å˜é‡æ¥æŽ§åˆ¶ï¼Œé€šè¿‡è¿™äº›å˜é‡æ¥å†³å®š APP çš„è¡Œä¸ºã€‚è¿™äº›å˜é‡é€šå¸¸ç§°ä¸º settings ã€‚æ¯”å¦‚ä¸€äº›åƒè¿™æ ·çš„ settings ï¼šæœåŠ¡å™¨ API çš„ base URLã€Facebook App IDã€æ—¥å¿—çš„è¯¦ç»†çº§åˆ«ã€æ˜¯å¦æ”¯æŒç¦»çº¿è®¿é—®ç­‰ç­‰ã€‚ æŽ¥ç€ï¼Œå±•ç¤ºæˆ‘çŽ°åœ¨å¦‚ä½•æ ¹æ®æ‰€é€‰é…ç½®æ¥ç®¡ç†è¿™äº›è‡ªå®šä¹‰ settings çš„æ–¹æ³•ã€‚ä»Žæˆ‘çš„ä»¥å¾€ç»éªŒæ¥çœ‹ï¼Œè¿™æ˜¯ç›®å‰æœ€æ–¹ä¾¿çš„æ–¹æ¡ˆã€‚ Settings.swiftAPP çš„è‡ªå®šä¹‰ settings å¯ä»¥é€šè¿‡å•ä¾‹å¾ˆç®€å•çš„èŽ·å–åˆ°ã€‚ 1234567891011121314151617struct Settings &#123; static var shared = Settings() let apiURL: URL let isOfflineAccessEnabled: Bool let feedItemsPerPage: Int private init() &#123; let path = Bundle.main.path(forResource: "Info", ofType: "plist")! let plist = NSDictionary(contentsOfFile: path) as! [AnyHashable: Any] let settings = plist["AppSetings"] as! [AnyHashable: Any] apiURL = URL(string: (settings["ServerBaseURL"] as! String))! isOfflineAccessEnabled = settings["EnableOfflineAccess"] as! Bool feedItemsPerPage = settings["FeedItemsPerPage"] as! Int print("Settings loaded: \(self)") &#125;&#125; è¿™ä¸ªç»“æž„ä½“ç”¨æ¥è¯»å–å’Œè®°å½• APP çš„å„ç§ settingsï¼ˆè¿™äº› settings ä¼šåœ¨ APP çš„ Info.plist æ–‡ä»¶ä¸­å®šä¹‰ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åœ¨ä»£ç ä¸­éšæ—¶æ‹¿åˆ°è¿™äº› settingsã€‚åœ¨è¿™é‡Œæˆ‘å–œæ¬¢ä½¿ç”¨å¼ºåˆ¶è§£åŒ…ï¼Œå› ä¸ºè¿™æ ·å¦‚æžœç¼ºå°‘æŸé¡¹è®¾ç½®ï¼ŒAPP ä¹Ÿä¼šæ— æ³•è¿è¡Œã€‚ Info.pliståœ¨ Info.plist æ–‡ä»¶ä¸­å®šä¹‰ appSettings ã€‚è¿™é‡Œæˆ‘å»ºè®®å¤§å®¶ä½¿ç”¨å­—å…¸æŠŠè¿™äº›è®¾ç½®æ±‡æ€»åˆ°ä¸€èµ·ã€‚ è¿™æ ·ï¼Œæˆ‘ä»¬å°±éžå¸¸çº¯å‡€åœ°å®Œæˆäº†å¯¹ APP settings çš„è¯»å–ã€‚è¿™äº› settings åœ¨ä¸åŒçš„é…ç½®çŽ¯å¢ƒä¸­å€¼éƒ½æ˜¯ä¸åŒçš„ï¼Œè¿˜å·®ä¸€ç‚¹å°±å®Œæˆäº†ã€‚ User-Defined Settingsæƒ³ä¸€ä¸‹ï¼Œåœ¨æ‰€æœ‰çš„å·¥ç¨‹å†… ä»€ä¹ˆä¼šéšé…ç½®çš„ä¸åŒè€Œæ”¹å˜ ï¼Ÿ å¯¹ï¼Œç¼–è¯‘å™¨çš„ä»£ç ä¼˜åŒ–çº§åˆ«ã€header çš„æœç´¢è·¯å¾„ã€æè¿°æ–‡ä»¶ç­‰ç­‰ã€‚å¦‚æžœæˆ‘ä»¬èƒ½å¤Ÿå®šä¹‰æˆ‘ä»¬è‡ªå·±çš„éšæ‰€é€‰é…ç½®æ”¹å˜çš„è®¾ç½®ï¼Œé‚£ä¸å°±ç®€å•äº†ï¼äº‹å®žè¯æ˜Žï¼Œæˆ‘ä»¬ç¡®å®žå¯ä»¥åˆ›å»ºç”¨æˆ·è‡ªå®šä¹‰çš„è®¾ç½®ã€‚ åˆ›å»º User-Defined settings éžå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ä½ çš„ Target &gt; Build Settings ä¸­ï¼Œç‚¹å‡» + æŒ‰é’®ï¼Œç„¶åŽé€‰æ‹© â€œCreate User-Defined Settingâ€ã€‚è¿™äº›ä¹Ÿå¯ä»¥åœ¨ project &gt; Build Settings ä¸‹åˆ›å»ºï¼Œä½†æˆ‘è§‰å¾—åœ¨ Target &gt; Build Settings åˆ›å»ºæ›´åˆé€‚ã€‚ å› ä¸ºä½ åˆšåˆ›å»ºçš„ User-Defined Settings å¯èƒ½è¿˜éœ€ä¸Žå…¶ä»–çš„ Settings æ¥æ­é…ä½¿ç”¨ï¼Œæ‰€ä»¥å»ºè®®æœ€å¥½ç”¨åˆé€‚çš„å‰ç¼€æ¥å‘½åã€‚ æˆ‘è¿™é‡Œä½¿ç”¨äº†æˆ‘åå­—ç¼©å†™æ¥ä½œä¸º User-Defined Settings çš„å‰ç¼€ï¼Œ ä½†æˆ‘å»ºè®®æœ€å¥½ç”¨é¡¹ç›®åçš„ç¼©å†™ã€‚ æŽ¥ä¸‹æ¥ï¼Œåœ¨ä½ çš„ Info.plist æ–‡ä»¶ä¸­å¼•ç”¨å¯¹åº”çš„å±žæ€§å€¼ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š 1$(YOUR_USER_DEFINED_SETTING_NAME) æ•´åˆå…¨éƒ¨çœŸæ­£ç¥žå¥‡çš„åœ°æ–¹åœ¨äºŽï¼šä½ å¯ä»¥å°† Info.plist ä¸­ settings çš„æ‰€æœ‰å·²ç»å¡«å¥½çš„å±žæ€§å€¼æ›¿æ¢ä¸º User-Defined Setting çš„å¯¹åº”åœ°å€ã€‚è€Œä½ çŽ°æœ‰çš„è‡ªå®šä¹‰ setting å„éœ€å¯¹åº”ä¸€æ¡ User-Defined Settingã€‚ å½“ Info.plist æ–‡ä»¶è¢«ç¼–è¯‘æ—¶ï¼Œå®ƒä¼šèŽ·å–æ‰€é€‰é…ç½®å¯¹åº”çš„æ‰€æœ‰ settings å±žæ€§å€¼ï¼Œè€Œè¿™äº›å±žæ€§å€¼ä¹Ÿä¼šåœ¨ç¼–è¯‘æ—¶å¯¹åº”åˆ°æ¯ä¸ª settings ä¸Šã€‚ çŽ°åœ¨ï¼Œä½ å°±å¯ä»¥åœ¨ä½ çš„ä»£ç é‡Œéšæ—¶éšåœ° ä¼˜é›… åœ°èŽ·å–åˆ°è¿™äº› settings çš„å±žæ€§å€¼ï¼š 123if Settings.shared.isOfflineAccessEnabled &#123; // do stuff&#125; æœ€åŽï¼Œåœ¨ Xcode ä¸­é€‰æ‹©æ‰€éœ€çš„ç¼–è¯‘é…ç½®å°±éžå¸¸ç®€å•äº†ï¼š æˆ–è€…åœ¨ CLI ä¸­: æ€»ç»“é‡‡ç”¨è¿™å¥—æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä¼šèŽ·å¾—è¿™äº›å¥½å¤„ï¼š æœ‰ç»„ç»‡åœ°æž„å»ºå·¥ä½œæµç¨‹ã€‚ æœ‰ç»„ç»‡åœ°ç®¡ç†åº”ç”¨ç¨‹åºçš„è‡ªå®šä¹‰è®¾ç½®ã€‚ æ ¹æ®é…ç½®çµæ´»æ”¹å˜è®¾ç½®ã€‚ è½»æ¾æŒç»­é›†æˆï¼ˆåœ¨å‘½ä»¤è¡Œå·¥å…·ä¸­ï¼Œé€‰æ‹©è¦ç¼–è¯‘çš„é…ç½®å¾ˆå®¹æ˜“å®žçŽ°ï¼‰ã€‚ ç„¶è€Œï¼Œè¿™ä¸ªæ–¹æ¡ˆä¹Ÿæœ‰äº›å€¼å¾—è­¦æƒ•çš„åœ°æ–¹ï¼š åœ¨è¿è¡Œæ—¶ä¸èƒ½çµæ´»åœ°æ›´æ”¹è®¾ç½®ï¼Œå› ä¸ºè®¾ç½®åœ¨ç¼–è¯‘æ—¶å°±è¢«æ‰“åŒ…åˆ°ç‰ˆæœ¬å†…äº†ã€‚ åœ¨é…ç½®ä¹‹é—´åˆ‡æ¢æ—¶ä½“éªŒå¹¶ä¸æ˜¯å¾ˆå¥½ï¼šæ¯æ¬¡æ›´æ”¹é…ç½®åŽï¼ŒXcode éƒ½ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªç‰ˆæœ¬ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¿…é¡»ç­‰å¾…æ•´ä¸ªé¡¹ç›®é‡æ–°ç¼–è¯‘ã€‚ åªèƒ½åœ¨ .xcodeproj ä¸­ä¿®æ”¹è¿™äº›è®¾ç½®çš„å€¼ï¼Œè€Œä¸èƒ½åœ¨å¤–éƒ¨ çµæ´» ä¿®æ”¹è¿™äº›è®¾ç½®çš„å€¼ã€‚ User-Defined Settings æš´éœ²ç»™äº†æ‰€æœ‰èƒ½å¤ŸæŽ¥è§¦åˆ°ä»£ç çš„äºº , æ‰€ä»¥åƒä¸‡ä¸è¦æŠŠä»»ä½•é‡è¦çš„ key å€¼æ”¾åˆ°è¿™é‡Œ ã€‚ è™½ç„¶è¿™äº›éšæ‚£å¯ä»¥ä¸€ä¸€æŽ’é™¤ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªæ–¹æ¡ˆçš„åˆè¡·åªæ˜¯ä¸ºäº†ä»Žè¿™ç‰‡å‡ ä¹Žç©ºç™½çš„é¢†åŸŸæ‘¸ç´¢å‡ºè¿™äº›å·¥å…·æ›´å¥½çš„ä½¿ç”¨æ–¹æ³•ã€‚è§£å†³è¿™äº›é—®é¢˜å°±æ„å‘³ç€æ›´å¤šæ›´å¤æ‚çš„ä¿®æ”¹ï¼Œè€Œä¸”è¿™äº›å·²ç»è¶…å‡ºäº†æœ¬æ–‡è®¨è®ºçš„å†…å®¹ï¼Œæˆ‘ä¸å¸Œæœ›è¿™ç¯‡æ–‡ç« è·‘é¢˜ã€‚ä½†ç›¸ä¿¡æˆ‘ï¼Œæˆ‘ä»¬åšçš„å·²ç»è¶³å¤Ÿå®Œå–„äº†ã€‚åœ¨ä¸‹ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•å¤„ç†è¿™äº›éšæ‚£ï¼Œå¹¶è®©æˆ‘ä»¬çš„é¡¹ç›®å˜å¾—æ›´åŠ å®Œå–„â€¦ å¾…ç»­ã€‚ è¯‘æ–‡å‡ºè‡ªï¼šæŽ˜é‡‘ç¿»è¯‘è®¡åˆ’ è¯‘è€…ï¼šswants æ ¡å¯¹è€…ï¼šcharsdavy VernonVan]]></content>
  </entry>
  <entry>
    <title><![CDATA[git å‘½ä»¤æ±‡æ€»]]></title>
    <url>%2F2017%2F11%2F16%2Fgit-%E5%91%BD%E4%BB%A4%E6%B1%87%E6%80%BB.html</url>
    <content type="text"><![CDATA[git ä»“åº“å‘½ä»¤git clone : ä¸‹è½½ä»“åº“åˆ°æœ¬åœ°ã€‚ git clone ä»“åº“URL ç›®çš„è·¯å¾„ æŠŠä»“åº“ä¸‹è½½åˆ°ç›®çš„è·¯å¾„ã€‚ å½“ clone ä»“åº“åˆ°æœ¬åœ°æ—¶ æœ¬åœ°åªèƒ½çœ‹åˆ° master åˆ†æ”¯ å¦‚æžœæƒ³çœ‹åˆ°å…¶ä»–åˆ†æ”¯ ä½¿ç”¨ git checkout -b &lt;name&gt; origin/&lt;name&gt; å¦‚æžœ git pull æç¤º â€œno tracking informationâ€ ï¼Œåˆ™è¯´æ˜Žæœ¬åœ°åˆ†æ”¯å’Œè¿œç¨‹åˆ†æ”¯çš„é“¾æŽ¥å…³ç³»æ²¡æœ‰åˆ›å»ºï¼Œç”¨å‘½ä»¤ git branch --set-upstream branch-name origin/branch-name git pull : å°†è¿œç¨‹ä»“åº“æœ€æ–°çš„æäº¤æ›´æ–°åˆ°æœ¬åœ°ã€‚ git push ï¼šå°†æœ¬åœ°æäº¤æ›´æ–°åˆ°è¿œç¨‹ä»“åº“ã€‚ æäº¤å‘½ä»¤ï¼šgit add .æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒº git commit -m â€æäº¤æ³¨é‡Šâ€ å°†æš‚å­˜åŒºçš„æ–‡ä»¶æ›´æ”¹æäº¤åˆ°æœ¬åœ°ä»“åº“. git reset --&lt;m åˆ›å»ºåˆ†æ”¯ï¼šgit branch ` åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout &lt;name&gt; åˆ›å»º+åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout -b &lt;name&gt; åˆå¹¶æŸåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯ï¼šgit merge --no-ff &lt;name&gt; å°†æœ¬åœ°åˆ†æ”¯æŽ¨é€åˆ°è¿œç«¯åˆ†æ”¯ git push origin &lt;name&gt; åˆ é™¤åˆ†æ”¯ï¼šgit branch -d &lt;name&gt; åˆ é™¤è¿œç«¯åˆ†æ”¯ git push origin --delete &lt;name&gt; Git æŸ¥çœ‹å‘½ä»¤:git statusï¼šæŸ¥çœ‹æœ¬åœ°ä»“åº“æ–‡ä»¶çŠ¶æ€ã€‚ git logï¼š æŸ¥çœ‹æäº¤è®°å½•ã€‚ git log --pretty=oneline å•è¡ŒæŸ¥çœ‹æäº¤åŽ†å² git log --graph --pretty=oneline --abbrev-commit æŸ¥çœ‹æäº¤ç½‘ç»œå›¾ git diff : æŸ¥çœ‹æ–‡ä»¶æ”¹åŠ¨. æš‚å­˜ stash å‘½ä»¤ å·¥ä½œçš„æ—¶å€™æœª commit æƒ³ä¿å­˜å·¥ä½œåŒºå†…å®¹ åŽ»å¦ä¸€æ¡åˆ†æ”¯ä¸Šå·¥ä½œ Git stash å¯ä»¥æŠŠå½“å‰å·¥ä½œçŽ°åœºâ€œå‚¨è—â€èµ·æ¥ï¼Œç­‰ä»¥åŽæ¢å¤çŽ°åœºåŽç»§ç»­å·¥ä½œ git stash list æŸ¥çœ‹å‚¨å­˜çŽ°åœºå‚¨è—åˆ—è¡¨ git stash apply æ¢å¤æ¢å¤åŽï¼Œstashå†…å®¹å¹¶ä¸åˆ é™¤ï¼Œä½ éœ€è¦ç”¨git stash dropæ¥åˆ é™¤ git stash pop æ¢å¤çš„åŒæ—¶æŠŠstashå†…å®¹ä¹Ÿåˆ äº† æ ‡ç­¾å‘½ä»¤åˆ›å»ºæ ‡ç­¾ git tag -a &lt;æ ‡ç­¾å&gt; -m â€æ ‡ç­¾è¯´æ˜Žâ€ æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾ git tag ç»™ä»¥å‰æŸä¸ªc ommit æ‰“æ ‡ç­¾ git tag v0.9 6224937 æŸ¥çœ‹æ ‡ç­¾è¯¦æƒ… git show v0.9 æŽ¨é€æœ¬åœ°æŸä¸ªæ ‡ç­¾: git push origin &lt;tagname&gt; æŽ¨é€å…¨éƒ¨æœªæŽ¨é€è¿‡çš„æœ¬åœ°æ ‡ç­¾ git push origin â€”tags åˆ é™¤ä¸€ä¸ªæœ¬åœ°æ ‡ç­¾ git tag -d &lt;tagname&gt; åˆ é™¤ä¸€ä¸ªè¿œç¨‹æ ‡ç­¾git push origin :refs/tags/&lt;tagname&gt; tip:fork äº†åˆ«äººçš„åº“ä¹‹åŽè‡ªå·±çš„åä¸‹ä¼šå¤šå‡ºä¸€ä¸ªåŒæ ·çš„åº“ï¼Œ clone åˆ°æœ¬åœ° è¿›è¡Œ bug ä¿®æ”¹ï¼Œä¿®å¤æˆåŠŸåŽï¼Œå¯ä»¥åœ¨ GIthub ä¸Šå‘ PR å¦‚æžœå¯¹æ–¹åŒæ„ä½ çš„ PR å°±ä¼šå¹¶å…¥ä½ çš„ commitã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ å‘çŽ° å¯¹æ–¹çš„åº“å·²ç»æ›´æ–°äº†ï¼Œä½†ä½ çš„ fork åº“ æ²¡æœ‰æ›´æ–° å¯ä»¥è¯•ç”¨ä¸€ä¸‹æ“ä½œæ›´æ–°è‡ªå·±çš„åº“ï¼šåœ¨è‡ªå·±æœ¬åœ°çš„ clone åº“é‡Œ é¦–å…ˆè¦å…ˆç¡®å®šä¸€ä¸‹æ˜¯å¦å»ºç«‹äº†ä¸» repo çš„è¿œç¨‹æºï¼š git remote -v å¦‚æžœé‡Œé¢åªèƒ½çœ‹åˆ°ä½ è‡ªå·±çš„ä¸¤ä¸ªæº( fetch å’Œ push )ï¼Œé‚£å°±éœ€è¦æ·»åŠ ä¸» repo çš„æºï¼š 12git remote add upstream URLgit remote -v ç„¶åŽä½ å°±èƒ½çœ‹åˆ° upstream äº†ã€‚ å¦‚æžœæƒ³ä¸Žä¸» repo åˆå¹¶ï¼š 12git fetch upstreamgit merge upstream/master è¿™æ—¶ä½ çš„æœ¬åœ°åº“å°±å·²ç»æ›´æ–°åˆ°æœ€æ–°çš„äº†ï¼Œ ç„¶åŽ push åˆ°è‡ªå·±çš„ fork åº“é‡Œï¼Œå°±å®Œæˆäº† å®˜æ–¹æ–‡æ¡£è§£é‡Šçš„å¸¸ç”¨å‘½ä»¤ï¼šä¸åŒæƒ…å¢ƒä¸‹å¸¸ç”¨çš„ git å‘½ä»¤ï¼š 123456789101112131415161718192021222324252627282930313233343536start a working area `clone` Clone a repository into a new directory `init` Create an empty Git repository or reinitialize an existing onework on the current change `add` Add file contents to the index `mv` Move or rename a file, a directory, or a symlink `eset` Reset current HEAD to the specified state `rm` Remove files from the working tree and from the indexexamine the history and state `bisect` Use binary search to find the commit that introduced a bug `grep` Print lines matching a pattern `log` Show commit logs `show` Show various types of objects `status` Show the working tree statusgrow, mark and tweak your common history ` branch` List, create, or delete branches `checkout` Switch branches or restore working tree files `commit` Record changes to the repository `diff` Show changes between commits, commit and working tree, etc `merge` Join two or more development histories together `rebase` Reapply commits on top of another base tip `tag` Create, list, delete or verify a tag object signed with GPGcollaborate `fetch` Download objects and refs from another repository `pull` Fetch from and integrate with another repository or a local branch `push` Update remote refs along with associated objects åˆ†æ”¯ç­–ç•¥ ä¸»åˆ†æ”¯ master ç”¨äºŽå‘å¸ƒç‰ˆæœ¬ ä¿æŒç¨³å®š å¼€å‘åˆ†æ”¯ develop ç”¨äºŽæ—¥å¸¸å¼€å‘ æ¯æ—¥æäº¤ å½“å‘å¸ƒç‰ˆæœ¬æ—¶ åˆå¹¶åˆ°master ç”¨äºŽå‘å¸ƒ å¹¶åšæ ‡è®° åˆå¹¶å®Œæˆå¤„ç†å®Œå†²çªåŽ è¦è®°å¾—æ›´æ–°develop ä¸´æ—¶åˆ†æ”¯ : feature-new åŠŸèƒ½åˆ†æ”¯ åŸºäºŽ develop å¼€å‘å®ŒæˆåŽåˆå¹¶åˆ°develop æœ€åŽåˆ é™¤åŠŸèƒ½åˆ†æ”¯ release-new é¢„å‘å¸ƒåˆ†æ”¯ åŸºäºŽ develop å‘ç‰ˆå‰åˆ†å‡º æµ‹è¯•é€šè¿‡åŽ, å…ˆåˆå¹¶åˆ°masterä¸Š (æµ‹è¯•å¯èƒ½æ—¶é—´é•¿ develop æ¯å¤©æ­£å¸¸å¼€å‘ commit ) develop å†åˆå¹¶åˆ°developä¸Š(é¢„å‘å¸ƒåˆ†æ”¯ä¸Šå¯èƒ½æœ‰ commit å½’å¹¶åˆ° develop ä¸Š) æœ€åŽåˆ é™¤é¢„å‘å¸ƒåˆ†æ”¯ fixbug-new ä¿®å¤ bug åˆ†æ”¯ åŸºäºŽmasteråˆ†æ”¯ åˆå¹¶åˆ° master å’Œ develop åˆ†æ”¯ä¸Š æœ€åŽåˆ é™¤bugåˆ†æ”¯ â€‹ æƒ…æ™¯: (å•äººå¼€å‘ æœªè€ƒè™‘åˆ°å†²çª)å‘çŽ°ä¹‹å‰ç‰ˆæœ¬æœ‰bugéœ€è¦ç´§æ€¥ä¿®å¤, ä¿®å¤å®ŒæˆåŽåˆå¹¶åˆ°çŽ°æœ‰ä»£ç å†… å›žæ»šåˆ° bug ç‰ˆæœ¬ git reset â€”hard (bugç‰ˆæœ¬å·) å·¥ç¨‹å†…ä¿®å¤bug å¹¶æ‰§è¡Œ add commit (ä¿®å¤bug) ç­‰æ“ä½œ æ‹‰å–è¿œç«¯ä»£ç  pull ç„¶åŽåˆå¹¶ä»£ç  push åˆ°è¿œç«¯æœåŠ¡å™¨]]></content>
  </entry>
  <entry>
    <title><![CDATA[Swift Struct References]]></title>
    <url>%2F2017%2F08%2F27%2FSwift-Struct-References.html</url>
    <content type="text"><![CDATA[æœ€è¿‘æˆ‘æ‰“ç®—ä¸º Swift çš„æœ€æ–°çš„ keypaths æ‰¾ä¸€ä¸ªå¥½çš„ä½¿ç”¨åœºæ™¯ï¼Œè¿™ç¯‡æ–‡ç« ä»‹ç»äº†æˆ‘æ„å¤–èŽ·å¾—çš„ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ã€‚è¿™æ˜¯æˆ‘åˆšç ”ç©¶å‡ºæ¥çš„ï¼Œä½†è¿˜æ²¡å®žé™…åº”ç”¨åœ¨ç”Ÿäº§ä»£ç ä¸Šçš„æˆæžœã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘åªæ˜¯è§‰å¾—è¿™ä¸ªæˆæžœéžå¸¸é…·å¹¶æƒ³æŠŠå®ƒå±•ç¤ºå‡ºæ¥ã€‚ æ‰€æœ‰çš„ä»£ç éƒ½å¯ä»¥åœ¨ gist ä¸ŠèŽ·å–ã€‚ æ€è€ƒä¸€ä¸ªç®€å•çš„é€šè®¯å½•åº”ç”¨ï¼Œè¿™ä¸ªåº”ç”¨åŒ…å«ä¸€ä¸ªå±•ç¤ºè”ç³»äººçš„åˆ—è¡¨è§†å›¾å’Œå±•ç¤ºè”ç³»äººå®žä¾‹çš„è¯¦æƒ…è§†å›¾æŽ§åˆ¶å™¨ã€‚å¦‚æžœæŠŠ äºº å®šä¹‰æˆä¸€ä¸ªç±»çš„è¯ï¼Œå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­ï¼š 123456789101112131415class Person &#123;var name: Stringvar addresses: [Address]init(name: String, addresses: [Address]) &#123;self.name = nameself.addresses = addresses&#125;&#125;class Address &#123;var street: Stringinit(street: String) &#123;self.street = street&#125;&#125; æˆ‘ä»¬çš„ï¼ˆå‡è®¾ï¼‰viewController æœ‰ä¸€ä¸ªé€šè¿‡åˆå§‹åŒ–æ–¹æ³•è®¾ç½®çš„ person å±žæ€§ã€‚è¿™ä¸ªç±»è¿˜æœ‰ä¸€ä¸ª change æ–¹æ³•æ¥ä¿®æ”¹è¿™ä¸ªäººçš„å±žæ€§ã€‚ 12345678910final class PersonVC &#123;var person: Personinit(person: Person) &#123;self.person = person&#125;func change() &#123;person.name = "New Name"&#125;&#125; è®©æˆ‘ä»¬æ€è€ƒä¸‹å½“ Person åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡åŽé‡åˆ°çš„é—®é¢˜ï¼š å› ä¸º person æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå…¶ä»–éƒ¨åˆ†çš„ä»£ç å°±å¯èƒ½ä¿®æ”¹å®ƒã€‚è¿™æ˜¯éžå¸¸å®žç”¨çš„ï¼Œå› ä¸ºè¿™è®©æ¶ˆæ¯ä¼ é€’æˆä¸ºäº†å¯èƒ½ã€‚è€Œä¸Žæ­¤åŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯æˆ‘ä»¬å¯ä»¥ä¸€ç›´ç›‘å¬çš„åˆ°è¿™äº›æ”¹å˜ï¼ˆæ¯”å¦‚ä½¿ç”¨ KVO ï¼‰ï¼Œå¦åˆ™æˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°æ•°æ®ä¸åŒæ­¥çš„é—®é¢˜ã€‚ä½†ä¿è¯æˆ‘ä»¬èƒ½å¤Ÿå®žæ—¶ç›‘å¬åˆ™æ˜¯ä¸å®¹æ˜“å®žçŽ°çš„ã€‚ å½“åœ°å€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ”¶åˆ°é€šçŸ¥å°±æ›´éš¾äº†ã€‚è§‚å¯ŸåµŒå¥—çš„å¯¹è±¡å±žæ€§åˆ™æ˜¯æœ€å›°éš¾çš„ã€‚ å¦‚æžœæˆ‘ä»¬éœ€è¦ç»™ Person åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„æœ¬åœ° copyï¼Œæˆ‘ä»¬å°±éœ€è¦å®žçŽ°ä¸€äº›åƒ NSCopying è¿™æ ·çš„ä¸œè¥¿ï¼Œ è¿™éœ€è¦ä¸å°‘çš„å·¥ä½œé‡ã€‚ç”šè‡³å½“æˆ‘ä»¬å†³å®šè¿™ä¹ˆåšæ—¶ï¼Œæˆ‘ä»¬ä»ç„¶ä¸å¾—ä¸è€ƒè™‘æ˜¯æƒ³è¦æ·±æ‹·è´ï¼ˆåœ°å€ä¹Ÿè¢«æ‹·è´ï¼‰è¿˜æ˜¯æµ…æ‹·è´ï¼ˆåœ°å€æ•°ç»„æ˜¯ç‹¬ç«‹çš„ï¼Œä½†æ˜¯é‡Œé¢çš„åœ°å€ä»æŒ‡å‘ç›¸åŒçš„å¯¹è±¡ï¼‰ï¼Ÿ å¦‚æžœæˆ‘ä»¬æŠŠ Person å½“æˆ AddressBook æ•°ç»„çš„å…ƒç´ ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³è¦çŸ¥é“é€šè®¯å½•ä»€ä¹ˆæ—¶å€™åšäº†ä¿®æ”¹ï¼ˆæ¯”å¦‚è¯´è¿›è¡ŒæŽ’åºï¼‰ã€‚è€Œæƒ³è¦çŸ¥é“ä½ çš„å¯¹è±¡å›¾ä¸­çš„ä¸œè¥¿ä½•æ—¶åšäº†æ”¹å˜è¦ä¹ˆéœ€è¦å¤§é‡çš„æ ·æ¿ï¼Œè¦ä¹ˆéœ€è¦å¤§é‡çš„è§‚å¯Ÿã€‚ å¦‚æžœ Person å’Œ Address åšæˆç»“æž„ä½“çš„è¯ï¼Œæˆ‘ä»¬åˆä¼šç¢°åˆ°ä¸åŒçš„é—®é¢˜ï¼š æ¯ä¸ªç»“æž„ä½“éƒ½æ˜¯ç‹¬ç«‹çš„æ‹·è´ã€‚è¿™æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“å®ƒæ€»æ˜¯ä¸€è‡´çš„ï¼Œä¸ä¼šåœ¨æˆ‘ä»¬æ‰‹åº•ä¸‹æ”¹å˜ã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬åœ¨è¯¦æƒ…æŽ§åˆ¶å™¨ ä¸­å¯¹ Person åšäº†ä¿®æ”¹æ—¶ã€‚æˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªæ–¹æ³•æ¥å°†è¿™äº›æ”¹å˜åé¦ˆç»™åˆ—è¡¨è§†å›¾ï¼ˆæˆ–è€…è¯´é€šè®¯å½•åˆ—è¡¨ï¼‰ã€‚è€Œå¯¹äºŽå¯¹è±¡ï¼Œè¿™ç§æƒ…å†µä¼šè‡ªåŠ¨å‘ç”Ÿï¼ˆé€šè¿‡åœ¨é€‚å½“çš„ä½ç½®ä¿®æ”¹ Person ï¼‰ã€‚ æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿé€šè®¯å½•ç»“æž„ä½“çš„æ ¹åœ°å€ï¼Œä»Žè€ŒçŸ¥é“é€šè®¯å½•å‘ç”Ÿçš„ä»»ä½•å˜åŒ–ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¸èƒ½å¾ˆå®¹æ˜“å¾—è§‚å¯Ÿåˆ°å®ƒå†…éƒ¨å±žæ€§çš„å˜åŒ–ï¼ˆæ¯”å¦‚ï¼šè§‚å¯Ÿç¬¬ä¸€ä¸ªäººçš„åå­—ï¼‰ã€‚ æˆ‘çŽ°åœ¨æå‡ºçš„è§£å†³æ–¹æ¡ˆç»“åˆäº†ä¸¤ä¸ªæ–¹æ¡ˆçš„æœ€å¤§ä¼˜åŠ¿ï¼š æˆ‘ä»¬æœ‰å¯å˜çš„å…±äº«æŒ‡é’ˆ å› ä¸ºåº•å±‚æ•°æ®æ˜¯ç»“æž„ä½“ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éšæ—¶å¾—åˆ°æˆ‘ä»¬è‡ªå·±çš„ç‹¬ç«‹æ‹·è´ æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä»»ä½•éƒ¨åˆ†ï¼šæ— è®ºåœ¨æ ¹çº§åˆ«ï¼Œè¿˜æ˜¯è§‚å¯Ÿç‹¬ç«‹çš„å±žæ€§ï¼ˆä¾‹å¦‚ç¬¬ä¸€ä¸ªäººçš„åå­—ï¼‰ æˆ‘æŽ¥ä¸‹æ¥ä¼šæ¼”ç¤ºè¿™ä¸ªæ–¹æ¡ˆæ€Žä¹ˆä½¿ç”¨ï¼Œå¦‚ä½•å·¥ä½œï¼Œæœ€åŽå†è¯´è¯´æ–¹æ¡ˆçš„å±€é™æ€§å’Œé—®é¢˜ã€‚ è®©æˆ‘ä»¬ç”¨ç»“æž„ä½“æ¥åˆ›å»ºä¸€ä¸ªé€šè®¯å½•ã€‚ 123456789struct Address &#123;var street: String&#125;struct Person &#123;var name: Stringvar addresses: [Address]&#125;typealias Addressbook = [Person] çŽ°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ Ref ç±»åž‹ï¼ˆ Reference çš„ç®€ç§°ï¼‰ã€‚æˆ‘ä»¬ç”¨ä¸€ä¸ªåˆå§‹åŒ–çš„ç©ºæ•°ç»„æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ addressBookã€‚ç„¶åŽæ·»åŠ ä¸€ä¸ª Person ã€‚æŽ¥ä¸‹æ¥å°±æ˜¯æœ€é…·çš„åœ°æ–¹ï¼šé€šè¿‡ä½¿ç”¨ä¸‹æ ‡æˆ‘ä»¬å¯ä»¥èŽ·å¾—æŒ‡å‘ç¬¬ä¸€ä¸ªäººçš„ æŒ‡é’ˆ ï¼ŒæŽ¥ç€æ˜¯ä¸€ä¸ªæŒ‡å‘ä»–ä»¬åå­—çš„ æŒ‡é’ˆ ã€‚æˆ‘ä»¬å¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹æ”¹ä¸º â€œNew Name&quot; æ¥éªŒè¯æˆ‘ä»¬æ˜¯å¦æ›´æ”¹äº†åŽŸå§‹çš„é€šè®¯å½•ã€‚ 123456let addressBook = Ref&lt;Addressbook&gt;(initialValue: [])addressBook.value.append(Person(name: "Test", addresses: []))let firstPerson: Ref&lt;Person&gt; = addressBook[0]let nameOfFirstPerson: Ref&lt;String&gt; = firstPerson[\.name]nameOfFirstPerson.value = "New Name"addressBook.value // shows [Person(name: "New Name", addresses: [])] firstPerson å’Œ nameOfFirstPerson ç±»åž‹å¯ä»¥è¢«å¿½ç•¥ï¼Œå®ƒä»¬ä»…ä»…æ˜¯ä¸ºäº†å¢žåŠ ä»£ç å¯è¯»æ€§ã€‚ æ— è®ºä½•æ—¶æˆ‘ä»¬éƒ½å¯ä»¥å¯¹ Person å†…å®¹è¿›è¡Œç‹¬ç«‹å¤‡ä»½ã€‚ä¸€æ—¦ä½ åšäº†æ‹·è´ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ myOwnCopy ï¼Œå¹¶ä¸”ä¸å¿…å®žçŽ° NSCopying å°±èƒ½ä¿è¯å®ƒçš„å†…å®¹ä¸ä¼šåœ¨æˆ‘ä»¬æ‰‹åº•ä¸‹æ”¹å˜ï¼š var myOwnCopy: Person = firstPerson.value æˆ‘ä»¬å¯ä»¥ç›‘å¬ä»»ä½• Ref ã€‚å°±åƒ reactive åº“ä¸€æ ·ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå¯ä»¥æŽ§åˆ¶è§‚å¯Ÿè€…ç”Ÿå‘½å‘¨æœŸçš„ä¸€æ¬¡æ€§è°ƒç”¨ï¼š 123456var disposable: Any?disposable = addressBook.addObserver &#123; newValue inprint(newValue) // Prints the entire address book&#125;disposable = nil // stop observing æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›‘å¬ nameOfFirstPerson ã€‚åœ¨ç›®å‰çš„å®žçŽ°ä¸­ï¼Œæ— è®ºä»€ä¹ˆæ—¶å€™é€šè®¯å½•ä¸­çš„ä»»ä½•æ”¹å˜éƒ½ä¼šè§¦å‘ç›‘å¬ï¼Œä½†ä»¥åŽçš„å®žçŽ°ä¼šæœ‰æ›´å¤šçš„åŠŸèƒ½ã€‚ 123nameOfFirstPerson.addObserver &#123; newValue inprint(newValue) // Prints a string&#125; è®©æˆ‘ä»¬è¿”å›žæˆ‘ä»¬çš„ PersonVC ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Ref ä½œä¸ºä»–çš„å®žçŽ°ã€‚ è¿™æ · viewController å°±å¯ä»¥æ”¶åˆ°æ¯ä¸€æ¬¡æ›´æ”¹ã€‚åœ¨å“åº”å¼ç¼–ç¨‹ä¸­ï¼Œä¿¡å·é€šå¸¸æ˜¯åªè¯»ç±»åž‹çš„ï¼ˆä½ åªä¼šæ”¶åˆ°å‘ç”Ÿäº†å˜åŒ–çš„ä¿¡æ¯ï¼‰ï¼Œè¿™æ—¶ä½ å°±éœ€è¦æ‰¾åˆ°å¦ä¸€ç§å›žä¼ ä¿¡å·çš„æ–¹æ³•ã€‚ åœ¨ Ref æ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ person.value è¿›è¡Œå›žå†™ï¼š 1234567891011121314final class PersonVC &#123;let person: Ref&lt;Person&gt;var disposeBag: Any?init(person: Ref&lt;Person&gt;) &#123;self.person = persondisposeBag = person.addObserver &#123; newValue inprint("update view for new person value: \(newValue)")&#125;&#125;func change() &#123;person.value.name = "New Name"&#125;&#125; è¿™ä¸ª PersonVC ä¸çŸ¥é“ Ref &lt;Person&gt;æ˜¯ä»Žå“ªé‡ŒèŽ·å¾—çš„ï¼šæ˜¯ä»Žä¸€ä¸ª person æ•°ç»„ï¼Œä¸€ä¸ªæ•°æ®åº“æˆ–è€…å…¶ä»–åœ°æ–¹ã€‚å®žé™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æˆ‘ä»¬çš„æ•°ç»„åŒ…è£…åœ¨ History ç»“æž„ä½“ ä¸­æ¥æ’¤é”€å¯¹æˆ‘ä»¬é€šè®¯å½•çš„æ”¯æŒã€‚è¿™æ ·æˆ‘ä»¬å°±ä¸å†éœ€è¦ä¿®æ”¹ PersonVCï¼š 12345678let source: Ref&lt;History&lt;Addressbook&gt;&gt; = Ref(initialValue: History(initialValue: []))let addressBook: Ref&lt;Addressbook&gt; = source[\.value]addressBook.value.append(Person(name: "Test", addresses: []))addressBook[0].value.name = "New Name"print(addressBook[0].value)source.value.undo()print(addressBook[0].value)source.value.redo() æˆ‘ä»¬è¿˜å¯ä»¥ä¸ºå®ƒæ·»åŠ å…¶ä»–çš„å¾ˆå¤šä¸œè¥¿ï¼šç¼“å­˜ï¼Œåºåˆ—åŒ–ï¼Œè‡ªåŠ¨åŒæ­¥ï¼ˆæ¯”å¦‚åªåœ¨å­çº¿ç¨‹ä¸Šä¿®æ”¹å’Œè§‚å¯Ÿï¼‰ï¼Œä½†è¿™éƒ½æ˜¯ä¹‹åŽçš„å·¥ä½œã€‚ å®žçŽ°ç»†èŠ‚æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªäº‹æƒ…æ˜¯å¦‚ä½•å®žçŽ°çš„ã€‚æˆ‘ä»¬é¦–å…ˆä»Ž Ref ç±»çš„å®šä¹‰å¼€å§‹ã€‚Ref åŒ…å«ä¸€ä¸ªèŽ·å–å€¼å’Œä¸€ä¸ªè®¾ç½®å€¼çš„æ–¹æ³•ï¼Œä»¥åŠæ·»åŠ ä¸€ä¸ªè§‚å¯Ÿè€…çš„æ–¹æ³•ã€‚å®ƒæœ‰ä¸€ä¸ªéœ€è¦ä¸‰ä¸ªå‚æ•°çš„åˆå§‹åŒ–æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526final class Ref&lt;A&gt; &#123;typealias Observer = (A) -&gt; ()private let _get: () -&gt; Aprivate let _set: (A) -&gt; ()private let _addObserver: (@escaping Observer) -&gt; Disposablevar value: A &#123;get &#123;return _get()&#125;set &#123;_set(newValue)&#125;&#125;init(get: @escaping () -&gt; A, set: @escaping (A) -&gt; (), addObserver: @escaping (@escaping Observer) -&gt; Disposable) &#123;_get = get_set = set_addObserver = addObserver&#125;func addObserver(observer: @escaping Observer) -&gt; Disposable &#123;return _addObserver(observer)&#125;&#125; çŽ°åœ¨æˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªå¯ä»¥è§‚å¯Ÿå•ä¸ªç»“æž„ä½“å€¼çš„åˆå§‹åŒ–æ–¹æ³•ã€‚å®ƒåˆ›å»ºäº†ä¸€ä¸ªè§‚å¯Ÿè€…å’Œå˜é‡å¯¹åº”çš„å­—å…¸ã€‚è¿™æ ·æ— è®ºå˜é‡ä»€ä¹ˆæ—¶å€™è¢«ä¿®æ”¹äº†ï¼Œæ‰€æœ‰çš„è§‚å¯Ÿè€…éƒ½ä¼šè¢«é€šçŸ¥åˆ°ã€‚å®ƒä½¿ç”¨ä¸Šè¿°å®šä¹‰çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¹¶ä¼ é€’ç»™ get, set, å’Œ addObserver: 12345678910111213141516171819extension Ref &#123;convenience init(initialValue: A) &#123;var observers: [Int: Observer] = [:]var theValue = initialValue &#123;didSet &#123; observers.values.forEach &#123; $0(theValue) &#125; &#125;&#125;var freshId = (Int.min...).makeIterator()let get = &#123; theValue &#125;let set = &#123; newValue in theValue = newValue &#125;let addObserver = &#123; (newObserver: @escaping Observer) -&gt; Disposable inlet id = freshId.next()!observers[id] = newObserverreturn Disposable &#123;observers[id] = nil&#125;&#125;self.init(get: get, set: set, addObserver: addObserver)&#125;&#125; æƒ³ä¸€ä¸‹æˆ‘ä»¬çŽ°åœ¨å·²ç»æœ‰ Person æŒ‡é’ˆï¼Œä¸ºäº†æ‹¿åˆ° Person name å±žæ€§çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹å¼æ¥å¯¹ name è¿›è¡Œè¯»å†™æ“ä½œã€‚è€Œ WritableKeyPath æ°å¥½å¯ä»¥åšåˆ°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ Ref ä¸­æ·»åŠ ä¸€ä¸ªsubscript æ¥åˆ›å»ºå¯ä»¥æŒ‡å‘ Person æŸä¸€éƒ¨åˆ†çš„æŒ‡é’ˆï¼š 123456789101112extension Ref &#123;subscript&lt;B&gt;(keyPath: WritableKeyPath&lt;A,B&gt;) -&gt; Ref&lt;B&gt; &#123;let parent = selfreturn Ref&lt;B&gt;(get: &#123; parent._get()[keyPath: keyPath] &#125;, set: &#123;var oldValue = parent.valueoldValue[keyPath: keyPath] = $0parent._set(oldValue)&#125;, addObserver: &#123; observer inparent.addObserver &#123; observer($0[keyPath: keyPath]) &#125;&#125;)&#125;&#125; ä¸Šé¢çš„ä»£ç æœ‰ä¸€ç‚¹éš¾äºŽç†è§£ï¼Œä½†å¦‚æžœåªæ˜¯ä¸ºäº†ä½¿ç”¨è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬ä¸éœ€è¦çœŸçš„å¼„æ˜Žç™½å®ƒæ˜¯æ€Žä¹ˆå®žçŽ°çš„ã€‚ ä¹Ÿè®¸æŸä¸€å¤©ï¼ŒSwift ä¸­çš„ keypath ä¹Ÿä¼šæ”¯æŒä¸‹æ ‡ï¼Œä½†è‡³å°‘çŽ°åœ¨æ²¡æœ‰ï¼ŒæŽ¥ä¸‹æ¥æˆ‘ä»¬å¿…é¡»ä¸ºé›†åˆæ·»åŠ å¦å¤–ä¸€ä¸ªä¸‹æ ‡ã€‚é™¤äº†ä½¿ç”¨ç´¢å¼•è€Œä¸æ˜¯ keypath ï¼Œå®ƒçš„å®žçŽ°å‡ ä¹Žå°±è·Ÿä¸Šé¢çš„ä¸€æ ·ã€‚ 1234567891011extension Ref where A: MutableCollection &#123;subscript(index: A.Index) -&gt; Ref&lt;A.Element&gt; &#123;return Ref&lt;A.Element&gt;(get: &#123; self._get()[index] &#125;, set: &#123; newValue invar old = self.valueold[index] = newValueself._set(old)&#125;, addObserver: &#123; observer inself.addObserver &#123; observer($0[index]) &#125;&#125;)&#125;&#125; è¿™å°±æ˜¯å…¨éƒ¨å®žçŽ°äº†ã€‚ä¸Šé¢ä»£ç ä½¿ç”¨äº† Swift å¤§é‡æ–°ç‰¹æ€§ï¼Œä½†å®ƒä»ä¿æŒåœ¨ 100 è¡Œä»£ç ä»¥ä¸‹ã€‚å¦‚æžœæ²¡æœ‰ Swift 4 æœ€æ–°åŠŸèƒ½ï¼Œè¿™ä¹ŸåŸºæœ¬ä¸å¯èƒ½å®žçŽ°ã€‚å®ƒä¾èµ–äºŽ keypaths ï¼Œé€šç”¨ä¸‹æ ‡ï¼Œå¼€æ”¾èŒƒå›´ä»¥åŠä»¥å‰åœ¨ Swift ä¸­æä¾›çš„è®¸å¤šåŠŸèƒ½ã€‚ è®¨è®ºå°±å¦‚ä¹‹å‰æ‰€æåˆ°çš„é‚£æ ·ï¼Œè¿™äº›ä»å¤„äºŽç ”ç©¶ä¸­è€Œä¸æ˜¯ç”Ÿäº§çº§çš„ä»£ç ã€‚ä¸€æ—¦æˆ‘å¼€å§‹åœ¨ä¸€ä¸ªçœŸæ­£çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨å®ƒï¼Œæˆ‘éžå¸¸æ„Ÿå…´è¶£æƒ³çŸ¥é“å°†æ¥ä¼šé‡åˆ°ä»€ä¹ˆæ ·é—®é¢˜ã€‚ ä¸‹é¢å°±æ˜¯å…¶ä¸­ä¸€ä¸ªè®©æˆ‘æ„Ÿåˆ°å›°æƒ‘çš„ä»£ç æ®µï¼šï¼š 123456var twoPeople: Ref&lt;Addressbook&gt; = Ref(initialValue:[Person(name: "One", addresses: []),Person(name: "Two", addresses: [])])let p0 = twoPeople[0]twoPeople.value.removeFirst()print(p0.value) // what does this print? æˆ‘å¾ˆæœ‰å…´è¶£å°†å®ƒæ›´è¿›ä¸€æ­¥ã€‚æˆ‘ç”šè‡³å¯ä»¥æƒ³è±¡çš„åˆ°ï¼Œå¦‚æžœæˆ‘ä¸ºä»–æ·»åŠ é˜Ÿåˆ—æ”¯æŒï¼Œä½ å°±å¯ä»¥åƒä¸‹é¢é‚£æ ·ä½¿ç”¨ï¼š 12var source = Ref&lt;Addressbook&gt;(initialValue: [],queue: DispatchQueue(label: "private queue")) æˆ‘è¿˜èƒ½æƒ³è±¡çš„åˆ°ä½ å¯ä»¥ç”¨å®ƒå’Œæ•°æ®åº“æ­é…ä½¿ç”¨ã€‚è¿™ä¸ª Var å°†ä¼šè®©ä½ åŒæ—¶æ”¯æŒè¯»å†™æ“ä½œï¼Œå¹¶è®¢é˜…ä»»ä½•ä¿®æ”¹çš„é€šçŸ¥ï¼š 1234final class MyDatabase &#123;func readPerson(id: Person.Id) -&gt; Var&lt;Person&gt; &#123;&#125;&#125; æˆ‘æœŸå¾…ç€å¬åˆ°æ‚¨çš„è¯„è®ºå’Œåé¦ˆï¼Œå¦‚æžœä½ éœ€è¦æ›´æ·±å…¥çš„ç†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¯•ç€è‡ªå·±åŽ»å®žçŽ°å®ƒï¼ˆå³ä¾¿ä½ å·²ç»çœ‹äº†ä»£ç ï¼‰ã€‚é¡ºä¾¿æä¸€ä¸‹ï¼Œæˆ‘ä»¬å°†ä¼šä»¥å®ƒä¸ºä¸»é¢˜å¼€å±•ä¸¤åœº Swift Talkã€‚å¦‚æžœä½ å¯¹ Florian å’Œæˆ‘ä»Žå¤´å¼€å§‹æž„å»ºè¿™ä¸ªé¡¹ç›®æ„Ÿå…´è¶£ï¼Œå°±è®¢é˜…å®ƒå§ã€‚ æ›´æ–°ï¼š æ„Ÿè°¢ Egor Sobko æŒ‡å‡ºäº†ä¸€ä¸ªå¾®å¦™ä½†å´è‡³å…³é‡è¦çš„é”™è¯¯:æˆ‘ä¸ºè§‚å¯Ÿè€…å‘é€çš„æ˜¯ initialValue è€Œä¸æ˜¯ theValueï¼Œå·²ä¿®æ”¹! è¯‘æ–‡å‡ºè‡ªï¼šæŽ˜é‡‘ç¿»è¯‘è®¡åˆ’ è¯‘è€…ï¼š Swants æ ¡å¯¹è€…ï¼š ChenDongnan FlyOceanFish]]></content>
  </entry>
  <entry>
    <title><![CDATA[Swift ä¸­çš„é€šç”¨æ•°æ®æº]]></title>
    <url>%2F2017%2F08%2F14%2FSwift-%E4%B8%AD%E7%9A%84%E9%80%9A%E7%94%A8%E6%95%B0%E6%8D%AE%E6%BA%90.html</url>
    <content type="text"><![CDATA[åœ¨æˆ‘å¼€å‘çš„ç»å¤§å¤šæ•° iOS app ä¸­ï¼Œ tableView å’Œ collectionView ç»å¯¹æ˜¯æœ€å¸¸ç”¨çš„ UI ç»„ä»¶ã€‚é‰´äºŽè®¾ç½®ä¸€ä¸ª tableView æˆ– collectionView éœ€è¦å¤§é‡æ ·æ¿ä»£ç ï¼Œæˆ‘æœ€è¿‘èŠ±äº†äº›æ—¶é—´æ‰¾åˆ°ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ï¼ŒåŽ»é¿å…ä¸€éåˆä¸€éåœ°é‡å¤åŒæ ·çš„ä»£ç ã€‚æˆ‘çš„ä¸»è¦å·¥ä½œæ˜¯å¯¹å¿…éœ€çš„æ ·æ¿ä»£ç è¿›è¡ŒæŠ½å–å°è£…ã€‚éšç€æ—¶é—´çš„æŽ¨ç§»ï¼Œå¾ˆå¤šå…¶ä»–å¼€å‘è€…ä¹Ÿè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å¹¶ä¸”éšç€ Swift çš„æœ€æ–°è¿›å±•å‡ºçŽ°äº†å¾ˆå¤šæœ‰è¶£çš„è§£å†³æ–¹æ¡ˆã€‚ æœ¬ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘å°†ä»‹ç»åœ¨æˆ‘ APP é‡Œå·²ç»ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™ä¸ªæ–¹æ¡ˆè®©æˆ‘åœ¨è®¾ç½® collectionView çš„æ—¶å€™å‡å°‘äº†å¤§é‡çš„æ ·æ¿ä»£ç ã€‚ TableView vs CollectionViewæœ‰äº›äººå¯èƒ½ä¼šé—® ä¸ºä»€ä¹ˆå•è®¨è®º collectionView è€Œä¸æ tableView å‘¢? åœ¨æœ€è¿‘çš„å‡ ä¸ªæœˆé‡Œï¼Œæˆ‘åœ¨ä¹‹å‰å¯ä»¥ä½¿ç”¨ tableView çš„åœ°æ–¹éƒ½ä½¿ç”¨æˆäº† collectionView ã€‚å®ƒä»¬åˆ°ç›®å‰ä¸ºæ­¢è¡¨çŽ°è‰¯å¥½ï¼è¿™ä¸€åšæ³•å¸®åŠ©æˆ‘ä¸ç”¨åŽ»åŒºåˆ†è¿™ä¸¤ä¸ª å‡ ä¹Žå®Œå…¨ ç›¸ä¼¼ä½†å¹¶ä¸å®Œå…¨ç›¸åŒçš„é›†åˆæ¦‚å¿µã€‚æŽ¥ä¸‹æ¥åˆ™æ˜¯è®©æˆ‘åšå‡ºè¿™ä¸€å†³å®šçš„æ ¹æœ¬åŽŸå› ï¼š ä»»ä½• tableView éƒ½å¯ä»¥ç”¨å•åˆ—çš„ collectionView è¿›è¡Œå®žçŽ°/é‡æž„ã€‚ tableView åœ¨å¤§å±å¹•ä¸Šï¼ˆå¦‚ï¼šiPad ï¼‰è¡¨çŽ°çš„ä¸æ˜¯ç‰¹åˆ«å¥½ã€‚ éœ€è¦è¯´æ˜Žçš„æ˜¯ï¼Œæˆ‘æ²¡æœ‰å»ºè®®ä½ æŠŠä»£ç åº“é‡Œæ‰€æœ‰çš„ tableView éƒ½ç”¨ collectionView é‡æ–°å®žçŽ°ã€‚æˆ‘å»ºè®®çš„æ˜¯ï¼Œå½“ä½ éœ€è¦æ·»åŠ ä¸€ä¸ªå±•ç¤ºåˆ—è¡¨çš„æ–°åŠŸèƒ½æ—¶ï¼Œä½ åº”è¯¥è€ƒè™‘ä¸‹ä½¿ç”¨ collectionView æ¥ä»£æ›¿ tableView ã€‚å°¤å…¶æ˜¯åœ¨ä½ å¼€å‘ä¸€ä¸ª Universal APP æ—¶ï¼Œå› ä¸º collectionView å°†è®©ä½ çš„ APP åœ¨æ‰€æœ‰å°ºå¯¸å±å¹•ä¸ŠåŠ¨æ€è°ƒæ•´å¸ƒå±€å˜å¾—æ›´ç®€å•ã€‚ Swift æ³›åž‹ä¸Žæœ‰æ•ˆæŠ½å–çš„æŽ¢ç´¢æˆ‘ä¸€ç›´æ˜¯æ³›åž‹ç¼–ç¨‹çš„æ‹¥è¶¸ï¼Œæ‰€ä»¥ä½ èƒ½æƒ³è±¡çš„åˆ°å½“è‹¹æžœå®£å¸ƒåœ¨ Swift ä¸­å¼•è¿›æ³›åž‹æ—¶ï¼Œæˆ‘æ˜¯å¤šä¹ˆçš„å…´å¥‹ã€‚ä½†æ˜¯æ³›åž‹å’Œåè®®ç»“åˆæœ‰æ—¶å¹¶ä¸åˆä½œçš„é‚£ä¹ˆå’Œè°ã€‚è¿™æ—¶ Swift 2.x ä¸­å…³äºŽ å…³è”ç±»åž‹ çš„ä»‹ç»è®©ä½¿ç”¨æ³›åž‹åè®®å˜å¾—æ›´åŠ ç®€å•ï¼Œè¶Šæ¥è¶Šå¤šçš„å¼€å‘è€…å¼€å§‹åŽ»å°è¯•ä½¿ç”¨å®ƒä»¬ã€‚ æˆ‘æ‰“ç®—å±•ç¤ºçš„ä»£ç æŠ½å–æ˜¯åŸºäºŽå¯¹æ³›åž‹ä½¿ç”¨çš„å°è¯•ï¼Œå°¤å…¶æ˜¯æ³›åž‹åè®®ã€‚è¿™æ ·çš„ä»£ç æŠ½å–èƒ½å¤Ÿè®©æˆ‘å¯¹è®¾ç½® collectionView æ‰€éœ€çš„æ ·æ¿ä»£ç è¿›è¡Œå°è£…ï¼Œä»Žè€Œå‡å°‘è®¾ç½®æ•°æ®æºæ‰€éœ€çš„ä»£ç ï¼Œç”šè‡³åœ¨ä¸€äº›ç®€å•çš„ä½¿ç”¨åœºæ™¯ä¸¤è¡Œä»£ç å°±è¶³å¤Ÿäº†ã€‚ æˆ‘æƒ³è¯´æ˜Žä¸‹æˆ‘æ‰€åˆ›å»ºçš„ä¸æ˜¯é€šè§£ã€‚æˆ‘åšçš„ä»£ç å°è£…é’ˆå¯¹äºŽè§£å†³ä¸€äº›ç‰¹å®šä½¿ç”¨åœºæ™¯ã€‚å¯¹äºŽè¿™äº›åœºæ™¯æ¥è¯´ï¼Œä½¿ç”¨æŠ½å–å°è£…åŽçš„ä»£ç æ•ˆæžœéžå¸¸å¥½ã€‚å¯¹äºŽä¸€äº›å¤æ‚çš„ä½¿ç”¨åœºæ™¯ï¼Œå¯èƒ½å°±éœ€è¦æ·»åŠ é¢å¤–çš„ä»£ç äº†ã€‚æˆ‘æŠŠæŠ½å–å·¥ä½œä¸»è¦æ”¾åœ¨äº† collectionView æœ€å¸¸ç”¨çš„åŠŸèƒ½ã€‚å¦‚æžœéœ€è¦çš„è¯ï¼Œä½ å¯ä»¥å°è£…æ›´å¤šçš„åŠŸèƒ½ï¼Œä½†æ˜¯å¯¹äºŽæˆ‘çš„ç‰¹å®šåœºæ™¯æ¥è¯´ï¼Œè¿™å¹¶ä¸æ˜¯å¿…éœ€çš„ã€‚ ä½œä¸ºæœ¬ç¯‡æ–‡ç« çš„ç›®çš„ï¼Œæˆ‘å°†ä¼šå±•ç¤ºä¸€éƒ¨åˆ†æŠ½å–ä»£ç æ¥æ¦‚æ‹¬ä½¿ç”¨ collectionView æ—¶å¸¸ç”¨çš„åŠŸèƒ½ã€‚è¿™å°†æ˜¯ä½ äº†è§£ä½¿ç”¨æ³›åž‹ï¼Œå°¤å…¶æ˜¯æ³›åž‹åè®®èƒ½å¤Ÿæ¥åšä»€ä¹ˆçš„ä¸€ä¸ªå¥½çš„æœºä¼šã€‚ Collection View Cell æŠ½å–é¦–å…ˆï¼Œæˆ‘å®žçŽ° collectionView é€šå¸¸éƒ½æ˜¯å…ˆåˆ›å»ºå±•ç¤ºæ•°æ®çš„ cell ã€‚å¤„ç† collectionView çš„ cell æ—¶é€šå¸¸éœ€è¦ï¼š é‡ç”¨ cell é…ç½® cell ä¸ºäº†ç®€åŒ–ä¸Šé¢çš„å·¥ä½œï¼Œæˆ‘å†™äº†ä¸¤ä¸ªåè®®ï¼š ReusableCell ConfigurableCell è®©æˆ‘ä»¬è¯¦ç»†åœ°çœ‹ä¸€ä¸‹è¿™ä¸¤ä¸ªæŠ½å–åŽä»£ç å§ã€‚ ReusableCellè¿™ä¸ª ReusableCell åè®®éœ€è¦ä½ å®šä¹‰ä¸€ä¸ª é‡ç”¨æ ‡è¯†ç¬¦ ï¼Œè¿™ä¸ªæ ‡å¿—ç¬¦å°†åœ¨é‡ç”¨ cell çš„æ—¶å€™è¢«ç”¨åˆ°ã€‚åœ¨æˆ‘çš„ APP é‡Œï¼Œæˆ‘æ€»æ˜¯å›¾æ–¹ä¾¿æŠŠ cell çš„é‡ç”¨æ ‡è¯†ç¬¦è®¾ç½®ä¸ºå’Œ cell çš„ç±»åä¸€æ ·ã€‚å› æ­¤ï¼Œå¾ˆå®¹æ˜“é€šè¿‡åˆ›å»ºä¸€ä¸ªåè®®æ‰©å±•æ¥æŠ½å–å‡ºï¼Œè®© reuseIdentifier è¿”å›žä¸€ä¸ªå¸¦æœ‰ç±»åç§°çš„å­—ç¬¦ä¸²ï¼š 123456789public protocol ReusableCell &#123; static var reuseIdentifier: String &#123; get &#125;&#125;public extension ReusableCell &#123; static var reuseIdentifier: String &#123; return String(describing: self) &#125;&#125; ConfigurableCellè¿™ä¸ª ConfigurableCell åè®®éœ€è¦ä½ å®žçŽ°ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†ä½¿ç”¨ç‰¹å®šç±»åž‹çš„å®žä¾‹é…ç½® cell ,è€Œè¿™ä¸ªå®žä¾‹è¢«å®šä¹‰æˆäº†ä¸€ä¸ªæ³›åž‹ç±»åž‹ T: 12345public protocol ConfigurableCell: ReusableCell &#123; associatedtype T func configure(_ item: T, at indexPath: IndexPath)&#125; è¿™ä¸ª ConfigurableCell åè®®å°†ä¼šåœ¨åŠ è½½ cell å†…å®¹çš„æ—¶å€™è¢«è°ƒç”¨ã€‚æŽ¥ä¸‹æ¥æˆ‘ä¼šè¯¦ç»†ä»‹ç»ä¸€äº›ç»†èŠ‚ï¼ŒçŽ°åœ¨æˆ‘å°±å¼ºè°ƒä¸‹ä¸€äº›åœ°æ–¹ï¼š ConfigurableCell ç»§æ‰¿ ReusableCell ç»‘å®šç±»åž‹çš„ä½¿ç”¨ï¼ˆ ç»‘å®šç±»åž‹ T ï¼‰å°† ConfigurableCell å®šä¹‰ä¸ºæ³›åž‹åè®®ã€‚ æ•°æ®æºçš„æŠ½å–: CollectionDataProviderçŽ°åœ¨ï¼Œè®©æˆ‘ä»¬æŠŠç›®å…‰æ”¶å›žï¼Œå†å›žæƒ³ä¸‹è®¾ç½® collection view éƒ½éœ€è¦åšäº›ä»€ä¹ˆã€‚ä¸ºäº†è®© collection view å±•ç¤ºå†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦éµå¾ª UICollectionViewDataSource åè®®ã€‚é‚£ä¹ˆæœ€å…ˆè¦åšçš„å¸¸å¸¸æ˜¯ç¡®å®šä¸‹æ¥è¿™äº›: éœ€è¦å‡ ç»„ï¼šnumberOfSections(in:) æ¯ç»„éœ€è¦å‡ è¡Œï¼šcollectionView(_:numberOfItemsInSection:) cell çš„å†…å®¹æ€Žä¹ˆåŠ è½½ ï¼šcollectionView(_:cellForItemAt:) å°†ä¸Šè¿°ä»£ç†æ–¹æ³•å®žçŽ°ï¼Œä¼šç¡®ä¿æˆ‘ä»¬èƒ½å¤Ÿå¯¹æŒ‡å®š collectionView çš„ cell è¿›è¡Œå±•ç¤º ã€‚è€Œå¯¹äºŽæˆ‘æ¥è¯´ï¼Œè¿™é‡Œæ˜¯éžå¸¸é€‚åˆè¿›è¡Œä»£ç æŠ½å–çš„åœ°æ–¹ã€‚ ä¸ºäº†æŠ½å–å’Œå°è£…ä¸Šè¿°æ­¥éª¤ï¼Œæˆ‘åˆ›å»ºäº†ä»¥ä¸‹æ³›åž‹åè®®ï¼š 123456789public protocol CollectionDataProvider &#123; associatedtype T func numberOfSections() -&gt; Int func numberOfItems(in section: Int) -&gt; Int func item(at indexPath: IndexPath) -&gt; T? func updateItem(at indexPath: IndexPath, value: T)&#125; è¿™ä¸ªåè®®å‰ä¸‰ä¸ªæ–¹æ³•æ˜¯ï¼š numberOfSections() numberOfItems(in:) item(at:) ä»–ä»¬æŒ‡æ˜Žäº†éµå¾ª UICollectionViewDataSource åè®®éœ€è¦å®žçŽ°çš„ä»£ç†æ–¹æ³•åˆ—è¡¨ã€‚åŸºäºŽæˆ‘æœ‰è¿‡ä¸€äº›å½“ç”¨æˆ·äº¤äº’åŽéœ€è¦æ›´æ–°æ•°æ®æºçš„ä½¿ç”¨åœºæ™¯ï¼Œæˆ‘åœ¨æœ€åŽåˆåŠ äº†ä¸€ä¸ª (updateItem(at:, value:)) æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å…è®¸ä½ åœ¨éœ€è¦çš„æ—¶å€™æ›´æ–°åº•å±‚æ•°æ®ã€‚åˆ°è¿™é‡Œï¼Œåœ¨ CollectionDataProvider å®šä¹‰çš„æ–¹æ³•æ»¡è¶³äº†éµå¾ª UICollectionViewDataSource åè®®æ—¶éœ€è¦å®žçŽ°çš„å¸¸ç”¨åŠŸèƒ½ã€‚ å°è£…æ ·æ¿: CollectionDataSourceé€šè¿‡ä¸Šé¢çš„æŠ½å–ï¼ŒçŽ°åœ¨å¯ä»¥å¼€å§‹å®žçŽ°ä¸€ä¸ªåŸºç±»ï¼Œè¿™ä¸ªåŸºç±»å°†è¢«å°è£…ä¸º collectionView åˆ›å»ºæ•°æ®æºæ‰€éœ€çš„å¸¸ç”¨æ ·æ¿ã€‚è¿™å°±æ˜¯æœ€ç¥žå¥‡åœ°æ–¹ï¼è¿™ä¸ªç±»çš„ä¸»è¦ä½œç”¨å°±æ˜¯åˆ©ç”¨ç‰¹å®šçš„ CollectionDataProvider å’Œ UICollectionViewCell æ¥æ»¡è¶³éµå¾ª UICollectionViewDataSource åè®®æ‰€éœ€è¦å®žçŽ°çš„æ–¹æ³•ã€‚ è¿™æ˜¯è¿™ä¸ªç±»çš„å®šä¹‰ï¼š 123456open class CollectionDataSource&lt;Provider: CollectionDataProvider, Cell: UICollectionViewCell&gt;: NSObject, UICollectionViewDataSource, UICollectionViewDelegate, where Cell: ConfigurableCell, Provider.T == Cell.T&#123; [...] &#125; å®ƒä¸ºæˆ‘ä»¬åšäº†å¾ˆå¤šäº‹ï¼š è¿™ä¸ªç±»æœ‰ä¸€ä¸ªå…¬æœ‰å±žæ€§ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿå°†å®ƒæ‰©å±•ä¸ºæŒ‡å®š CollectionDataProvider æä¾›æ­£ç¡®çš„å®žçŽ°ã€‚ è¿™æ˜¯ä¸€ä¸ªæ³›åž‹çš„ç±»ï¼Œæ‰€ä»¥å®ƒéœ€è¦ç‰¹å®šçš„ Provider (CollectionDataProvider) å’Œ Cell (UICollectionViewCell) å¯¹è±¡è¿›ä¸€æ­¥çš„å®šä¹‰æ¥ä½¿ç”¨ã€‚ è¿™ä¸ªç±»ç»§æ‰¿äºŽ NSObject åŸºç±»ï¼Œæ‰€ä»¥èƒ½å¤Ÿéµå¾ª UICollectionViewDataSource å’Œ UICollectionViewDelegate æ¥è¿›è¡ŒæŠ½å–å°è£…æ ·æ¿ä»£ç ã€‚ è¿™ä¸ªç±»åœ¨ä»¥ä¸‹åœºæ™¯ä½¿ç”¨çš„æ—¶å€™æœ‰ä¸€äº›ç‰¹å®šé™åˆ¶ï¼š UICollectionViewCell å¿…é¡»éµå¾ª ConfigurableCell åè®®ã€‚ï¼ˆ Cell: ConfigurableCell ï¼‰ ç‰¹å®šç±»åž‹ T å¿…é¡»å’Œ cell è·Ÿ Provider çš„ T ç›¸åŒ (Provider.T == Cell.T)ã€‚ ä»£ç éœ€è¦åƒä¸‹é¢ä¸€æ ·å¯¹ CollectionDataSource è¿›è¡Œåˆå§‹åŒ–å’Œè®¾ç½®ï¼š 12345678910111213141516// MARK: - Private Propertieslet provider: Providerlet collectionView: UICollectionView// MARK: - Lifecycleinit(collectionView: UICollectionView, provider: Provider) &#123; self.collectionView = collectionView self.provider = provider super.init() setUp()&#125;func setUp() &#123; collectionView.dataSource = self collectionView.delegate = self&#125; ä»£ç æ˜¯éžå¸¸ç®€å•çš„ï¼šCollectionDataSource éœ€è¦çŸ¥é“å®ƒå°†é’ˆå¯¹å“ªä¸ª collectionView å¯¹è±¡ï¼Œå°†æ ¹æ®å“ªä¸ªä½œä¸ºæ•°æ®æä¾›è€…ã€‚è¿™äº›é—®é¢˜éƒ½æ˜¯é€šè¿‡ init æ–¹æ³•çš„å‚æ•°è¿›è¡Œä¼ é€’ç¡®å®šçš„ã€‚åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼ŒCollectionDataSource å°†è‡ªå·±è®¾ç½®ä¸º UICollectionViewDataSource å’Œ UICollectionViewDelegate çš„ä»£ç†å¯¹è±¡(åœ¨ setUp æ–¹æ³•ä¸­)ã€‚ çŽ°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ UICollectionViewDataSource ä»£ç†çš„æ ·æ¿ä»£ç ã€‚ è¿™æ˜¯ä»£ç ï¼š 12345678910111213141516171819202122// MARK: - UICollectionViewDataSourcepublic func numberOfSections(in collectionView: UICollectionView) -&gt; Int &#123; return provider.numberOfSections()&#125;public func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int &#123; return provider.numberOfItems(in: section)&#125;open func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell&#123; guard let cell = collectionView.dequeueReusableCell(withReuseIdentifier: Cell.reuseIdentifier, for: indexPath) as? Cell else &#123; return UICollectionViewCell() &#125; let item = provider.item(at: indexPath) if let item = item &#123; cell.configure(item, at: indexPath) &#125; return cell&#125; ä¸Šé¢çš„ä»£ç ç‰‡æ®µé€šè¿‡ CollectionDataProvider çš„ä¸€ä¸ªå¯¹è±¡å±•ç¤ºäº† UICollectionViewDataSource ä»£ç†çš„ä¸»è¦å®žçŽ°ï¼Œå°±åƒä¹‹å‰æ‰€è¯´çš„é‚£æ ·ï¼Œå®ƒå°è£…äº†æ•°æ®æºå®žçŽ°çš„æ‰€æœ‰ç»†èŠ‚ã€‚æ¯ä¸ªä»£ç†éƒ½ä½¿ç”¨æŒ‡å®šçš„ CollectionDataProvider æ–¹æ³•æ¥æŠ½å–è·Ÿæ•°æ®æºä¹‹é—´è¿›è¡Œäº¤äº’ã€‚ æ³¨æ„ collectionView(_:cellForItemAt:) æ–¹æ³•æœ‰ä¸€ä¸ªå…¬å¼€çš„å±žæ€§ï¼Œè¿™å°±èƒ½å¤Ÿè®©å®ƒçš„ä»»ä½•å­ç±»åœ¨éœ€è¦å¯¹ cell å†…å®¹è¿›è¡Œæ›´å¤šå®šåˆ¶åŒ–çš„æ—¶å€™è¿›è¡Œæ‰©å±•ã€‚ çŽ°åœ¨å¯¹ collectionView cell å±•ç¤ºçš„åŠŸèƒ½å·²ç»åšå¥½äº†ï¼Œè®©æˆ‘ä»¬å†ä¸ºå®ƒæ·»åŠ æ›´å¤šçš„åŠŸèƒ½å§ã€‚ è€Œä½œä¸ºç¬¬ä¸€ä¸ªè¦æ·»åŠ çš„åŠŸèƒ½ï¼Œç”¨æˆ·åº”è¯¥èƒ½å¤Ÿåœ¨ç‚¹å‡» cell çš„æ—¶å€™è§¦å‘æŸäº›æ“ä½œã€‚ä¸ºäº†å®žçŽ°è¿™ä¸ªåŠŸèƒ½ï¼Œä¸€ä¸ªç®€å•çš„æ–¹æ¡ˆå°±æ˜¯å®šä¹‰ä¸€ä¸ªç®€å•çš„ closure,å¹¶å¯¹è¿™ä¸ª closure åˆå§‹åŒ–ï¼Œå½“ç”¨æˆ·ç‚¹å‡» cell çš„æ—¶å€™æ‰§è¡Œè¿™ä¸ª closure ã€‚ å¤„ç† cell ç‚¹å‡»çš„è‡ªå®šä¹‰ closure å¦‚ä¸‹æ‰€ç¤ºï¼š 1public typealias CollectionItemSelectionHandlerType = (IndexPath) -&gt; Void çŽ°åœ¨ï¼Œæˆ‘ä»¬èƒ½å®šä¹‰ä¸ªå±žæ€§æ¥å­˜å‚¨è¿™ä¸ª closure ï¼Œå½“ç”¨æˆ·ç‚¹å‡»è¿™ä¸ª cell çš„æ—¶å€™å°±ä¼šåœ¨ UICollectionViewDelegate çš„ collectionView(_:didSelectItemAt:) ä»£ç†æ–¹æ³•å®žçŽ°ä¸­æ‰§è¡Œè¿™ä¸ªåˆå§‹åŒ–å¥½çš„ closure ã€‚ 1234567// MARK: - Delegatespublic var collectionItemSelectionHandler: CollectionItemSelectionHandlerType?// MARK: - UICollectionViewDelegatepublic func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) &#123; collectionItemSelectionHandler?(indexPath)&#125; ä½œä¸ºç¬¬äºŒä¸ªè¦æ·»åŠ çš„åŠŸèƒ½ï¼Œæˆ‘æ‰“ç®—åœ¨ CollectionDataSource ä¸­å¯¹å¤šç»„ç»„å¤´å’Œç»„çš„ä¸€äº›ä»£ç æ ·æ¿è¿›è¡Œå°è£…ã€‚è¿™å°±éœ€è¦å®žçŽ° UICollectionViewDataSource çš„ä»£ç†æ–¹æ³• viewForSupplementaryElementOfKind ã€‚ä¸ºäº†èƒ½å¤Ÿè®©å­ç±»è‡ªå®šä¹‰çš„å®žçŽ° viewForSupplementaryElementOfKind ï¼Œè¿™ä¸ªä»£ç†æ–¹æ³•éœ€è¦å®šä¹‰ä¸ºå…¬å¼€æ–¹æ³•ï¼Œä»¥ä¾¿è®©ä»»ä½•å­ç±»èƒ½å¤Ÿå¯¹è¿™ä¸ªæ–¹æ³•è¿›è¡Œé‡å†™ã€‚ 123456open func collectionView(_ collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, at indexPath: IndexPath) -&gt; UICollectionReusableView&#123; return UICollectionReusableView(frame: CGRect.zero)&#125; é€šå¸¸æ¥è¯´ï¼Œè¿™ç§æ–¹å¼é€‚ç”¨äºŽæ‰€æœ‰çš„ä»£ç†æ–¹æ³•ï¼Œå½“ä»–ä»¬éœ€è¦è¢«å­ç±»é‡å†™è¦†ç›–æ—¶ï¼Œè¿™äº›æ–¹æ³•éœ€è¦å®šä¹‰ä¸ºå…¬æœ‰æ–¹æ³•ï¼Œå¹¶åœ¨ CollectionDataSource ä¸­å®žçŽ°ã€‚ å¦ä¸€ç§ä¸åŒçš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ closure ï¼Œå°±åƒåœ¨ (CollectionItemSelectionHandlerType) æ–¹æ³•ä¸­å¤„ç† cell ç‚¹å‡»äº‹ä»¶ä¸€æ ·ã€‚ æˆ‘å®žçŽ°çš„è¿™ä¸ªç‰¹å®šæ–¹é¢æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­çš„ä¸€ä¸ªå…¸åž‹çš„æƒè¡¡ï¼Œä¸€æ–¹é¢ â€”â€” ä¸º collectionView è®¾ç½®æ•°æ®æºçš„ä¸»è¦ç»†èŠ‚éƒ½è¢«éšè—ï¼ˆè¢«æŠ½å–å°è£…ï¼‰ã€‚å¦ä¸€æ–¹é¢ â€”â€” å°è£…çš„æ ·æ¿ä»£ç ä¸­æ²¡æœ‰æä¾›çš„åŠŸèƒ½ï¼Œå°±ä¼šå˜å¾—ä¸èƒ½å¼€ç®±å³ç”¨ï¼Œæ·»åŠ æ–°çš„åŠŸèƒ½å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯éœ€è¦åƒæˆ‘ä¸Šé¢ä¸¤ä¸ªä¾‹å­é‚£æ ·ï¼Œéœ€è¦å®žçŽ°æ›´å¤šçš„è‡ªå®šä¹‰ä»£ç ã€‚ å®žçŽ°ä¸€ä¸ªå…·ä½“çš„ CollectionDataProvider ä¹Ÿå°±æ˜¯ ArrayDataProviderçŽ°åœ¨æ ·æ¿ä»£ç å·²ç»è®¾ç½®å¥½äº†ï¼ŒcollectionView çš„æ•°æ®æºç”± CollectionDataSource è´Ÿè´£ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªæ™®é€šçš„ä½¿ç”¨æ¡ˆä¾‹æ¥çœ‹çœ‹æ ·æ¿ä»£ç ç”¨èµ·æ¥æœ‰å¤šæ–¹ä¾¿ã€‚ä¸ºäº†åšè¿™ä¸ªï¼ŒCollectionDataSource å¯¹è±¡éœ€è¦æä¾› CollectionDataProvider å…·ä½“çš„å®žçŽ°ã€‚ä¸€ä¸ªè¦†ç›–å¤§å¤šæ•°å¸¸è§ä½¿ç”¨æ¡ˆä¾‹çš„åŸºæœ¬å®žçŽ°ï¼Œå¯ä»¥ç®€å•åœ°ä½¿ç”¨äºŒç»´æ•°ç»„æ¥åŒ…å«å±•ç¤º collectionView cell å†…å®¹çš„æ•°æ® ã€‚ä½œä¸ºæˆ‘å¯¹æ•°æ®æºæŠ½è±¡çš„è¯•éªŒçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä½¿è¿™ä¸ªå®žçŽ°å˜å¾—æ›´åŠ é€šç”¨ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¡¨ç¤º: äºŒç»´æ•°ç»„ï¼Œæ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ ä»£è¡¨ collectionView ä¸€ç»„ cell çš„å†…å®¹ã€‚ æ•°ç»„ï¼Œè¡¨ç¤º collectionView åªæœ‰ä¸€ç»„ cell çš„å†…å®¹ï¼ˆæ²¡æœ‰ç»„å¤´ï¼‰ã€‚ ä¸Šé¢çš„ä»£ç å®žçŽ°éƒ½åŒ…å«åœ¨æ³›åž‹ç±» ArrayDataProvider ä¸­ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public class ArrayDataProvider&lt;T&gt;: CollectionDataProvider &#123; // MARK: - Internal Properties var items: [[T]] = [] // MARK: - Lifecycle init(array: [[T]]) &#123; items = array &#125; // MARK: - CollectionDataProvider public func numberOfSections() -&gt; Int &#123; return items.count &#125; public func numberOfItems(in section: Int) -&gt; Int &#123; guard section &gt;= 0 &amp;&amp; section &lt; items.count else &#123; return 0 &#125; return items[section].count &#125; public func item(at indexPath: IndexPath) -&gt; T? &#123; guard indexPath.section &gt;= 0 &amp;&amp; indexPath.section &lt; items.count &amp;&amp; indexPath.row &gt;= 0 &amp;&amp; indexPath.row &lt; items[indexPath.section].count else &#123; return items[indexPath.section][indexPath.row] &#125; return nil &#125; public func updateItem(at indexPath: IndexPath, value: T) &#123; guard indexPath.section &gt;= 0 &amp;&amp; indexPath.section &lt; items.count &amp;&amp; indexPath.row &gt;= 0 &amp;&amp; indexPath.row &lt; items[indexPath.section].count else &#123; return &#125; items[indexPath.section][indexPath.row] = value &#125;&#125; è¿™æ ·åšå¯ä»¥æå–è®¿é—®æ•°æ®æºçš„ç»†èŠ‚ï¼Œçº¿æ€§æ•°æ®ç»“æž„å¯ä»¥è¡¨ç¤º cell çš„å†…å®¹æ˜¯æœ€å¸¸è§çš„ä½¿ç”¨æƒ…å†µã€‚ å°è£…åˆ°ä¸€å—: CollectionArrayDataSourceè¿™æ · CollectionDataProvider åè®®å°±å…·ä½“å®žçŽ°äº†ï¼Œåˆ›å»ºä¸€ä¸ª CollectionDataSource å­ç±»æ¥å®žçŽ°æœ€å¸¸è§çš„ç®€å•çš„åˆ—è¡¨æ•°æ®å±•ç¤ºæ˜¯éžå¸¸å®¹æ˜“çš„ã€‚ è®©æˆ‘ä»¬ä»Žè¿™ä¸ªç±»çš„å®šä¹‰å¼€å§‹ï¼š 123open class CollectionArrayDataSource&lt;T, Cell: UICollectionViewCell&gt;: CollectionDataSource&lt;ArrayDataProvider&lt;T&gt;, Cell&gt; where Cell: ConfigurableCell, Cell.T == T &#123; [...] &#125; è¿™ä¸ªå£°æ˜Žå®šä¹‰äº†å¾ˆå¤šäº‹æƒ…ï¼š è¿™ä¸ªç±»æœ‰ä¸€ä¸ªå…¬æœ‰çš„å±žæ€§ï¼Œå› ä¸ºå®ƒæœ€ç»ˆå°†è¢«æ‰©å±•ä¸º UICollectionView å¯¹è±¡çš„æ•°æ®æºå¯¹è±¡ã€‚ è¿™æ˜¯ä¸€ä¸ªç»§æ‰¿ UICollectionViewCell çš„æ³›åž‹ç±»ï¼Œéœ€è¦è¢«ç‰¹å®šçš„ç±»åž‹ T è¿›ä¸€æ­¥å®šä¹‰æ‰èƒ½æ­£ç¡®å±•ç¤º cell å’Œ cell çš„å†…å®¹ã€‚ è¿™ä¸ªç±»æ‰©å±•äº† CollectionDataSource æ¥æä¾›è¿›ä¸€æ­¥çš„ç‰¹å®šè¡Œä¸ºã€‚ ç‰¹å®šç±»åž‹ T å°†è¢«è¡¨ç¤ºï¼Œå®ƒå°†é€šè¿‡ä¸€ä¸ª ArrayDataProvider &lt; T &gt; å¯¹è±¡æ¥è®¿é—® cell å†…å®¹ã€‚ è¿™ä¸ªç±»åœ¨ closure ä¸­çš„å®šä¹‰è¡¨æ˜Žæœ‰äº›ç‰¹å®šçš„çº¦æŸ: UICollectionViewCell å¿…é¡»éµå¾ª ConfigurableCell åè®®ã€‚ï¼ˆ Cell: ConfigurableCell ï¼‰ cell ä¸­çš„ç‰¹å®šç±»åž‹ T å¿…é¡»è·Ÿ Provider çš„ T ç›¸åŒ (Provider.T == Cell.T) ã€‚ ç±»çš„å®žçŽ°éžå¸¸ç®€å•ï¼š 123456789101112131415161718// MARK: - Lifecyclepublic convenience init(collectionView: UICollectionView, array: [T]) &#123; self.init(collectionView: collectionView, array: [array])&#125;public init(collectionView: UICollectionView, array: [[T]]) &#123; let provider = ArrayDataProvider(array: array) super.init(collectionView: collectionView, provider: provider)&#125;// MARK: - Public Methodspublic func item(at indexPath: IndexPath) -&gt; T? &#123; return provider.item(at: indexPath)&#125;public func updateItem(at indexPath: IndexPath, value: T) &#123; provider.updateItem(at: indexPath, value: value)&#125; å®ƒåªæ˜¯æä¾›äº†ä¸€äº›åˆå§‹åŒ–æ–¹æ³•å’Œä¸Žäº¤äº’æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä½¿æˆ‘ä»¬èƒ½å¤Ÿè®©æ•°æ®æä¾›è€…ä¸Žæ•°æ®æºé€æ˜Žåœ°è¿›è¡Œè¯»å–å’Œå†™å…¥æ“ä½œã€‚ åˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„ CollectionViewå¯ä»¥å°† CollectionArrayDataSource åŸºç±»æ‰©å±•ï¼Œä¸ºä»»ä½•å¯ä»¥ç”¨äºŒç»´æ•°ç»„å±•ç¤ºçš„ collection view åˆ›å»ºä¸€ä¸ªç‰¹å®šçš„æ•°æ®æºã€‚ 1class PhotosDataSource: CollectionArrayDataSource&lt;PhotoViewModel, PhotoCell&gt; &#123;&#125; å£°æ˜Žæ¯”è¾ƒç®€å•: ç»§æ‰¿äºŽ CollectionArrayDataSource ã€‚ è¿™ä¸ªç±»è¡¨ç¤º PhotoViewModel ä½œä¸ºç‰¹å®šç±»åž‹ T å°†ä¼šå±•ç¤º cell å†…å®¹ï¼Œå¯é€šè¿‡ ArrayDataProvider &lt; PhotoViewModel > å¯¹è±¡è®¿é—®ï¼ŒPhotoCell å°†ä½œä¸º UICollectionViewCell å±•ç¤ºã€‚ è¯·æ³¨æ„ï¼ŒPhotoCell å¿…é¡»éµå®ˆ ConfigurableCell åè®®ï¼Œå¹¶ä¸”èƒ½å¤Ÿé€šè¿‡ PhotoViewModel å®žä¾‹åˆå§‹åŒ–å®ƒçš„å±žæ€§ã€‚ åˆ›å»ºä¸€ä¸ª PhotosDataSource å¯¹è±¡æ˜¯éžå¸¸ç®€å•çš„ã€‚åªéœ€è¦ä¼ é€’è¿‡åŽ»å°†è¦å±•ç¤ºçš„ collectionView å’Œç”±å±•ç¤ºæ¯ä¸ª cell å†…å®¹çš„ PhotoViewModel å…ƒç´ ç»„æˆçš„æ•°ç»„ï¼š 1let dataSource = PhotosDataSource(collectionView: collectionView, array: viewModels) collectionView å‚æ•°é€šå¸¸æ˜¯ storyboard ä¸Šçš„ collectionView é€šè¿‡ outlet æŒ‡å‘èŽ·å–åˆ°çš„ã€‚ æ‰€æœ‰çš„å°±å®Œæˆäº†ï¼ä¸¤è¡Œä»£ç å°±å¯ä»¥è®¾ç½®ä¸€ä¸ªåŸºæœ¬çš„ collectionView æ•°æ®æºã€‚ è®¾ç½®å¸¦æœ‰ç»„æ ‡é¢˜å’Œç»„çš„ CollectionViewå¯¹äºŽæ›´é«˜çº§å’Œå¤æ‚çš„ç”¨ä¾‹ï¼Œä½ å¯ä»¥ç®€å•åœ¨ GitHub repo ä¸ŠæŸ¥çœ‹ TaskList ã€‚å†…å®¹å·²ç»å¾ˆé•¿äº†ï¼Œæœ¬æ–‡å°±ä¸å†ä¸ä»‹ç»ç¤ºä¾‹çš„æ›´å¤šç»†èŠ‚ã€‚æˆ‘å°†åœ¨ä¸‹ä¸€ç¯‡ â€œCollection View with Headers and Sectionsâ€ æ–‡ç« é‡Œè¿›è¡Œæ·±å…¥åœ°æŽ¢è®¨ã€‚åœ¨è¿™ä¸ªè¯´æ˜Žä¸­ï¼Œå¦‚æžœå­˜åœ¨ä¸€ä¸ªè¯é¢˜å¯¹ä½ æ¥è¯´å¾ˆæœ‰æ„æ€ï¼Œè¯·ä¸è¦çŠ¹è±«è®©æˆ‘çŸ¥é“ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ä¼˜å…ˆè€ƒè™‘ä¸‹ä¸€æ­¥å†™ä»€ä¹ˆã€‚ä¸ºäº†å’Œæˆ‘è”ç³»ï¼Œè¯·åœ¨è¿™ç¯‡æ–‡ç« ä¸‹æ–¹ç•™è¨€æˆ–å‘é‚®ä»¶ç»™æˆ‘: andrea.prearo@gmail.com ã€‚ ç»“è®ºåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»‹ç»äº†ä¸€äº›æˆ‘åšçš„æŠ½å–å°è£…ï¼Œä»¥ç®€åŒ–ä½¿ç”¨æ³›åž‹æ•°æ®æºçš„ collectionView ã€‚æ‰€æå‡ºçš„å®žçŽ°éƒ½æ˜¯åŸºäºŽæˆ‘åœ¨æž„å»º iOS app æ—¶é‡åˆ°çš„é‡å¤ä»£ç çš„åœºæ™¯ã€‚ä¸€äº›æ›´é«˜çº§çš„çš„åŠŸèƒ½å¯èƒ½éœ€è¦è¿›ä¸€æ­¥çš„è‡ªå®šä¹‰ã€‚æˆ‘ç›¸ä¿¡ï¼Œç»§ç»­ä¼˜åŒ–æ‰€å¾—åˆ°çš„ä»£ç æŠ½å–ï¼Œæˆ–è€…æž„å»ºæ–°çš„ä»£ç æŠ½å–ï¼Œæ¥ç®€åŒ–å¤„ç†ä¸åŒçš„ collectionView æ¨¡å¼éƒ½æ˜¯å¯èƒ½çš„ã€‚ä½†è¿™å·²ç»è¶…å‡ºäº†è¿™ç¯‡æ–‡ç« çš„èŒƒå›´ã€‚ æ‰€æœ‰çš„é€šç”¨æ•°æ®æºä»£ç å’Œç¤ºä¾‹å·¥ç¨‹éƒ½åœ¨ GitHub å¹¶ä¸”æ˜¯éµå®ˆ MIT åè®®çš„ã€‚ä½ å¯ä»¥ç›´æŽ¥ä½¿ç”¨å’Œä¿®æ”¹å®ƒä»¬ã€‚æ¬¢è¿Žæ‰€æœ‰çš„åé¦ˆæ„è§å’Œå»ºè®®çš„è´¡çŒ®ï¼Œå¹¶éžå¸¸æ„Ÿè°¢ä½ è¿™ä¹ˆåšã€‚å¦‚æžœä½ æœ‰è¶³å¤Ÿçš„å…´è¶£ï¼Œæˆ‘å°†å¾ˆä¹æ„æ·»åŠ æ‰€éœ€çš„é…ç½®ï¼Œä½¿ä»£ç ä¸ŽCocoapodså’ŒCarthageä¸€èµ·ä½¿ç”¨ï¼Œå¹¶å…è®¸ä½¿ç”¨è¿™ç§ä¾èµ–å…³ç³»ç®¡ç†å·¥å…·å¯¼å…¥é€šç”¨æ•°æ®æºã€‚æˆ–è€…ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹åŽ»ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®ã€‚ é¢å¤–é“¾æŽ¥ Smooth Scrolling in UITableView and UICollectionView Boost Smooth Scrolling with iOS 10 Pre-Fetching API æŠ«éœ²å£°æ˜Žï¼šè¿™äº›æ„è§æ˜¯ä½œè€…çš„æ„è§ã€‚ é™¤éžåœ¨æ–‡ç« ä¸­é¢å¤–å£°æ˜Žï¼Œå¦åˆ™ Capital One ç‰ˆæƒä¸å±žäºŽä»»ä½•æ‰€æåŠçš„å…¬å¸ï¼Œä¹Ÿä¸å±žäºŽä»»ä½•ä¸Šè¿°å…¬å¸ã€‚ ä½¿ç”¨æˆ–æ˜¾ç¤ºçš„æ‰€æœ‰å•†æ ‡å’Œå…¶ä»–çŸ¥è¯†äº§æƒå‡ä¸ºå…¶å„è‡ªæ‰€æœ‰è€…çš„æ‰€æœ‰æƒã€‚ æœ¬æ–‡ç‰ˆæƒä¸º Â©2017 Capital One æ›´å¤šå…³äºŽ APIã€å¼€æºã€ç¤¾åŒºæ´»åŠ¨æˆ–å¼€å‘æ–‡åŒ–çš„ä¿¡æ¯ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„ä¸€ç«™å¼å¼€å‘ç½‘ç«™ developer.capitalone.com ã€‚ è¯‘æ–‡å‡ºè‡ªï¼šæŽ˜é‡‘ç¿»è¯‘è®¡åˆ’ è¯‘è€…ï¼š Swants æ ¡å¯¹è€…ï¼š iOSleep]]></content>
  </entry>
  <entry>
    <title><![CDATA[å¼€å‘è€…çœ¼ä¸­ iOS 11 éƒ½æ›´æ–°äº†ä»€ä¹ˆï¼Ÿ]]></title>
    <url>%2F2017%2F07%2F07%2F%E5%BC%80%E5%8F%91%E8%80%85%E7%9C%BC%E4%B8%AD-iOS-11-%E9%83%BD%E6%9B%B4%E6%96%B0%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F.html</url>
    <content type="text"><![CDATA[è‹¹æžœåœ¨ 2017 å¹´å…¨çƒå¼€å‘è€…å¤§ä¼šä¸Šå…¬å¸ƒäº† iOS 11 , å…¶åŠ å…¥è®¸å¤šå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¦‚ Core ML,ARKit,Vision,PDFKit,MusicKit æ‹–æ”¾ç­‰ç­‰ã€‚ æˆ‘å°è¯•ç€æŠŠä¸»è¦å˜åŒ–åœ¨æŽ¥ä¸‹æ¥çš„æ–‡ç« é‡Œæ€»ç»“äº†å‡ºæ¥ï¼Œå¹¶åœ¨å¯è¡Œçš„åœ°æ–¹æä¾›ä»£ç ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ç›´æŽ¥ä¸Šæ‰‹ã€‚ æ³¨æ„ï¼š æœ‰äº›åœ°æ–¹æ²¡æ¶‰åŠåˆ°å¹¶ä¸æ˜¯å› ä¸ºæ‡’ï¼Œæˆ‘å·²ç»å°½æˆ‘æ‰€èƒ½æä¾›è¶³å¤Ÿå¤šçš„ä»£ç æ¥å¸®ä½ åœ¨åº”ç”¨ä¸Šå¿«é€Ÿä¸Šæ‰‹è¿™äº›ç‰¹æ€§ã€‚ä½†æ˜¯ä½ æœ€ç»ˆè¿˜æ˜¯å…ä¸äº†åŽ»é¢å¤–äº†è§£æ›´å¤š iOS 11 ä¸­å¤§é‡å¤æ‚çš„è®¾è®¡åŠŸèƒ½ã€‚ åœ¨æŽ¥ç€è¯»ä¸‹åŽ»ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦äº†è§£ä¸‹è¿™å‡ ç¯‡æ–‡ç« ï¼š Whatâ€™s new in Swift 4? Whatâ€™s new in Swift 3.1? Whatâ€™s new in iOS 10? Whatâ€™s new in iOS 9? ä½ å¯èƒ½æƒ³è´­ä¹°æˆ‘çš„æ–°ä¹¦ï¼šã€Š Practical iOS 11 ã€‹ã€‚ ä½ å¯ä»¥é€šè¿‡æ•™ç¨‹çš„å½¢å¼èŽ·å¾— 7 ä¸ªå®Œæ•´çš„é¡¹ç›®ä»£ç ï¼Œä»¥åŠæ›´å¤šæ·±å…¥äº†è§£ç‰¹å®šæ–°æŠ€æœ¯çš„æŠ€æœ¯é¡¹ç›® - è¿™æ˜¯ç†Ÿæ‚‰ iOS 11æœ€å¿«çš„æ–¹å¼ï¼ Buy Practical iOS 11 for $30 æ‹–æ”¾æ‹–æ”¾æ˜¯æˆ‘ä»¬åœ¨æ¡Œé¢æ“ä½œç³»ç»Ÿä¸­è®¤ä¸ºç†æ‰€å½“ç„¶çš„æ“ä½œï¼Œä½†æ˜¯æ‹–æ”¾åœ¨ iOS ä¸Šç›´åˆ° iOS 11 æ‰å‡ºçŽ°ï¼Œè¿™çœŸçš„é˜»ç¢äº†å¤šä»»åŠ¡å¤„ç†çš„å‘å±•ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨ iOS 11 ä¸Šå°¤å…¶æ˜¯åœ¨ iPad ä¸Šï¼Œå¤šä»»åŠ¡å¤„ç†è¿Žæ¥äº†é«˜é€Ÿå‘å±•çš„æ—¶ä»£ã€‚å¾—ç›ŠäºŽæ‹–æ”¾æˆä¸ºå…¶ä¸­å¾ˆå¤§çš„ä¸€éƒ¨åˆ†ï¼šä½ å¯ä»¥åœ¨ APP å†…éƒ¨å’Œæˆ– APP ä¹‹é—´ç§»åŠ¨å†…å®¹ï¼Œå½“ä½ æ‹–æ”¾çš„æ—¶å€™ä½ å¯ä»¥ç”¨å¦ä¸€åªæ‰‹å¯¹å…¶ä»– app è¿›è¡Œæ“ä½œ.ä½ ç”šè‡³å¯ä»¥åˆ©ç”¨ å…¨æ–°çš„ dock ç³»ç»Ÿæ¥æ¿€æ´»å…¶ä»– app çš„ä¸­é—´æ‹–åŠ¨ã€‚ æ³¨æ„ï¼š åœ¨ iPhone ä¸Šæ‹–æ”¾è¢«é™åˆ¶åœ¨å•ä¸ª app å†… â€”â€” ä½ ä¸èƒ½æŠŠå†…å®¹æ‹–æ”¾åˆ°å…¶ä»– app é‡Œã€‚ ä»¤äººæ¬£å–œçš„æ˜¯ï¼ŒUITableView å’Œ UICollectionView åœ¨ä¸€å®šç¨‹åº¦ä¸Šéƒ½æ”¯æŒæ‹–æ‹½å†…ç½®ã€‚ä½†æ˜¯æƒ³è¦ä½¿ç”¨æ‹–æ”¾åŠŸèƒ½ä»æ—§éœ€è¦å†™ç›¸å½“å¤šçš„ä»£ç ã€‚ä½ ä¹Ÿå¯ä»¥å‘å…¶ä»–ç»„ä»¶æ·»åŠ æ‹–æ”¾æ”¯æŒï¼Œè€Œä¸”ä½ ä¼šå‘çŽ°å®žé™…ä¸Šè¿™åªéœ€è¦å°‘é‡çš„å·¥ä½œã€‚ ä¸‹é¢è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ç®€å•çš„æ‹–æ”¾æ¥å®žçŽ°åœ¨ä¸¤ä¸ªåˆ—è¡¨ä¹‹é—´æ‹·è´è¡Œå†…å®¹ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ app ã€‚è®©æˆ‘ä»¬å†™ä¸€äº›ä»£ç æ¥åˆ›å»ºä¸¤ä¸ªæœ‰ç¤ºä¾‹æ•°æ®çš„ tableview ä¾›æˆ‘ä»¬æ‹·è´ã€‚ åœ¨ Xcode å†…åˆ›å»ºä¸€ä¸ªæ–°çš„å•ä¸€è§†å›¾ app æ¨¡æ¿ï¼Œç„¶åŽæ‰“å¼€ ViewController.swift ç±»è¿›è¡Œç¼–è¾‘ã€‚ çŽ°åœ¨æˆ‘ä»¬éœ€è¦åœ¨è¿™é‡Œæ”¾ä¸Šä¸¤ä¸ªå«æœ‰ç¤ºä¾‹æ•°æ®çš„ tableView ã€‚æˆ‘ä¸æ‰“ç®—ä½¿ç”¨ IB çš„æ–¹å¼å¸ƒå±€ï¼Œ å› ä¸ºå…¨éƒ¨ä½¿ç”¨ä»£ç æ¥å®žçŽ°æ˜¯æ›´æ¸…æ¥šçš„ã€‚é¡ºä¾¿æä¸€ä¸‹ï¼Œæˆ‘ ä¸æ‰“ç®— è¯¦ç»†åœ°è§£é‡Šä»£ç ï¼Œå› ä¸ºè¿™éƒ½æ˜¯çŽ°æˆçš„ iOS ä»£ç ï¼Œæˆ‘ä¸æƒ³æµªè´¹ä½ çš„æ—¶é—´ã€‚ è¿™äº›ä»£ç å°†ï¼š åˆ›å»ºä¸¤ä¸ª tableView ,å¹¶ä¸”åˆ›å»ºä¸¤ä¸ªåˆ†åˆ«åŒ…å«Left å’Œ Right å…ƒç´ çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚ åˆ¶å®šä¸¤ä¸ª tableView éƒ½ä½¿ç”¨ view controller æ¥ä½œä¸ºå®ƒä»¬çš„æ•°æ®æºï¼Œç»™ä»–ä»¬å†™æ­»ä½ç½®å®½é«˜ï¼Œæ³¨å†Œä¸€ä¸ªå¯é‡ç”¨çš„ cell ï¼ŒæŠŠå®ƒä»¬ä¸¤ä¸ªéƒ½æ·»åŠ åˆ°è¿™ä¸ª view ä¸Šã€‚ å®žçŽ° numberOfRowsInSection æ–¹æ³•ï¼Œç¡®ä¿æ¯ä¸ª table view éƒ½æ ¹æ®å…¶å­—ç¬¦ä¸²æ•°ç»„æœ‰æ­£ç¡®çš„è¡Œæ•°ã€‚ å®žçŽ° cellForRowAt æ¥æŽ’åˆ—ï¼Œè¿™æ—¶ cellæ ¹æ® table æ¥ä»Žä¸¤ä¸ªå­—ç¬¦ä¸²æ•°ç»„ä¸­é€‰å‡ºå¯¹åº”çš„æ•°æ®æºæ­£ç¡®å±•ç¤ºã€‚ ç„¶åŽï¼Œè¿™æ˜¯ iOS 11 ä¹‹å‰çš„æ‰€æœ‰ä»£ç ï¼Œåº”è¯¥æ²¡æœ‰ä½ ä¸ç†Ÿæ‚‰çš„ä»£ç ã€‚å°† ViewController.swift ç±»çš„å†…å®¹ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445import UIKitclass ViewController: UIViewController, UITableViewDataSource, UITableViewDelegate &#123; var leftTableView = UITableView() var rightTableView = UITableView() var leftItems = [String](repeating: "Left", count: 20) var rightItems = [String](repeating: "Right", count: 20) override func viewDidLoad() &#123; super.viewDidLoad() leftTableView.dataSource = self rightTableView.dataSource = self leftTableView.frame = CGRect(x: 0, y: 40, width: 150, height: 400) rightTableView.frame = CGRect(x: 150, y: 40, width: 150, height: 400) leftTableView.register(UITableViewCell.self, forCellReuseIdentifier: "Cell") rightTableView.register(UITableViewCell.self, forCellReuseIdentifier: "Cell") view.addSubview(leftTableView) view.addSubview(rightTableView) &#125; func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -&gt; Int &#123; if tableView == leftTableView &#123; return leftItems.count &#125; else &#123; return rightItems.count &#125; &#125; func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -&gt; UITableViewCell &#123; let cell = tableView.dequeueReusableCell(withIdentifier: "Cell", for: indexPath) if tableView == leftTableView &#123; cell.textLabel?.text = leftItems[indexPath.row] &#125; else &#123; cell.textLabel?.text = rightItems[indexPath.row] &#125; return cell &#125;&#125; å¥½ï¼šä¸‹é¢å°±æ˜¯ æ–° çš„å†…å®¹äº†ã€‚å¦‚æžœä½ çŽ°åœ¨è¿è¡Œ app ä½ å°±ä¼šçœ‹åˆ°ä¸¤ä¸ªå¹¶åˆ—å¹¶ä¸”å¡«æ»¡æ•°æ®çš„ tableView ã€‚æˆ‘ä»¬çŽ°åœ¨æƒ³è¦åšçš„å°±æ˜¯è®©ç”¨æˆ·å¯ä»¥ä»Žä¸€ä¸ª table ä¸Šé€‰æ‹©ä¸€è¡Œå¹¶ä¸”å¤åˆ¶åˆ°å¦ä¸€ä¸ª table é‡Œï¼Œæˆ–è€…åæ–¹å‘æ“ä½œã€‚ ç¬¬ä¸€æ­¥å°±æ˜¯å°±æ˜¯è®¾ç½®ä¸¤ä¸ª tableView çš„æ‹–å’Œæ”¾æ“ä½œçš„ä»£ç†ä¸ºå½“å‰ view controller ï¼Œå†æŠŠå®ƒä»¬è®¾ç½®ä¸ºå¯æ‹–æ”¾ã€‚ æœ€åŽæŠŠä¸‹é¢çš„ä»£ç åŠ å…¥åˆ° viewDidLoad() æ–¹æ³•é‡Œï¼š 1234567leftTableView.dragDelegate = selfleftTableView.dropDelegate = selfrightTableView.dragDelegate = selfrightTableView.dropDelegate = selfleftTableView.dragInteractionEnabled = truerightTableView.dragInteractionEnabled = true å½“ä½ åšå®Œè¿™äº›åŽï¼ŒXcode ä¼šæŠ›å‡ºå‡ ä¸ªè­¦å‘Šï¼Œå› ä¸ºæˆ‘ä»¬å½“å‰çš„æŽ§åˆ¶å™¨ç±»æ²¡æœ‰éµä»Ž UITableViewDragDelegate å’Œ UITableViewDropDelegate åè®®ã€‚é€šè¿‡ç»™æˆ‘ä»¬çš„ç±»æ·»åŠ è¿™ä¸¤ä¸ªåè®®å¾ˆå®¹æ˜“å°±ä¿®å¤è¿™äº›è­¦å‘Šäº† â€”â€” æ»šåŠ¨åˆ°æ–‡ä»¶çš„æœ€é¡¶ç«¯å¹¶ä¸”æ”¹å˜ç±»çš„å®šä¹‰ï¼š 1class ViewController: UIViewController, UITableViewDataSource, UITableViewDelegate, UITableViewDragDelegate, UITableViewDropDelegate &#123; ä½†æ˜¯è¿™æ ·åˆä¼šäº§ç”Ÿæ–°çš„é—®é¢˜ï¼šæˆ‘è¯´è¿‡æˆ‘ä»¬åº”è¯¥éµä»Žè¿™ä¸¤ä¸ªæ–°åè®®ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å®žçŽ°åè®®å¿…é¡»å®žçŽ°çš„æ–¹æ³•ï¼Œåœ¨è¿‡åŽ»ä¿®å¤è¿™ä¸ªå¸¸å¸¸æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œä½†æ˜¯ Xcode 9 å¯ä»¥è‡ªåŠ¨å®Œæˆè¿™å‡ ä¸ªåè®®å¿…é¡»å®žçŽ°çš„æ–¹æ³• â€”â€” ç‚¹å‡»æŠ¥çº¢è‰²é«˜äº®ä»£ç è¡Œä¸Šçš„æ•°å­— 2ï¼Œè¿™æ—¶ä½ å°†ä¼šçœ‹åˆ°å‡ºçŽ°äº†æ›´å¤šçš„è¯¦ç»†è§£é‡Šã€‚ç‚¹å‡» â€œfixâ€ æ¥è®© Xcode 9 ä¸ºæˆ‘ä»¬æ’å…¥ä¸¤ä¸ªç¼ºå°‘çš„æ–¹æ³• â€”â€” ä½ å°†ä¼šçœ‹åˆ°ä½ çš„ç±»é‡Œè¾¹å‡ºçŽ°äº†ä¸‹é¢çš„ä»£ç ï¼š 1234567func tableView(_ tableView: UITableView, itemsForBeginning session: UIDragSession, at indexPath: IndexPath) -&gt; [UIDragItem] &#123; code&#125;func tableView(_ tableView: UITableView, performDropWith coordinator: UITableViewDropCoordinator) &#123; code&#125; Xcode æ€»æ˜¯æŠŠæ–°çš„æ–¹æ³•æ’åœ¨ä½ çš„ç±»æœ€ä¸Šé¢ï¼Œè‡³å°‘åœ¨è¿™æ¬¡åˆå§‹çš„ beta ç‰ˆæœ¬é‡Œæ˜¯ã€‚å¦‚æžœä½ å’Œæˆ‘ä¸€æ ·çœ‹è¿™ä¸é¡ºçœ¼ â€”â€” åœ¨ç»§ç»­ä¹‹å‰å¯ä»¥æŠŠå®ƒä»¬ç§»åˆ°æ›´æ˜Žæ™ºåœ°æ–¹ï¼ itemsForBeginning æ–¹æ³•æ˜¯æœ€ç®€å•çš„ï¼Œè®©æˆ‘ä»¬å…ˆä»Žå®ƒå¼€å§‹ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨å½“ç”¨æˆ·çš„æ‰‹æŒ‡åœ¨ tableView æŸè¡Œ cell ä¸ŠæŒ‰ä¸‹æ‰§è¡Œæ‹–çš„æ“ä½œçš„æ—¶å€™è°ƒç”¨ã€‚å¦‚æžœä½ è¿”å›žä¸€ä¸ªç©ºæ•°ç»„ï¼Œä½ å®žé™…ä¸Šå°±æ˜¯æ‹’ç»äº†æ‹–æ”¾æ“ä½œã€‚ æˆ‘ä»¬æ‰“ç®—ä¸ºè¿™ä¸ªæ–¹æ³•æ·»åŠ å››è¡Œä»£ç ï¼š æŒ‡å‡ºå“ªä¸€ä¸ªå­—ç¬¦ä¸²è¢«æ‹·è´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„ä¸‰å…ƒæ“ä½œç¬¦æ¥å®žçŽ°ï¼šå¦‚æžœå½“å‰çš„ tableView æ˜¯åœ¨å·¦è¾¹å°±ä»Ž leftItems ä¸­è¯»å–ï¼Œå¦åˆ™å°±ä»Ž rightItems ä¸­è¯»å–ã€‚ è¯•ç€å°†è¿™ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆä¸€ä¸ª Data å¯¹è±¡ï¼Œ ä»¥ä¾¿å¯ä»¥é€šè¿‡æ‹–æ”¾è¿›è¡Œä¼ é€’ã€‚ å°†è¿™ä¸ª data æ”¾è¿›ä¸€ä¸ª NSItemProvider ä¸­ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºå­˜å‚¨äº†ä¸€ä¸ªçº¯æ–‡æœ¬å­—ç¬¦ä¸²ä»Žè€Œå…¶ä»– app å¯ä»¥çŸ¥é“å¦‚ä½•åŽ»å¤„ç†å®ƒã€‚ æœ€åŽï¼Œ æŠŠè¿™ä¸ª NSItemProvider æ”¾è¿›ä¸€ä¸ª UIDragItemå†…ï¼Œä»Žè€Œå®ƒå¯ä»¥ç”¨äºŽ UIKit çš„æ‹–æ”¾ã€‚ ä¸ºäº†æŠŠ data å…ƒç´ æ ‡è®°ä¸ºçº¯æ–‡æœ¬å­—ç¬¦ä¸² æˆ‘ä»¬éœ€è¦å¼•å…¥ MobileCoreServices æ¡†æž¶ï¼Œæ‰€ä»¥è¯·æŠŠä¸‹é¢çš„ä»£ç åŠ å…¥åˆ° ViewController.swift æ–‡ä»¶æœ€ä¸Šé¢ï¼š 1import MobileCoreServices çŽ°åœ¨ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢ä½ çš„ itemsForBeginning æ–¹æ³•ï¼š 1234567func tableView(_ tableView: UITableView, itemsForBeginning session: UIDragSession, at indexPath: IndexPath) -&gt; [UIDragItem] &#123; let string = tableView == leftTableView ? leftItems[indexPath.row] : rightItems[indexPath.row] guard let data = string.data(using: .utf8) else &#123; return [] &#125; let itemProvider = NSItemProvider(item: data as NSData, typeIdentifier: kUTTypePlainText as String) return [UIDragItem(itemProvider: itemProvider)]&#125; æŽ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦å®žçŽ° performDropWith æ–¹æ³•ã€‚æˆ‘è¯´ â€œåªéœ€è¦â€ï¼Œä½†æ˜¯å‰©ä¸‹çš„ä¸¤ä¸ªæ½œåœ¨çš„å¤æ‚é—®é¢˜è¿˜æ˜¯å¾ˆæ£˜æ‰‹çš„ã€‚é¦–å…ˆï¼Œå¦‚æžœæœ‰äººæ‹–æ”¾äº†å¾ˆå¤šä¸œè¥¿æˆ‘ä»¬å°±ä¼šåŒæ—¶èŽ·å¾—å¾ˆå¤šå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå®ƒä»¬éƒ½æ­£ç¡®æ’å…¥ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å¯èƒ½è¢«å‘ŠçŸ¥ç”¨æˆ·æƒ³è¦æ’å…¥åˆ°å“ªå‡ è¡Œï¼Œä¹Ÿå¯èƒ½ä¸è¢«å‘ŠçŸ¥ â€”â€” ç”¨æˆ·å¯èƒ½åªæ˜¯æŠŠå­—ç¬¦ä¸²æ‹–æ”¾åˆ° tableView çš„ç©ºç™½å¤„ï¼Œè¿™æ—¶éœ€è¦æˆ‘ä»¬å†³å®šè¯¥æ€Žä¹ˆå¤„ç†ã€‚ è¦è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜éœ€è¦å†™æ¯”ä½ æœŸæœ›ä¸­çš„æ›´å¤šçš„ä»£ç ï¼Œä½†æˆ‘ä¼šå¸¦ä½ ä¸€æ­¥ä¸€æ­¥ç¼–å†™ä»£ç ï¼Œè®©å®ƒæ›´å®¹æ˜“äº›ã€‚ é¦–å…ˆï¼Œæ˜¯æœ€ç®€å•çš„éƒ¨åˆ†ï¼šæ‰¾å‡ºè¡Œè¢«æ‹–æ”¾åˆ°å“ªé‡Œã€‚ performDropWith è¿”å›žä¸€ä¸ª UITableViewDropCoordinator ç±»å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æœ‰ä¸€ä¸ª destinationIndexPath å±žæ€§ å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ç”¨æˆ·æƒ³æŠŠæ•°æ®æ‹–æ”¾åˆ°å“ªé‡Œã€‚ç„¶è€Œ è¿™ä¸ªæ–¹æ³•æ˜¯ å¯é€‰ å®žçŽ°ï¼šå¦‚æžœç”¨æˆ·æŠŠä»–ä»¬çš„æ•°æ®æ‹–æ”¾åˆ°æˆ‘ä»¬ tableView çš„ç©ºå•å…ƒæ ¼ä¸Šï¼Œæ–¹æ³•è¿”å›žçš„å°†ä¼šæ˜¯ nil ã€‚å¦‚æžœè¿™çœŸçš„å‘ç”Ÿäº†æˆ‘ä»¬ä¼šè®¤ä¸ºç”¨æˆ·æ˜¯æƒ³æŠŠæ•°æ®æ‹–æ”¾åˆ° table çš„æœ€å°¾éƒ¨ã€‚ æ‰€ä»¥ï¼ŒæŠŠä¸‹é¢çš„ä»£ç æ·»åŠ åˆ° performDropWith æ–¹æ³•å†…ç»§ç»­å§ï¼š 123456789let destinationIndexPath: IndexPathif let indexPath = coordinator.destinationIndexPath &#123; destinationIndexPath = indexPath&#125; else &#123; let section = tableView.numberOfSections - 1 let row = tableView.numberOfRows(inSection: section) destinationIndexPath = IndexPath(row: row, section: section)&#125; æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„é‚£æ ·ï¼Œå¦‚æžœ coordinator çš„ destinationIndexPath å­˜åœ¨å°±ç›´æŽ¥ç”¨ï¼Œå¦‚æžœä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªæœ€åŽä¸€ç»„æœ€åŽä¸€è¡Œçš„ destinationIndexPath ã€‚ ä¸‹ä¸€æ­¥å°±æ˜¯è®©æ‹–æ”¾çš„ coordinator æ¥åŠ è½½æ‹–åŠ¨çš„æ‰€æœ‰ç‰¹å®šç±»å¯¹è±¡ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­é‡Œè¿™ä¸ªç‰¹å®šç±»æ˜¯ NSString ã€‚ï¼ˆç„¶è€Œï¼Œé€šå¸¸ç”¨ String ä¸èµ·ä½œç”¨ã€‚ï¼‰å½“æ‰€æœ‰æ‹·è´çš„å†…å®¹éƒ½å°±ç»ªæ—¶æˆ‘ä»¬éœ€è¦å‘é€ä¸€ä¸ªé—­åŒ…æ¥è¿è¡Œï¼Œè¿™ä¹Ÿæ˜¯æœ€å¤æ‚çš„åœ°æ–¹ï¼šæˆ‘ä»¬éœ€è¦æŠŠå†…å®¹ä¸€ä¸ªæŽ¥ä¸€ä¸ªåœ°åœ¨ç›®æ ‡è¡Œä¸‹é¢æ’å…¥ï¼Œä¿®æ”¹ leftItems æˆ– rightItems æ•°ç»„ï¼Œæœ€åŽè°ƒç”¨æˆ‘ä»¬ tableView çš„ insertRows() æ–¹æ³•æ¥å±•ç¤ºæ‹·è´åŽçš„ç»“æžœã€‚ é‚£ä¹ˆï¼ŒæŽ¥ä¸‹æ¥ï¼šæˆ‘ä»¬åˆšåˆšå†™äº†ä¸€äº›ä»£ç æ¥æŒ‡å‡ºæ‹–æ”¾æ“ä½œæœ€ç»ˆçš„ç›®æ ‡è¡Œã€‚ä½†å¦‚æžœæˆ‘ä»¬å¾—åˆ°äº† å¤šä¸ª æ‹·è´å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰€æœ‰çš„éƒ½æ˜¯åˆå§‹çš„ destination index path â€”â€” ç¬¬ä¸€ä¸ªæ‹·è´å¯¹è±¡çš„ç›®æ ‡è¡Œå°±æ˜¯å®ƒï¼Œç¬¬äºŒä¸ªæ‹·è´å¯¹è±¡çš„ç›®æ ‡è¡Œæ¯”å®ƒä½Žä¸€è¡Œï¼Œç¬¬ä¸‰ä¸ªæ‹·è´å¯¹è±¡çš„ç›®æ ‡è¡Œæ¯”å®ƒä½Žä¸¤è¡Œï¼Œç­‰ç­‰ã€‚å½“æˆ‘ä»¬ç§»åŠ¨æ¯ä¸ªæ‹·è´å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ index path å¹¶ä¸”æŠŠå®ƒæš‚å­˜åˆ°ä¸€ä¸ª indexPaths æ•°ç»„ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®© tableView åªè°ƒç”¨ä¸€æ¬¡ insertRows() æ–¹æ³•å°±å®Œæˆäº†å…¨éƒ¨æ’å…¥æ“ä½œ ã€‚ æŠŠä»£ç æ·»åŠ åˆ°ä½ çš„ performDropWith æ–¹æ³•ä¸­ï¼Œæ”¾åœ¨æˆ‘ä»¬åˆšæ‰å†™çš„ä»£ç ä¸‹é¢ï¼š 123456789101112131415161718192021222324252627// attempt to load strings from the drop coordinatorcoordinator.session.loadObjects(ofClass: NSString.self) &#123; items in // convert the item provider array to a string array or bail out guard let strings = items as? [String] else &#123; return &#125; // create an empty array to track rows we've copied var indexPaths = [IndexPath]() // loop over all the strings we received for (index, string) in strings.enumerated() &#123; // create an index path for this new row, moving it down depending on how many we've already inserted let indexPath = IndexPath(row: destinationIndexPath.row + index, section: destinationIndexPath.section) // insert the copy into the correct array if tableView == self.leftTableView &#123; self.leftItems.insert(string, at: indexPath.row) &#125; else &#123; self.rightItems.insert(string, at: indexPath.row) &#125; // keep track of this new row indexPaths.append(indexPath) &#125; // insert them all into the table view at once tableView.insertRows(at: indexPaths, with: .automatic)&#125; è¿™å°±æ˜¯å®Œæˆçš„æ‰€æœ‰ä»£ç äº† â€”â€” ä½ çŽ°åœ¨èƒ½å¤Ÿè¿è¡Œè¿™ä¸ª app å¹¶ä¸”åœ¨ä¸¤ä¸ª tableView ä¹‹é—´æ‹–åŠ¨è¡Œå†…å®¹æ¥å®Œæˆæ‹·è´ã€‚å®Œæˆè¿™ä¸ªèŠ±è´¹äº†è¿™ä¹ˆå¤šçš„å·¥ä½œé‡ï¼Œä½†ä»¤äººæ„Ÿåˆ°æƒŠå–œçš„æ˜¯ï¼šä½ æ‰€åšçš„è¿™äº›å·¥ä½œä½ èƒ½å¤Ÿæ”¯æŒæ•´ä¸ªç³»ç»Ÿçš„æ‹–æ”¾ï¼šè­¬å¦‚å¦‚æžœä½ è¯•ç€ç”¨ iPad æ¨¡æ‹Ÿå™¨çš„è¯ï¼Œä½ å°±ä¼šå‘çŽ°ä½ å¯ä»¥æŠŠè¿™äº›æ–‡æœ¬æ‹–æ”¾åˆ° Apple News å†…çš„ä»»ä½•ä¸€ä¸ªåˆ—è¡¨ä¸Šï¼Œæˆ–è€…æŠŠ tableView ä¸Šçš„æ–‡æœ¬æ‹–æ”¾åˆ° Safari çš„æœç´¢æ¡ä¸Šã€‚éžå¸¸é…·ï¼ åœ¨ä½ è¯•ç€åŽ»å®Œæˆæ‹–æ”¾æ“ä½œä¹‹å‰ï¼Œæˆ‘æƒ³å†å±•ç¤ºä¸€ä»¶äº‹ï¼šå¦‚ä½•å®žçŽ°ä¸ºå…¶ä»– View æ·»åŠ æ‹–æ”¾æ”¯æŒã€‚å…¶å®žæ¯”åœ¨ tableView ä¸Šå®žçŽ°è¦å®¹æ˜“ï¼Œé‚£å°±è®©æˆ‘ä»¬å¿«é€Ÿåšä¸€éå§ã€‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç®€å•çš„æŽ§ä»¶æ¥è®©æˆ‘ä»¬æœ‰å¯ä»¥æ·»åŠ æ‹–æ”¾çš„ä¸œè¥¿ã€‚è¿™æ¬¡æˆ‘ä»¬æ‰“ç®—åˆ›å»ºä¸€ä¸ª UIImageView å¹¶ä¸”æ¸²æŸ“ä¸€ä¸ªç®€å•çš„çº¢è‰²åœ†åœˆä½œä¸ºå›¾ç‰‡ã€‚ä½ å¯ä»¥ä¿ç•™å·²å­˜åœ¨çš„å•è§†å›¾ APP æ¨¡æ¿ å¹¶æŠŠ ViewController.swift çš„å†…å®¹ç”¨æ–°ä»£ç æ›¿æ¢ï¼š 1234567891011121314151617181920212223import UIKitclass ViewController: UIViewController &#123; // create a property for our image view and define its size var imageView: UIImageView! let size = 512 override func viewDidLoad() &#123; super.viewDidLoad() // create and add the image view imageView = UIImageView(frame: CGRect(x: 50, y: 50, width: size, height: size)) view.addSubview(imageView) // render a red circle at the same size, and use it in the image view let renderer = UIGraphicsImageRenderer(size: CGSize(width: size, height: size)) imageView.image = renderer.image &#123; ctx in let rectangle = CGRect(x: 0, y: 0, width: size, height: size) ctx.cgContext.setFillColor(UIColor.red.cgColor) ctx.cgContext.fillEllipse(in: rectangle) &#125; &#125;&#125; åƒä¹‹å‰ä¸€æ ·ï¼Œè¿™éƒ½æ˜¯äº› iOS çš„è€ä»£ç æ‰€ä»¥æˆ‘ä¸æ‰“ç®—ç»™ä½ è¯¦ç»†è§£é‡Šå®ƒã€‚å¦‚æžœä½ è¯•ç€åœ¨ iPad æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œï¼Œä½ å°±ä¼šåœ¨æŽ§åˆ¶å™¨é‡Œçœ‹åˆ°ä¸€ä¸ªå¤§çš„çº¢è‰²åœ†åœˆ â€”â€” è¿™å¯¹ä¾›æˆ‘ä»¬æµ‹è¯•æ¥è¯´è¶³å¤Ÿäº†ã€‚ è‡ªå®šä¹‰è§†å›¾çš„æ‹–æ”¾æ˜¯é€šè¿‡ä¸€ä¸ªæ–°çš„å«ä½œ UIDragInteraction ç±»æ¥å®žçŽ°çš„ã€‚ ä½ å‘Šè¯‰å®ƒåœ¨å“ªé‡Œå‘é€ä¿¡æ¯ï¼ˆåœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬ç”¨çš„æ˜¯å½“å‰çš„æŽ§åˆ¶å™¨ï¼‰ï¼Œç„¶åŽå°†å®ƒå’Œç”¨æ¥äº¤äº’çš„ View ç»‘å®šã€‚ é‡è¦æç¤ºï¼š åƒä¸‡ä¸è¦å¿˜äº†æ‰“å¼€ç›¸å…³è§†å›¾çš„äº¤äº’ï¼Œå¦åˆ™å½“æ‹–æ”¾æœ€åŽä¸èµ·ä½œç”¨æ—¶ï¼Œä½ ä¼šæ„Ÿåˆ°éžå¸¸å›°æƒ‘ã€‚ é¦–å…ˆï¼Œ åœ¨ viewDidLoad() çš„æœ€æœ«å°¾æ·»åŠ è¿™ä¸‰è¡Œä»£ç ï¼Œå°±åœ¨ä¹‹å‰çš„ä»£ç åŽé¢ã€‚ä½ å°±ä¼šçœ‹åˆ° Xcode æç¤ºæˆ‘ä»¬çš„ View Controller æ²¡æœ‰éµå¾ªUIDragInteractionDelegate åè®®ï¼Œæ‰€ä»¥æŠŠç±»çš„å®šä¹‰æ”¹æˆä¸‹é¢è¿™æ ·ï¼š 1class ViewController: UIViewController, UIDragInteractionDelegate &#123; Xcode å°†ä¼šç»§ç»­æç¤ºæˆ‘ä»¬æ²¡æœ‰å®žçŽ° UIDragInteractionDelegate åè®®çš„ä¸€ä¸ªå¿…è¦æ–¹æ³•ï¼Œæ‰€ä»¥é‡å¤ä¹‹å‰æˆ‘ä»¬æ‰€åšçš„ â€”â€” åœ¨å‡ºé”™è¡Œä¸Šå•å‡»é”™è¯¯æç¤ºï¼Œç„¶åŽé€‰æ‹© â€œFixâ€ æ¥æ’å…¥ä¸‹é¢çš„ä»£ç ï¼š 123func dragInteraction(_ interaction: UIDragInteraction, itemsForBeginning session: UIDragSession) -&gt; [UIDragItem] &#123; code&#125; è¿™å°±åƒæˆ‘ä»¬ä¹‹å‰ä¸ºæˆ‘ä»¬çš„ tableView å®žçŽ°çš„ itemsForBeginning æ–¹æ³•ä¸€æ ·ï¼šå½“ç”¨æˆ·å¼€å§‹æ‹–åŠ¨æˆ‘ä»¬çš„ imageView çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è¿”å›žæˆ‘ä»¬æƒ³è¦åˆ†äº«çš„å›¾åƒã€‚ è¿™äº›ä»£ç æ˜¯éžå¸¸å¥½å¹¶ä¸”ç®€å•çš„ï¼šæˆ‘ä»¬ä¼šä½¿ç”¨ guard æ¥é˜²æ­¢æˆ‘ä»¬åœ¨ imageView ä¸Šæ‹‰å–å›¾ç‰‡æ—¶å‡ºçŽ°é—®é¢˜ï¼Œå…ˆç”¨ä¸€ä¸ª NSItemProvider åŒ…è£… imageï¼Œç„¶åŽè¿”å›žæ•°æ®çš„æ—¶å€™å†ä½¿ç”¨ UIDragItem åŒ…è£…ä¸‹ã€‚ å°† itemsForBeginning æ–¹æ³•ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢ï¼š 123456func dragInteraction(_ interaction: UIDragInteraction, itemsForBeginning session: UIDragSession) -&gt; [UIDragItem] &#123; guard let image = imageView.image else &#123; return [] &#125; let provider = NSItemProvider(object: image) let item = UIDragItem(itemProvider: provider) return [item]&#125; è¿™å°±å®Œæˆäº†ï¼ å°è¯•ä½¿ç”¨ ipad å¤šä»»åŠ¡å¤„ç†åŠŸèƒ½æ¥å°†å›¾åº“æ”¾åœ¨å±å¹•çš„å³ç«¯ â€”â€” ä½ èƒ½å¤Ÿé€šè¿‡æ‹–æ”¾å›¾ç‰‡æ¥å°†å›¾ç‰‡ä»Žä½ çš„ APP æ‹·è´åˆ°å›¾åº“é‡Œã€‚ å¢žå¼ºçŽ°å®žå¢žå¼ºçŽ°å®ž (AR) å·²ç»å‡ºçŽ°æœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œä½†æ˜¯è‹¹æžœåœ¨ iOS 11 ä¸Šåšäº†ä¸€äº›å¯åœˆå¯ç‚¹çš„äº‹æƒ…ï¼šä»–ä»¬åˆ›é€ äº†ä¸€ä¸ªå“è¶Šçš„å®žçŽ°å°±æ˜¯è®© AR å¼€å‘å¯ä»¥å’ŒçŽ°æœ‰çš„æ¸¸æˆå¼€å‘æŠ€æœ¯æ— ç¼é›†æˆã€‚è¿™å°±æ„å‘³ç€ä½ ä¸éœ€è¦åšå¤ªå¤šçš„å·¥ä½œå°±èƒ½æŠŠä½  SpriteKit æˆ– SceneKit æŠ€èƒ½å’Œ AR é›†æˆèµ·æ¥ï¼Œè¿™æ˜¯ä¸ªéžå¸¸è¯±äººçš„å‰æ™¯ã€‚ Xcode è‡ªå¸¦äº†ä¸€ä¸ªéžå¸¸æ£’å¯ä»¥ç«‹å³ä½¿ç”¨çš„ ARKit æ¨¡æ¿ï¼Œå› æ­¤æˆ‘é¼“åŠ±ä½ åŽ»å°è¯•ä¸€ä¸‹ â€”â€” ä½ ä¼šæƒŠå¥‡åœ°å‘çŽ°å®žçŽ°å®ƒæ˜¯å¤šä¹ˆçš„å®¹æ˜“ï¼ æˆ‘æƒ³å¿«é€Ÿåœ°æ¼”ç¤ºä¸‹æ¨¡æ¿çš„ä½¿ç”¨ï¼Œè¿™æ ·ä½ å°±å¯ä»¥äº†è§£åˆ°è¿™ä¸€åˆ‡æ˜¯å¦‚ä½•èžåˆåœ¨ä¸€èµ·çš„ã€‚é¦–å…ˆï¼Œä½¿ç”¨è™šæ‹ŸçŽ°å®žæ¨¡æ¿åˆ›å»ºä¸€ä¸ªæ–°çš„ Xcode å·¥ç¨‹ï¼Œç„¶åŽé€‰æ‹© SpriteKit ä½œä¸ºå†…å®¹æŠ€æœ¯ã€‚æ˜¯çš„ï¼ŒSpriteKit æ˜¯ä¸€ä¸ª 2D æ¡†æž¶ï¼Œä½†å®ƒä»èƒ½å¤Ÿåœ¨ ARKit ä¸­ç”¨å¾—å¾ˆå¥½ï¼Œå› ä¸ºå®ƒå¯ä»¥åƒ 3D ä¸€æ ·é€šè¿‡æ‰­æ›²æˆ–æ—‹è½¬æ¥å±•ç¤ºä½ çš„ç²¾çµã€‚ å¦‚æžœä½ æ‰“å¼€äº† Main.storyboard ï¼Œä½ ä¼šå‘çŽ°è¿™ä¸ª ARKit æ¨¡æ¿ä¸Žæ™®é€šçš„ SpriteKit æ¨¡æ¿æœ‰æ‰€ä¸åŒï¼šå®ƒä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„ ARSKView ç•Œé¢å¯¹è±¡ï¼Œå°† ARKit å’Œ SpriteKit ä¸¤ä¸ªä¸–ç•Œèžåˆåœ¨ä¸€èµ·ã€‚è¿™ä¸ªå¯¹è±¡é€šè¿‡ä¸€ä¸ª outlet å’Œ ViewController.swift è¿žæŽ¥åœ¨ä¸€èµ·ï¼Œåœ¨è¿™ä¸ªæŽ§åˆ¶å™¨ä¸­çš„ viewWillAppear() æ–¹æ³•ä¸­æž„å»º AR è¿½è¸ªï¼Œå¹¶åœ¨ viewWillDisappear() æ–¹æ³•ä¸­æš‚åœè¿½è¸ªã€‚ ä½†æ˜¯ï¼ŒçœŸæ­£èµ·ä½œç”¨çš„æ˜¯åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼šScene.swift æ–‡ä»¶çš„ touchesBegan() æ–¹æ³•å†…ï¼Œå’Œ ViewController.swift æ–‡ä»¶çš„ nodeFor æ–¹æ³•ã€‚ åœ¨é€šå¸¸çš„ SpriteKit ä¸­ä½ åˆ›å»ºèŠ‚ç‚¹å¹¶æŠŠèŠ‚ç‚¹ç›´æŽ¥æ·»åŠ åˆ°ä½ çš„åœºæ™¯ä¸­ï¼Œä½†æ˜¯ä½¿ç”¨ ARKit åŽåˆ›å»ºçš„æ˜¯ é”šç‚¹ â€”â€” åŒ…å«åœºæ™¯ä½ç½®å’Œæ ‡è¯†ç¬¦çš„å ä½ï¼Œä½†å®ƒæ²¡æœ‰å®žé™…çš„å†…å®¹ã€‚æ ¹æ®éœ€è¦çš„æ—¶å€™ä½¿ç”¨ nodeFor æ–¹æ³•è½¬æ¢ä¸º SpriteKit èŠ‚ç‚¹ã€‚å¦‚æžœä½ æ›¾ä½¿ç”¨è¿‡ MKMapView ï¼Œä¼šå‘çŽ°è¿™å’Œ MKMapView æ·»åŠ å¤§å¤´é’ˆå’Œæ ‡æ³¨çš„æ–¹å¼æ˜¯ç±»ä¼¼çš„ â€”â€” æ ‡æ³¨æ˜¯ä½ çš„æ¨¡åž‹æ•°æ®ï¼Œå¤§å¤´é’ˆæ˜¯ viewã€‚ åœ¨ Scene.swift ç±»çš„ touchesBegan() æ–¹æ³•ä½ ä¼šçœ‹åˆ°ä»Ž ARKit æ‹‰å‡ºå½“å‰å¸§çš„ä»£ç ï¼Œå…ˆè®¡ç®—æ”¾å…¥ä¸€ä¸ªæ–°æ•Œäººçš„ä½ç½®ã€‚è¿™æ˜¯é€šè¿‡çŸ©é˜µä¹˜æ³•å®žçŽ°ï¼šå¦‚æžœä½ åˆ›å»ºä¸€ä¸ªå•ä½çŸ©é˜µï¼ˆè¡¨ç¤ºä½ç½® X:0, Y:0, Z:0 çš„ä¸œè¥¿ï¼‰ï¼Œå†å°†å®ƒçš„ Z åæ ‡ç§»å›ž 0.2ï¼ˆç›¸å½“äºŽ 0.2 ç±³ï¼‰ï¼Œä½ å¯ä»¥ä¹˜ä»¥å½“å‰åœºæ™¯ç›¸æœºä½ç½®æ¥å®žçŽ°å‘ç”¨æˆ·æŒ‡å‘çš„æ–¹å‘ç§»åŠ¨ã€‚ æ‰€ä»¥ï¼Œå½“ç”¨æˆ·æŒ‡å‘å‰æ–¹é”šç‚¹å°±ä¼šè¢«æ”¾åœ¨å‰æ–¹ï¼Œå¦‚æžœä»–ä»¬æŒ‡å‘ä¸Šæ–¹ï¼Œé”šç‚¹å°±ä¼šæ”¾åœ¨ä¸Šæ–¹ã€‚ä¸€æ—¦é”šç‚¹è¢«æ”¾åœ¨é‚£ï¼Œå®ƒå°±ä¼šå‘†åœ¨é‚£ï¼šARKit å°†ä¼šè‡ªåŠ¨ç§»åŠ¨ï¼Œæ—‹è½¬æˆ–æ‰­æ›²æ¥ç¡®ä¿å½“ç”¨æˆ·çš„è®¾å¤‡ç§»åŠ¨æ—¶ä¸Žé”šç‚¹å§‹ç»ˆæ­£ç¡®å¯¹é½ã€‚ æ‰€æœ‰çš„æ“ä½œå¯ä»¥ç”¨ä¸‰è¡Œä»£ç æ¥å®žçŽ°ï¼š 123var translation = matrix_identity_float4x4translation.columns.3.z = -0.2let transform = simd_mul(currentFrame.camera.transform, translation) ä¸€æ—¦è®¡ç®—å‡ºæ¥è½¬æ¢ï¼Œä½ç§»å°±ä¼šåŒ…è£…æˆä¸€ä¸ªé”šç‚¹å¹¶æ·»åŠ åˆ°å›žè¯ä¸­ï¼Œå°±åƒè¿™æ ·ï¼š 12let anchor = ARAnchor(transform: transform)sceneView.session.add(anchor: anchor) æœ€åŽä¼šè°ƒç”¨ ViewController.swift ç±»çš„ nodeFor æ–¹æ³•ã€‚ä¹‹æ‰€ä»¥ä¼šè°ƒç”¨æ˜¯å› ä¸ºå½“å‰ ViewController è¢«è®¾ç½®æˆäº† ARSKView çš„ä»£ç†ï¼Œå½“å‰ ViewController å°±ä¼šåœ¨éœ€è¦çš„æ—¶å€™è´Ÿè´£æŠŠé”šç‚¹è½¬æ¢æˆèŠ‚ç‚¹ã€‚ä½  ä¸éœ€è¦ æ‹…å¿ƒå®šä½è¿™äº›èŠ‚ç‚¹ï¼šè®°ä½ï¼Œé”šç‚¹å·²ç»æ”¾ç½®åˆ°çœŸå®žä¸–ç•Œçš„å…·ä½“åæ ‡ä¸Šäº†ï¼ŒARKit è´Ÿè´£æ˜ å°„é”šç‚¹çš„ä½ç½®å¹¶è½¬æ¢æˆ SpriteKit èŠ‚ç‚¹ã€‚ æ€»ä¹‹ï¼ŒnodeFor æ–¹æ³•å¾ˆç®€å•ï¼š 1234567func view(_ view: ARSKView, nodeFor anchor: ARAnchor) -&gt; SKNode? &#123; // Create and configure a node for the anchor added to the view's session. let labelNode = SKLabelNode(text: "Enemy") labelNode.horizontalAlignmentMode = .center labelNode.verticalAlignmentMode = .center return labelNode;&#125; å¦‚æžœä½ æƒ³çŸ¥é“ï¼ŒARKit é”šç‚¹æœ‰ä¸€ä¸ª identifier å±žæ€§å¯ä»¥è®©ä½ çŸ¥é“åˆ›å»ºäº†ä»€ä¹ˆæ ·çš„èŠ‚ç‚¹ã€‚åœ¨ Xcode æ¨¡æ¿ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æ˜¯æœªçŸ¥çš„ã€‚ä½†æ˜¯åœ¨ä½ è‡ªå·±çš„å·¥ç¨‹ä¸­ä½ å‡ ä¹Žè‚¯å®šä¼šæƒ³æŠŠäº‹ç‰©å”¯ä¸€æ ‡è¯†å‡ºæ¥ã€‚ å°±æ˜¯è¿™äº›ï¼è¿™ä¹ˆå°‘çš„ä»£ç å¸¦æ¥çš„ç»“æžœæ˜¯éžå¸¸æœ‰æ•ˆçš„ â€”â€” ARKit æ³¨å®šæ˜¯ä¸€ä¸ªå¤§çš„é£žè·ƒã€‚ æ’æ’­å¹¿å‘Šå¦‚æžœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯èƒ½å¯¹æˆ‘æ–°å†™çš„ iOS 11 å®žè·µæ•™ç¨‹æ–°ä¹¦æ„Ÿå…´è¶£ã€‚ä½ å°†ä¼šå®žé™…å¼€å‘åŸºäºŽ Core ML , PDFView , ARKit , æ‹–æ‹½ç­‰æ›´å¤šæ–°æŠ€æœ¯çš„å·¥ç¨‹ã€‚ â€”â€” è¿™æ˜¯å­¦ä¹  iOS 11 æœ€å¿«çš„æ–¹å¼ï¼ Buy Practical iOS 11 for $30 PDF æ¸²æŸ“è‡ªä»Ž OS X 10.4 å¼€å§‹å—ç›ŠäºŽå‡ ä¹Žä¸éœ€è¦æä¾›ä»»ä½•ä»£ç å°±å¯ä»¥æä¾› PDF æ¸²æŸ“ï¼Œæ“ä½œï¼Œæ ‡æ³¨ç”šè‡³æ›´å¤šçš„ PDFKit æ¡†æž¶åŽï¼ŒmacOS å°±å§‹ç»ˆå¯¹ PDF æ¸²æŸ“æœ‰ç€ä¸€æµçš„æ”¯æŒã€‚ è‡³äºŽï¼Œåˆ°äº† iOS 11 ä¹Ÿå¯ä»¥åœ¨ç³»ç»Ÿä¸­ä½¿ç”¨ PDF æ¡†æž¶çš„å…¨éƒ¨åŠŸèƒ½äº†ï¼šä½ å¯ä»¥ä½¿ç”¨ PDFView ç±»æ¥æ˜¾ç¤º PDFï¼Œè®©ç”¨æˆ·æµè§ˆæ–‡æ¡£ï¼Œé€‰æ‹©å¹¶ä¸”åˆ†äº«å†…å®¹ï¼Œæ”¾å¤§ç¼©å°ç­‰ç­‰æ“ä½œã€‚æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨ç‹¬ç«‹çš„ç±»æ¯”å¦‚ï¼š PDFDocument , PDFPage å’Œ PDFAnnotation æ¥åˆ›å»ºä½ è‡ªå·±è‡ªå®šä¹‰çš„ PDF é˜…è¯»å™¨ã€‚ å’Œæ‹–æ”¾ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„ app æ¥æ¼”ç¤º PDFKIT æ˜¯å¤šä¹ˆçš„ç®€å•ã€‚å¦‚æžœä½ æ„¿æ„çš„è¯ï¼Œä½ å¯ä»¥ç»§ç»­ä½¿ç”¨ä½ åˆšæ‰åˆ›å»ºçš„å•è§†å›¾ app å·¥ç¨‹ï¼Œä½†ä½ éœ€è¦å‘å·¥ç¨‹ä¸­å¯¼å…¥ä¸€ä¸ª PDF æ–‡ä»¶æ¥ä¾› PDFKit åŽ»è¯»å–ã€‚ ä½ éœ€è¦å­¦ä¹ ä¸¤ä¸ªæ–°çš„æ¯”è¾ƒå°çš„ç±»æ¥ç¼–å†™ä»£ç ï¼Œç¬¬ä¸€ä¸ªæ˜¯ PDFView ï¼Œå®ƒè´Ÿè´£æ‰€æœ‰çš„è´Ÿè´£å·¥ä½œï¼ŒåŒ…æ‹¬ PDF æ¸²æŸ“ï¼Œæ»šåŠ¨å’Œç¼©æ”¾æ‰‹åŠ¿å“åº”ï¼Œé€‰æ‹©æ–‡æœ¬ç­‰ã€‚å®ƒä¹Ÿæ˜¯ iOS ç³»ç»Ÿä¸­å¸¸è§çš„ UIView å­ç±»ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä¸ä½¿ç”¨ä»»ä½•å‚æ•°åœ°åˆ›å»º PDFView å®žä¾‹å¯¹è±¡ï¼Œç„¶åŽä½¿ç”¨è‡ªåŠ¨å¸ƒå±€æ¥çº¦æŸå®ƒçš„ä½ç½®æ¥æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚ç¬¬äºŒä¸ªæ˜¯æ–°çš„ç±»æ˜¯ PDFDocument ï¼Œå®ƒå¯ä»¥é€šè¿‡ä¸€ä¸ª URL æ¥åŠ è½½ä¸€ä¸ªåœ¨å…¶ä»–åœ°æ–¹å¯ä»¥è¢«æ¸²æŸ“æˆ–è€…æ“ä½œ PDF æ–‡æ¡£ã€‚ æŠŠ ViewController.swift ç±»çš„å…¨éƒ¨ä»£ç ç”¨è¿™ä¸ªä»£æ›¿ï¼š 1234567891011121314151617181920212223242526import PDFKitimport UIKitclass ViewController: UIViewController &#123; // store our PDFView in a property so we can manipulate it later var pdfView: PDFView! override func viewDidLoad() &#123; super.viewDidLoad() // create and add the PDF view pdfView = PDFView() pdfView.translatesAutoresizingMaskIntoConstraints = false view.addSubview(pdfView) // make it take up the full screen pdfView.leadingAnchor.constraint(equalTo: view.leadingAnchor).isActive = true pdfView.trailingAnchor.constraint(equalTo: view.trailingAnchor).isActive = true pdfView.topAnchor.constraint(equalTo: view.topAnchor).isActive = true pdfView.bottomAnchor.constraint(equalTo: view.bottomAnchor).isActive = true // load our example PDF and make it display immediately let url = Bundle.main.url(forResource: "your-pdf-name-here", withExtension: "pdf")! pdfView.document = PDFDocument(url: url) &#125;&#125; å¦‚æžœè¿è¡Œ app ä½ åº”è¯¥å¯ä»¥çœ‹åˆ°ä½ å¯ä»¥ä½¿ç”¨è¿žç»­çš„æ»šåŠ¨æœºåˆ¶åž‚ç›´æ»šåŠ¨é¡µé¢ã€‚å¦‚æžœä½ åœ¨çœŸæœºä¸Šæµ‹è¯•ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æåˆæ“ä½œè¿›è¡Œç¼©æ”¾ â€”â€” è¿™æ—¶ä½ å°±ä¼šå‘çŽ° PDF ä»¥æ›´é«˜çš„åˆ†è¾¨çŽ‡é‡æ–°æ¸²æŸ“ã€‚å¦‚æžœä½ æƒ³è¦æ›´æ”¹ PDF çš„å¸ƒå±€æ ·å¼ï¼Œä½ å¯ä»¥è¯•ç€åŽ»è®¾ç½® displayMode, displayDirection, å’Œ displaysAsBook å±žæ€§ã€‚ ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†é¡µé¢ä»¥åŒé¡µçš„æ¨¡å¼å±•çŽ°ï¼Œè€Œå°é¢é»˜è®¤å°±æ˜¯è¿™æ ·çš„ï¼š 12pdfView.displayMode = .twoUpContinuouspdfView.displaysAsBook = true PDFView æä¾›äº†ä¸€ç³»åˆ—æœ‰ç”¨çš„æ–¹æ³•æ¥è®©ç”¨æˆ·æµè§ˆå’Œæ“ä½œ PDFã€‚ä¸ºäº†è¯•éªŒï¼Œæˆ‘ä»¬ä¼šåœ¨æˆ‘ä»¬çš„æŽ§åˆ¶å™¨ä¸Šæ·»åŠ ä¸€äº›å¯¼èˆªæ æŒ‰é’®ï¼Œå› ä¸ºè¿™æ˜¯æ·»åŠ äº¤äº’æœ€ç®€å•çš„æ–¹å¼ã€‚ æ€»å…±ä¸‰æ­¥ï¼Œæˆ‘ä»¬å…ˆæ·»åŠ ä¸€ä¸ª navigation controllerï¼Œ è¿™æ ·æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªçŽ°æˆçš„å¯¼èˆªæ æ¥ä½¿ç”¨ã€‚æ‰€ä»¥ï¼Œæ‰“å¼€ä½ çš„ Main.storyboard ï¼Œåœ¨å¤§çº²è§†å›¾é‡Œé€‰ä¸­ View Controller Scene ã€‚å†è¿›å…¥ç¼–è¾‘èœå•é€‰æ‹© Embed In &gt; Navigation Controller ã€‚ æŽ¥ä¸‹æ¥ï¼Œåœ¨ ViewController.swift ä¸­çš„ viewDidLoad() æ–¹æ³•ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š 12345let printSelectionBtn = UIBarButtonItem(title: "Selection", style: .plain, target: self, action: #selector(printSelection))let firstPageBtn = UIBarButtonItem(title: "First", style: .plain, target: self, action: #selector(firstPage))let lastPageBtn = UIBarButtonItem(title: "Last", style: .plain, target: self, action: #selector(lastPage))navigationItem.rightBarButtonItems = [printSelectionBtn, firstPageBtn, lastPageBtn] è¿™äº›ä»£ç æ·»åŠ äº†ä¸‰ä¸ªæŒ‰é’®æ¥å®žçŽ°ä¸€äº›åŸºæœ¬çš„åŠŸèƒ½ã€‚æœ€åŽï¼Œæˆ‘ä»¬åªéœ€è¦å†™è¿™ä¸‰ä¸ªæŒ‰é’®çš„å“åº”æ–¹æ³•å°±å¥½äº†ï¼Œé‚£ä¹ˆæŠŠä¸‹é¢è¿™äº›æ–¹æ³•æ·»åŠ åˆ° ViewController ç±»ä¸­ï¼š 1234567891011func printSelection() &#123; print(pdfView.currentSelection ?? "No selection")&#125;func firstPage() &#123; pdfView.goToFirstPage(nil)&#125;func lastPage() &#123; pdfView.goToLastPage(nil)&#125; çŽ°åœ¨ï¼Œå¦‚æžœæ˜¯åœ¨ Swift 3 ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšã€‚ä½†æ˜¯åˆ°äº† Swift 4 ä½ å°†ä¼šçœ‹åˆ°æŠ¥ â€œArgument of â€˜#selectorâ€™ refers to instance method â€˜firstPage()â€™ that is not exposed to Objective-Câ€ é”™è¯¯ã€‚æ¢å¥è¯è¯´å°±æ˜¯ Swift çš„æ–¹æ³•å¯¹ Objective-C ä¸å¯è§çš„ï¼Œè€Œ UIBarButtonItem æ˜¯ Objective-C ä»£ç å®žçŽ°ã€‚ å½“ç„¶åœ¨æ¯ä¸ªæ–¹æ³•ä¹‹å‰åŠ ä¸Š @objc æ˜¯ä¸ªæœ‰æ•ˆçš„åŠžæ³•ï¼Œæˆ‘çŒœå¤§éƒ¨åˆ†äººå¯èƒ½å°±è€¸è€¸è‚©ï¼ˆæˆ‘æœ‰ä»€ä¹ˆåŠžæ³•ï¼Œæˆ‘ä¹Ÿå¾ˆç»æœ›å•Šï¼‰ï¼Œç„¶åŽåœ¨ç±»ä¹‹å‰åŠ ä¸Šä¸€ä¸ª @objcMembers çš„å®šä¹‰ â€”â€” è¿™ä¼šåƒä¹‹å‰ Swift 3 é‚£æ ·è‡ªåŠ¨å°†ç±»çš„æ‰€æœ‰ä¸œè¥¿éƒ½æš´éœ²ç»™ Objective-C ã€‚æ‰€ä»¥ï¼ŒæŠŠç±»çš„å®šä¹‰ä¿®æ”¹æˆè¿™æ ·ï¼š 12@objcMembersclass ViewController: UIViewController &#123; çŽ°åœ¨è¿™å°±æ­£ç¡®åœ°ç¼–è¯‘äº†ï¼ŒçŽ°åœ¨ä½ å°†ä¼šçœ‹åˆ°è·³è½¬åˆ°é¦–é¡µå’Œæœ«é¡µçš„åŠŸèƒ½å¯ä»¥ç›´æŽ¥ä½¿ç”¨äº†ã€‚è‡³äºŽé€‰æ‹©æŒ‰é’®ï¼Œä½ åªéœ€è¦åœ¨ç‚¹å‡»æŒ‰é’®ä¹‹å‰åœ¨ PDF ä¹‹å‰é€‰æ‹©ä¸€äº›æ–‡æœ¬ â€”â€” å°±åƒåœ¨ iBooks è¿›è¡Œæ–‡æœ¬é€‰æ‹©æ“ä½œé‚£æ ·ã€‚ å¼€å§‹æ”¯æŒ NFC è¯»å–iPhone 7 å¼•å…¥äº†é’ˆå¯¹ NFC çš„ç¡¬ä»¶æ”¯æŒï¼Œè‡³äºŽ iOS 11ï¼ŒNFC å¼€å§‹æ”¯æŒè®©æˆ‘ä»¬åœ¨è‡ªå·±çš„ APP å†…ä½¿ç”¨ï¼šä½ çŽ°åœ¨å¯ä»¥ç¼–å†™ä»£ç æ¥æ£€æµ‹é™„è¿‘çš„ NFC NDEF æ ‡ç­¾ï¼Œè€Œä¸”å‡ºä¹Žæ„æ–™åœ°ç®€å• â€”â€” è‡³å°‘åœ¨ ä»£ç å±‚é¢ ã€‚ç„¶è€Œåœ¨æˆ‘ä»¬çœ‹ä»£ç ä¹‹å‰ï¼Œä½ éœ€è¦ç»•è¿‡ä¸€äº›å‘ï¼Œæ‰€æœ‰çš„æˆ‘éƒ½å¸Œæœ›åœ¨æ­£å¼ç‰ˆæ¶ˆå¤±ã€‚ Step 1: åœ¨ Xcode é‡Œåˆ›å»ºä¸€ä¸ªæ–°çš„ å•è§†å›¾ APP æ¨¡æ¿ã€‚ Step 2: åŽ» iTunes é…ç½®ç½‘ç«™ https://developer.apple.com/account ä¸ºä½ çš„ APP åˆ›å»ºä¸€ä¸ª åŒ…å« NFC æ ‡ç­¾è¯»å–çš„ APP IDã€‚ Step 3: ä¸ºè¿™ä¸ª APP ID åˆ›å»ºä¸€ä¸ªæè¿°æ–‡ä»¶ï¼Œå¹¶å°†å…¶å®‰è£…åˆ° Xcode ä¸­ã€‚å–æ¶ˆ â€œAutomatically manage signingâ€ é€‰é¡¹å¡ï¼Œå¹¶ä¸”é€‰æ‹©ä½ åˆšæ‰å®‰è£…çš„æè¿°æ–‡ä»¶ã€‚ä½ å¯ä»¥ç‚¹å‡»æè¿°æ–‡ä»¶æ—è¾¹çš„å° â€œiâ€ æŒ‰é’®æ¥åœ¨æƒé™åˆ—è¡¨é‡ŒæŸ¥çœ‹ â€œcom.apple.developer.nfc.readersession.formatsâ€ã€‚ Step 4: ä½¿ç”¨ å¿«æ·é”® Cmd+N ä¸ºå·¥ç¨‹æ·»åŠ ä¸€ä¸ªæ–°çš„æ–‡ä»¶ï¼Œå…ˆé€‰æ‹©å±žæ€§åˆ—è¡¨ã€‚æŠŠå®ƒå‘½åä¸º â€œEntitlements.entitlementsâ€ ï¼Œå¹¶ä¸”ç¡®ä¿ â€œGroupâ€ æ—è¾¹æœ‰ä¸€ä¸ªè“è‰²çš„å›¾æ ‡ã€‚ Step 5: æ‰“å¼€ Entitlements.entitlements è¿›è¡Œç¼–è¾‘ï¼Œå³å‡»ç©ºç™½å¤„é€‰æ‹© â€œAdd Rowâ€ã€‚é”®å€¼ä¸º â€œcom.apple.developer.nfc.readersession.formatsâ€ å¹¶æŠŠå®ƒçš„ç±»åž‹æ”¹ä¸ºæ•°ç»„ã€‚ç‚¹å‡» â€œcom.apple.developer.nfc.readersession.formatsâ€ å·¦ä¾§çš„æŒ‡ç¤ºç®­å¤´ï¼Œå†ç‚¹å‡»å³è¾¹çš„ + æ ‡è®°ã€‚è¿™æ—¶åº”è¯¥ä¼šæ’å…¥ä¸€ä¸ªå¸¦æœ‰ç©ºå€¼çš„ â€œItem 0â€ é”® â€”â€” æŠŠå®ƒçš„å€¼æ”¹ä¸º â€œNDEFâ€ã€‚ Step 6: å®šä½åˆ°ä½ çš„ target çš„ build settings æ‰¾åˆ° Code Signing Entitlements ã€‚åœ¨æ–‡æœ¬æ¡†é‡Œå¡«å…¥ â€œEntitlements.entitlementsâ€ ã€‚ Step 7: æ‰“å¼€ä½ çš„ Info.plist æ–‡ä»¶ï¼Œå†å³å‡»ç©ºç™½å¤„é€‰æ‹© â€œAdd Rowâ€ ã€‚æ·»åŠ é”®ä¸º â€œPrivacy - NFC Scan Usage Descriptionâ€ ï¼Œå€¼ä¸º â€œSwiftyNFCâ€ ã€‚ æ˜¯çš„ï¼Œå°±æ˜¯ä¸€å›¢ç³Ÿã€‚æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆâ€”â€”èƒ½å¤Ÿæ‰«æ NFC å‡ ä¹Žæ²¡æœ‰æ¯”è®¿é—®æŸäººçš„å¥åº·è®°å½•æ›´ç§å¯†ï¼Œè€Œä¸”æ›´å®¹æ˜“åšåˆ°ã€‚åœ¨ä½ æ€è€ƒæ¶æ„åº”ç”¨ä¼šä¸ä¼šæš—åœ°é‡Œæ‰«æ NFC ä¹‹å‰ï¼Œè¿˜æ˜¯çœçœå§ï¼šå°±åƒåˆšæ‰çœ‹åˆ°çš„é‚£æ ·ï¼Œè¿™æ˜¯æ ¹æœ¬ä¸å¯èƒ½åšåˆ°çš„ã€‚ åœ¨æ··ä¹±çš„è®¾ç½®ä¹‹åŽï¼Œå¾ˆé«˜å…´åœ°å‘Šè¯‰ä½ ä½¿ NFC å·¥ä½œçš„ä»£ç å‡ ä¹Žæ˜¯å¾®ä¸è¶³é“çš„ï¼šåˆ›å»ºä¸€ä¸ªå±žæ€§æ¥å­˜å‚¨ä¸€ä¸ªä»£è¡¨å½“å‰ NFC æ‰«æä¼šè¯çš„ NFCNDEFReaderSession å¯¹è±¡ï¼Œå†åˆ›å»ºè¿™ä¸ªå¯¹è±¡å¹¶è¦æ±‚å®ƒå¼€å§‹æ‰«æã€‚ å½“ä½ åˆ›å»ºè¯»å–ä¼šè¯æ—¶ï¼Œä½ éœ€è¦ç»™å®ƒæä¾›ä¸‰æ¡æ•°æ®ï¼šå®ƒèƒ½å¤Ÿå‘é€ä¿¡æ¯çš„ä»£ç†ï¼Œå®ƒåº”è¯¥ç”¨äºŽå‘é€è¿™äº›æ¶ˆæ¯çš„é˜Ÿåˆ—å’Œå½“å®ƒæ‰«æåˆ°ä¸€ä¸ª NFC æ ‡ç­¾çš„æ—¶å€™æ˜¯å¦ç»“æŸæ‰«æã€‚æˆ‘ä»¬ä¼šç”¨ self ä½œä¸ºä»£ç†ï¼ŒDispatchQueue.main ä½œä¸ºé˜Ÿåˆ—ï¼Œå°†å€¼è®¾ç½®ä¸º false å½“æ‰«æåˆ°ä¸€ä¸ªæ ‡ç­¾åŽä¸åœæ­¢æ‰«æï¼Œæ‰€ä»¥å®ƒä¼šç»§ç»­æ‰«æç›´åˆ°60ç§’ç»“æŸã€‚ æ‰“å¼€ ViewController.swiftï¼Œå¯¼å…¥ CoreNFCï¼Œå†æŠŠè¿™ä¸ªå±žæ€§æ·»åŠ åˆ° ViewController ç±»ï¼š 1var session: NFCNDEFReaderSession! æŽ¥ä¸‹æ¥,åœ¨ viewDidLoad() æ–¹æ³•ä¸­æ·»åŠ è¿™ä¸¤è¡Œä»£ç ï¼š 12session = NFCNDEFReaderSession(delegate: self, queue: DispatchQueue.main, invalidateAfterFirstRead: false)session.begin() ViewController çŽ°åœ¨è¿˜æ²¡æœ‰æ­£ç¡®åœ°éµå¾ª NFCNDEFReaderSessionDelegate åè®®ï¼Œä½ éœ€è¦ä¿®æ”¹ä½ çš„ç±»å®šä¹‰æ¥åŒ…å«å®ƒï¼š 1class ViewController: UIViewController, NFCNDEFReaderSessionDelegate &#123; æŒ‰ç…§æƒ¯ä¾‹ï¼ŒXcode å°†ä¼šæŠ¥ä½ ç¼ºå¤±ä¸€äº›å¿…è¦æ–¹æ³•çš„é”™ï¼Œæ‰€ä»¥ä½¿ç”¨å®ƒå»ºè®®çš„ä¿®å¤æ¥æ’å…¥ä¸‹é¢è¿™ä¸¤ä¸ªæ–¹æ³•ï¼š 1234567func readerSession(_ session: NFCNDEFReaderSession, didDetectNDEFs messages: [NFCNDEFMessage]) &#123; code&#125;func readerSession(_ session: NFCNDEFReaderSession, didInvalidateWithError error: Error) &#123; code&#125; ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç‰¹åˆ«ç®€å•çš„ï¼Œä½†æ˜¯é”™è¯¯çš„å¤„ç†ä¹Ÿéžå¸¸ç®€å•â€”â€”æˆ‘ä»¬åªæ˜¯æŠŠé”™è¯¯æ‰“å°åˆ° Xcode çš„æŽ§åˆ¶å°ã€‚åœ¨ didInvalidateWithError æ–¹æ³•å†…åƒè¿™æ ·æ·»åŠ å†…å®¹ï¼š 123func readerSession(_ session: NFCNDEFReaderSession, didInvalidateWithError error: Error) &#123; print(error.localizedDescription)&#125; çŽ°åœ¨å¯¹äºŽ didDetectNDEFs æ–¹æ³•ã€‚å½“å®ƒè¢«è°ƒç”¨çš„æ—¶å€™ä½ ä¼šå¾—åˆ°ä¸€ä¸ªæ£€æµ‹åˆ°çš„æ¶ˆæ¯çš„æ•°ç»„ï¼Œæ•°ç»„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥åŒ…å«æè¿°å•ä¸ªæ•°æ®çš„ä¸€ä¸ªæˆ–æ›´å¤šè®°å½•ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ° NFC è¢«ç”¨ä½œå¯åŠ¨ Google Cardboard app: Cardboard è®¾å¤‡æœ‰ä¸€ä¸ªç®€å•çš„åŒ…å«ç»å¯¹ URL â€œcardboard://V1.0.0â€ çš„ NFC æ ‡ç­¾ï¼Œå½“è®¾å¤‡æ£€æµ‹åˆ°æ ‡ç­¾åŽä¼šå”¤èµ· APP æ˜¾ç¤ºã€‚ ç”¨ NFC æ•°æ®çš„å¤„ç†å°±æ˜¯ä½ éœ€è¦åšçš„äº‹äº†ï¼Œæˆ‘ä»¬åªæ˜¯æŠŠä»–æ‰“å°å‡ºæ¥äº†ï¼ŒæŠŠä½ çš„ didDetectNDEFs ä¿®æ”¹æˆè¿™æ ·ï¼š 123456789func readerSession(_ session: NFCNDEFReaderSession, didDetectNDEFs messages: [NFCNDEFMessage]) &#123; for message in messages &#123; for record in message.records &#123; if let string = String(data: record.payload, encoding: .ascii) &#123; print(string) &#125; &#125; &#125;&#125; æ‰€æœ‰çš„ä»£ç å°±å®Œæˆäº†ï¼Œé‚£ä¹ˆç»§ç»­å¼€å§‹è¿è¡Œè¿™ä¸ª app å§ï¼å¦‚æžœæ‰€æœ‰çš„éƒ¨åˆ†éƒ½èµ·ä½œç”¨äº†ï¼Œä½ å°†ç«‹å³çœ‹åˆ°ç³»ç»Ÿç”¨æˆ·ç•Œé¢å‡ºçŽ°æç¤ºç”¨æˆ·å°†å…¶è®¾å¤‡é è¿‘è¦æ‰«æçš„ä½ç½®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ¶æ„åº”ç”¨ç¨‹åºæ»¥ç”¨ NFC æ‰«ææ˜¯ä¸å¯èƒ½çš„ - ä¸ä»…æˆ‘ä»¬æ— æ³•æŽ§åˆ¶ç”¨æˆ·ç•Œé¢ï¼Œè€Œä¸” 60 ç§’åŽæ‰«æä¹Ÿä¼šå› ä¸ºè¶…æ—¶ç»“æŸä»¥é¿å…æµªè´¹ç”µé‡ã€‚ æœºå™¨å­¦ä¹ å’Œè§†è§‰è¯†åˆ«æœºå™¨å­¦ä¹ æ˜¯çŽ°åœ¨æœ€æ—¶é«¦çš„æµè¡Œè¯­ï¼Œå°±æ˜¯è®©è®¡ç®—æœºæ ¹æ®è¿‡åŽ»æŽ¥è§¦åˆ°çš„å¤„ç†è§„åˆ™æ¥é€‚åº”æ–°çš„æ•°æ®ã€‚æ¯”å¦‚ï¼Œå¦‚æžœä½ åªæœ‰ä¸€å¼ å‰ä»–ç”»å’Œä¸€ä¸ªç©ºçš„ Swift ç±»ï¼Œé‚£ä¹ˆâ€è¿™å¹…ç”»ä¸­æœ‰å‰ä»–å—ï¼Ÿâ€œæ˜¯ä¸ªéžå¸¸éš¾å›žç­”çš„é—®é¢˜ï¼Œä½†æ˜¯å¦‚æžœä½ ä½¿ç”¨å¤§é‡åŒ…å«å‰ä»–çš„å›¾ç‰‡æ ·æœ¬æ¥æž„å»ºä¸€ä¸ªè®­ç»ƒæ¨¡åž‹ï¼Œè¿™æ—¶ä½ å°±å¯ä»¥æœ‰æ•ˆåœ°è®­ç»ƒè®¡ç®—æœºè¯†åˆ«å‡ºåŒ…å«å‰ä»–çš„æ–°å›¾åƒã€‚ å¬ä¸ŠåŽ»å¾ˆæ— èŠï¼Œä½†å®žé™…ä¸Šæ˜¯ iOS 11 ä¸Šå¤§é‡çš„å…ˆè¿›æŠ€æœ¯çš„åŸºç¡€ï¼šSiriï¼Œç…§ç›¸æœºï¼ŒQuick Type éƒ½ä½¿ç”¨äº†æœºå™¨å­¦ä¹ æ¥å¸®åŠ©å®ƒä»¬æ›´å¥½çš„ç†è§£æˆ‘ä»¬æ‰€åœ¨çš„ä¸–ç•Œã€‚iOS 11 è¿˜å¼•å…¥äº†ä¸€ä¸ªæ–°çš„ Vision æ¡†æž¶ï¼Œè¿™æ˜¯ä¸€ä¸ªä»Ž Core Image ï¼Œæœºå™¨å­¦ä¹ åŠŸèƒ½å’Œæ‰€æœ‰æ–°æŠ€æœ¯ç»„æˆçš„ä¸€ä¸ªæœ‰ç‚¹æ¨¡ç³Šçš„ç»„åˆã€‚ åœ¨ iOS 11 é‡Œæ‰€æœ‰çš„è¿™äº›éƒ½æ˜¯ç”±ä¸€ä¸ªå«åš Core ML çš„æœºå™¨å­¦ä¹ æ¡†æž¶æä¾›ï¼Œè¯¥æ¡†æž¶æ—¨åœ¨æ”¯æŒå„ç§å„æ ·çš„æ¨¡åž‹ï¼Œè€Œä¸ä»…ä»…æ˜¯è¯†åˆ«å›¾åƒã€‚ä¿¡ä¸ä¿¡ç”±ä½ ï¼Œç¼–å†™ Core ML çš„ä»£ç æ˜¯å¾ˆå°‘çš„ï¼Œç„¶è€Œè¿™åªæ˜¯äº‹æƒ…çš„ä¸€é¢ã€‚ ä½ æ¸…æ¥šçš„ï¼ŒCore ML éœ€è¦è®­ç»ƒæ¨¡åž‹æ‰èƒ½å·¥ä½œï¼Œè€Œæ¨¡åž‹æ˜¯ç”¨ç®—æ³•åœ¨å¤§é‡æ•°æ®è®­ç»ƒå¾—å‡ºçš„ã€‚è¿™äº›æ¨¡åž‹å¯ä»¥ä»Žå‡ åƒå­—èŠ‚åˆ°æ•°ç™¾å…†å­—èŠ‚ç”šè‡³æ›´å¤šï¼Œè€Œä¸”æ˜Žæ˜¾éœ€è¦ä¸€å®šçš„ä¸“ä¸šçŸ¥è¯†æ‰èƒ½è®­ç»ƒï¼Œç‰¹åˆ«æ˜¯å½“ä½ å¤„ç†å›¾åƒè¯†åˆ«çš„æ—¶å€™ã€‚ä»¤äººæ¬£å–œçš„æ˜¯ï¼Œè‹¹æžœæä¾›äº†ä¸€äº›å¯ä»¥ç”¨æ¥å¿«é€Ÿä¸Šæ‰‹å’Œè¿è¡Œçš„æ¨¡åž‹ï¼Œæ‰€ä»¥å¦‚æžœä½ åªæ˜¯æƒ³è¦å°è¯•ä¸‹ä½¿ç”¨ Core ML ï¼Œå®žé™…ä¸Šæ˜¯éžå¸¸ç®€å•çš„ã€‚ éš¾è¿‡çš„æ˜¯ï¼Œè¿˜æœ‰äº‹æƒ…è¿˜æœ‰å¦å¤–ä¸€é¢ï¼šç¬¬ä¸‰æ–¹æ¡†æž¶æ€»æ˜¯éžå¸¸æ¶å¿ƒçš„ï¼Œä½ æ˜Žç™½çš„ï¼ŒCore ML æ¨¡åž‹ä¸ºæˆ‘ä»¬è‡ªåŠ¨ç”ŸæˆæŽ¥æ”¶ä¸€äº›è¾“å…¥æ•°æ®å¹¶è¿”å›žä¸€äº›è¾“å‡ºæ•°æ®çš„ä»£ç  - è¿™éƒ¨åˆ†æ˜¯éžå¸¸å‹å¥½çš„ã€‚ä½†æ‚²ä¼¤çš„æ˜¯ï¼Œå¤„ç†å›¾åƒæ—¶æ‰€éœ€çš„è¾“å…¥æ•°æ®ä¸æ˜¯ â€œUIImageâ€ï¼Œä¹Ÿä¸æ˜¯ â€œCGImageâ€ï¼Œæ›´ä¸æ˜¯ â€œCIImageâ€ ã€‚ ç›¸åï¼Œè‹¹æžœé€‰æ‹©è®©æˆ‘ä»¬ä½¿ç”¨ â€œCVPixelBufferâ€ è¾“å…¥ã€‚CVPixelBuffer æ”¾è¿›æˆ‘çš„ä»£ç ä¸­å°±åƒè¡€å‹ç—…èšä¼šä¸Šæ¥äº†å¤´è±ªçŒªä¸€æ ·ä¸å—æ¬¢è¿Žã€‚æ²¡æœ‰æŠŠ UIImage è½¬æ¢ä¸º CVPixelBuffer çš„å®Œç¾Žæœ‰æ•ˆçš„æ–¹æ³•ï¼Œæˆ‘æ˜¯å¾ˆæœ‰èµ„æ ¼è¯´çš„ï¼Œå› ä¸ºæˆ‘æµªè´¹äº†å‡ ä¸ªå°æ—¶æ¥å¯»æ±‚è§£å†³æ–¹æ¡ˆã€‚å¹¸è¿çš„æ˜¯ Chris Cieslak éžå¸¸æ…·æ…¨æŠŠä»–çš„ä»£ç åˆ†äº«ç»™æˆ‘ï¼Œåœ¨ä»–çš„ WTFPL ä¸‹è½¬æ¢æ˜¯éžå¸¸æœ‰æ•ˆçš„ï¼Œæ‰€ä»¥ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒè¿›è¡Œè½¬æ¢ã€‚ çŽ°åœ¨è®©æˆ‘ä»¬å°è¯•ä¸‹ Core ML å§ã€‚å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„å•è§†å›¾ APP å·¥ç¨‹ï¼ˆæˆ–è€…ç»§ç»­ä½¿ç”¨ä½ çŽ°æœ‰çš„å·¥ç¨‹ï¼‰ï¼Œå†åœ¨å·¥ç¨‹é‡Œæ·»åŠ ä¸€å¼ å›¾ç‰‡ â€”â€” æˆ‘æ·»åŠ çš„æ˜¯ç»´åŸºç™¾ç§‘é‡Œçš„ åŽç››é¡¿æœå‹’æ–¯å›½é™…æœºåœº ã€‚æŠŠè¿™å¼ å›¾ç‰‡é‡å‘½åä¸º â€œtest.jpgâ€ ä»¥é¿å…æ‹¼å†™é”™è¯¯ã€‚ çŽ°åœ¨æˆ‘ä»¬æœ‰ä¸€äº›è¾“å…¥æµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªè®­ç»ƒå¥½çš„æ¨¡åž‹ã€‚å®ƒå¯èƒ½æ²¡æœ‰çœ‹åˆ°è¿‡æˆ‘ä»¬ç¡®åˆ‡çš„ç…§ç‰‡ï¼Œä½†å®ƒéœ€è¦æŽ¥è§¦äº›ç±»ä¼¼çš„å›¾ç‰‡ä»¥ä¾¿è¯†åˆ«å‡ºè¿™ä¸ªæœºåœºã€‚è‹¹æžœåœ¨ https://developer.apple.com/machine-learning ä¸Šæä¾›äº†ä¸€äº›é¢„é…ç½®çš„æ¨¡åž‹ â€”â€” çŽ°åœ¨è¿›å…¥ç½‘ç«™ï¼Œå¹¶ä¸‹è½½ â€œPlaces205-GoogLeNetâ€ æ¨¡åž‹ã€‚ æ¨¡åž‹åªæœ‰ 25MBï¼Œæ‰€ä»¥å®ƒä¸ä¼šå ç”¨ä½ ç”¨æˆ·è®¾å¤‡ä¸Šå¤ªå¤šç©ºé—´ã€‚ å½“ä½ ä¸‹è½½å¥½æ¨¡åž‹åŽï¼Œå…ˆæŠŠå®ƒæ‹–åˆ°ä½ çš„ Xcode å·¥ç¨‹ä¸­ï¼Œå†é€‰æ‹©å®ƒï¼Œè¿™æ—¶ä½ å°±å¯ä»¥çœ‹åˆ° Core ML çš„æ¨¡åž‹æŸ¥çœ‹å™¨ã€‚ä½ ä¼šçœ‹åˆ°å®ƒæ˜¯ç”± MIT åˆ¶ä½œçš„ç¥žç»ç½‘ç»œåˆ†ç±»å™¨ï¼Œè¿˜æœ‰å¯ä»¥æ ¹æ®çŸ¥è¯†å…±äº«è®¸å¯è¯ä½¿ç”¨ã€‚åœ¨è¿™ä¸ªä¸‹é¢ï¼Œä½ å°†çœ‹åˆ°å®ƒæœ‰ â€œsceneImageâ€ ä½œä¸ºè¾“å…¥ï¼Œè¿˜æœ‰ â€œsceneLabelProbs â€ å’Œ â€œsceneLabelâ€ ä½œä¸ºè¾“å‡º â€”â€” è¾“å…¥ä¸€å¼ å›¾ç‰‡ï¼Œè¾“å‡ºä¸€äº›è®¡ç®—æœºè¯†åˆ«è¿™å¼ å›¾ç‰‡çš„æ–‡æœ¬æè¿°ã€‚ ä½ è¿˜å°†çœ‹åˆ° â€œModel classâ€ å’Œ â€œSwift generated sourceâ€ â€”â€” Xcodeä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªç±»ï¼ŒåªåŒ…å«å‡ è¡Œä»£ç ï¼Œè¿™ä¸€ç‚¹éžå¸¸æ˜¾è‘—ï¼Œä½ å°†å¾ˆå¿«çœ‹åˆ°ã€‚ çŽ°åœ¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¯ä»¥è¯†åˆ«çš„å›¾åƒå’Œä¸€ä¸ªå¯ä»¥æ£€æŸ¥å®ƒçš„è®­ç»ƒå¥½çš„æ¨¡åž‹ã€‚ æˆ‘ä»¬çŽ°åœ¨éœ€è¦åšçš„æ˜¯å°†ä¸¤è€…æ”¾åœ¨ä¸€èµ·ï¼šåŠ è½½å›¾ç‰‡ï¼Œä¸ºæ¨¡åž‹å‡†å¤‡å›¾ç‰‡ï¼Œæœ€åŽè¯¢é—®æ¨¡åž‹çš„é¢„æµ‹ã€‚ ä¸ºäº†ä½¿è¿™ä¸ªä»£ç æ›´å®¹æ˜“ç†è§£ï¼Œæˆ‘æŠŠå®ƒåˆ†æˆäº†ä¸€äº›å—ã€‚ é¦–å…ˆï¼Œæ‰“å¼€ ViewController.swift å¹¶å°†å…¶ä¿®æ”¹ä¸ºï¼š 12345678910111213import UIKitclass ViewController: UIViewController &#123; override func viewDidLoad() &#123; super.viewDidLoad() let image = UIImage(named: "test.jpg")! // 1 // 2 // 3 &#125;&#125; è¿™åªæ˜¯åŠ è½½æˆ‘ä»¬å‡†å¤‡è¢«å¤„ç†çš„æµ‹è¯•å›¾ç‰‡ã€‚ æŽ¥ä¸‹æ¥çš„æ­¥éª¤æ˜¯ä»Ž â€œ// 1â€ å¼€å§‹é€ä¸ªå¡«å†™è¿™ä¸‰ä¸ªæ³¨é‡Šã€‚ åŸºäºŽå›¾åƒçš„ Core ML æ¨¡åž‹è¦æ±‚ä»¥ç²¾ç¡®çš„å°ºå¯¸æŽ¥æ”¶å›¾ç‰‡ï¼Œè¿™æ˜¯ä»–ä»¬æŽ¥å—è¿‡è®­ç»ƒçš„å°ºå¯¸ã€‚ å¯¹äºŽ GoogLeNetPlaces æ¨¡åž‹å°ºå¯¸åº”è¯¥æ˜¯ 224 x 224 è€Œå…¶ä»–æ¨¡åž‹æœ‰å®ƒä»¬å„è‡ªçš„å°ºå¯¸ï¼Œè€Œ Core ML ä¼šå‘Šè¯‰ä½ æ˜¯å¦ä»¥é”™è¯¯çš„å°ºå¯¸è¾“å…¥äº†ä¸œè¥¿ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ç¼©å°æˆ‘ä»¬çš„å›¾åƒï¼Œè®©å›¾ç‰‡æ°å¥½æ˜¯ 224 x 224 ï¼Œè€Œä¸ç®¡æˆ‘ä»¬æ˜¯ä½¿ç”¨è§†ç½‘è†œå±è®¾å¤‡è¿˜æ˜¯å…¶ä»–çš„è®¾å¤‡ã€‚ è¿™å¯ä»¥ä½¿ç”¨ â€œUIGraphicsBeginImageContextWithOptionsï¼ˆï¼‰â€ æ–¹æ³•æ¥å¼ºåˆ¶ 1.0 çš„æ¯”ä¾‹ã€‚ ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢è¿™ä¸ª // 1 æ³¨é‡Šï¼š 12345let modelSize = 224UIGraphicsBeginImageContextWithOptions(CGSize(width: modelSize, height: modelSize), true, 1.0)image.draw(in: CGRect(x: 0, y: 0, width: modelSize, height: modelSize))let newImage = UIGraphicsGetImageFromCurrentImageContext()!UIGraphicsEndImageContext() è¿™ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæ–°çš„å«åš â€œnewImageâ€ å¸¸é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªç¬¦åˆæ¨¡åž‹ä¸­æ­£ç¡®å°ºå¯¸çš„ â€œUIImageâ€ã€‚ çŽ°åœ¨ç¬¬äºŒéƒ¨åˆ†è¦åšçš„æ˜¯ä»Ž â€œUIImageâ€ åˆ° â€œCVPixelBufferâ€ ä¹‹é—´æ¶å¿ƒçš„è½¬æ¢ã€‚ å› ä¸ºè¿™æ˜¯æ¯«æ— æ„ä¹‰çš„å¤æ‚æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä¸æ‰“ç®—è¯•å›¾è§£é‡Šæ‰€æœ‰çš„å„ä¸ªæ­¥éª¤ã€‚é™¤äº†æ‹·è´ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä¸å»ºè®®ä½ åšä»»ä½•äº‹æƒ…ã€‚ ç”¨ä¸‹é¢çš„ä»£ç æ›¿æ¢è¿™ä¸ª // 2 æ³¨é‡Šï¼š 123456789101112131415161718let attrs = [kCVPixelBufferCGImageCompatibilityKey: kCFBooleanTrue, kCVPixelBufferCGBitmapContextCompatibilityKey: kCFBooleanTrue] as CFDictionaryvar pixelBuffer : CVPixelBuffer?let status = CVPixelBufferCreate(kCFAllocatorDefault, Int(newImage.size.width), Int(newImage.size.height), kCVPixelFormatType_32ARGB, attrs, &amp;pixelBuffer)guard (status == kCVReturnSuccess) else &#123; return &#125;CVPixelBufferLockBaseAddress(pixelBuffer!, CVPixelBufferLockFlags(rawValue: 0))let pixelData = CVPixelBufferGetBaseAddress(pixelBuffer!)let rgbColorSpace = CGColorSpaceCreateDeviceRGB()let context = CGContext(data: pixelData, width: Int(newImage.size.width), height: Int(newImage.size.height), bitsPerComponent: 8, bytesPerRow: CVPixelBufferGetBytesPerRow(pixelBuffer!), space: rgbColorSpace, bitmapInfo: CGImageAlphaInfo.noneSkipFirst.rawValue)context?.translateBy(x: 0, y: newImage.size.height)context?.scaleBy(x: 1.0, y: -1.0)UIGraphicsPushContext(context!)newImage.draw(in: CGRect(x: 0, y: 0, width: newImage.size.width, height: newImage.size.height))UIGraphicsPopContext()CVPixelBufferUnlockBaseAddress(pixelBuffer!, CVPixelBufferLockFlags(rawValue: 0)) å¦‚æžœå¯èƒ½ä½¿ç”¨å¾ˆå¤šæ¬¡ä¸Šé¢çš„ä»£ç ï¼Œä½ å¯èƒ½æƒ³è¦æŠŠè¿™äº›å¤æ‚ä»£ç å°è£…åˆ°ä¸€ä¸ªå‡½æ•°é‡Œè¾¹ã€‚ä½†æ— è®ºä½ å¦‚ä½•æ“ä½œï¼Œè¯·ä¸è¦è¯•å›¾åŽ»è®°ä½å®ƒã€‚ çŽ°åœ¨å¼€å§‹é‡è¦çš„ï¼Œæœ‰è¶£çš„å’Œå¾®ä¸è¶³é“çš„éƒ¨åˆ†ï¼šå®žé™…ä½¿ç”¨ Core ML æ¡†æž¶ï¼Œè¿™åªæœ‰ä¸‰è¡Œä»£ç ï¼Œç›¸å½“å¦çŽ‡åœ°è¯´ï¼Œéžå¸¸ç®€å•ã€‚ å°±åƒæˆ‘æ‰€è¯´çš„ï¼ŒXcode è‡ªåŠ¨æ ¹æ® Core ML æ¨¡åž‹ç”Ÿæˆä¸€ä¸ª Swift ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç«‹å³å®žä¾‹åŒ–ä¸€ä¸ª â€œGoogLeNetPlacesâ€ å¯¹è±¡ã€‚ æœ€åŽæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„å›¾ç‰‡ç¼“å­˜ä¼ é€’ç»™å®ƒçš„ â€œprediction()â€ æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†è¿”å›žé¢„æµ‹ç»“æžœæˆ–æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ åœ¨å®žè·µä¸­ï¼Œä½ å¯èƒ½ä¼šå‘çŽ°ä½¿ç”¨ `tryï¼Ÿâ€™ æ›´å®¹æ˜“èŽ·å¾—ä¸€ä¸ªå€¼æˆ–æ˜¯ nil ã€‚ æœ€åŽï¼Œæˆ‘ä»¬å°†æ‰“å°å‡ºé¢„æµ‹ç»“æžœï¼Œä»¥ä¾¿ä½ äº†è§£åˆ° Core ML çš„è¡¨çŽ°ã€‚ ç”¨ä¸‹é¢ä»£ç æ›¿æ¢æ›¿æ¢è¿™ä¸ª // 3 æ³¨é‡Šï¼š 123let model = GoogLeNetPlaces()guard let prediction = try? model.prediction(sceneImage: pixelBuffer!) else &#123; return &#125;print(prediction.sceneLabel) ä¸ç®¡ä½ ç›¸ä¸ç›¸ä¿¡ï¼Œè¿™å°±æ˜¯ä½¿ç”¨ Core ML çš„æ‰€æœ‰ä»£ç ï¼› è¿™ç®€å•çš„ä¸‰è¡Œä»£ç åšå®Œäº†æ‰€æœ‰çš„å·¥ä½œã€‚ ä½ æ‰“å°å‡ºæ¥çš„ç»“æžœå–å†³äºŽä½ çš„è¾“å…¥å†…å®¹å’Œä½ çš„è®­ç»ƒæ¨¡åž‹ï¼Œä½† GoogLeNetPlaces æ­£ç¡®åœ°å°†æˆ‘çš„å›¾ç‰‡è¯†åˆ«ä¸ºæœºåœºèˆªç«™æ¥¼ï¼Œè¿™ä¸€åˆ‡å®Œå…¨åœ¨è®¾å¤‡ä¸Šå®Œæˆ â€”â€” æ— éœ€å°†å›¾ç‰‡å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨å¤„ç†ï¼Œå› æ­¤åœ¨è¿™ä¸ªé»‘ç›’å­é‡Œä½ å¾—åˆ°äº†æžå¥½çš„éšç§ä¿æŠ¤ã€‚ æ›´å¤šå…¶ä»–çš„æ›´æ–°ã€‚ã€‚ã€‚iOS 11 è¿˜æœ‰å¤§é‡çš„å…¶ä»–æ›´æ–° â€”â€” è¿™äº›æ˜¯æˆ‘æœ€å–œæ¬¢çš„ï¼š Metal 2 è¢«è®¾ç½®æˆæé«˜æ•´ä¸ªç³»ç»Ÿçš„å›¾å½¢æ€§èƒ½ã€‚æˆ‘æ²¡åœ¨è¿™æä¾›ä»£ç ç¤ºä¾‹æ˜¯å› ä¸ºè¿™å®žåœ¨æ˜¯ä¸€ä¸ªé«˜æ·±çš„è¯é¢˜ â€”â€” å¤§å¤šæ•°äººåªä¼šå¾ˆé«˜å…´çœ‹åˆ°ä»–ä»¬çš„ SpriteKit ï¼ŒSceneKit å’Œ Unity åº”ç”¨ç¨‹åºæ— éœ€é¢å¤–çš„å·¥ä½œå°±å¯ä»¥èŽ·å¾—æ›´å¿«çš„é€Ÿåº¦ã€‚ TableView Cell çŽ°åœ¨è‡ªåŠ¨æ”¯æŒè‡ªé€‚åº”ã€‚ä»¥å‰éƒ½æ˜¯è®¾ç½® UITableViewAutomaticDimension ä½œä¸ºè¡Œé«˜æ¥è§¦å‘è‡ªé€‚åº”è¡Œä¸ºã€‚ä½†çŽ°åœ¨å†ä¹Ÿä¸éœ€è¦è®¾ç½®äº†ã€‚ TableView å¢žåŠ äº†ä¸€ä¸ª æ–°çš„åŸºäºŽé—­åŒ…çš„ performBatchUpdates() æ–¹æ³•ï¼Œå®ƒå¯ä»¥è®©ä½ ä¸€æ¬¡æ€§å¯¹å¤šè¡Œçš„æ’å…¥ã€åˆ é™¤ã€ç§»åŠ¨æ“ä½œè¿›è¡ŒåŠ¨ç”»å¤„ç†ï¼Œç”šè‡³å¯ä»¥åœ¨åŠ¨ç”»å®Œæˆä¹‹åŽç«‹å³æ‰§è¡Œç»“æŸé—­åŒ…ã€‚ åœ¨ Apple Music ç¬¬ä¸€æ¬¡å‡ºçŽ°çš„æ–°çš„åŠ ç²—é»‘æ ‡é¢˜çŽ°åœ¨å¯ä»¥å†æ•´ä¸ªç³»ç»Ÿä½¿ç”¨äº†ï¼ŒåŒæ—¶æ”¯æŒé€šè¿‡ä¸€ä¸ªç»†å°çš„æ”¹åŠ¨åœ¨æˆ‘ä»¬è‡ªå·±çš„ APP ä½¿ç”¨ï¼šåœ¨ IB å†…ä¸ºæˆ‘ä»¬çš„å¯¼èˆªæ¡é€‰æ‹© â€œPrefers Large Titlesâ€ ï¼Œæˆ–è€…å¦‚æžœä½ æ›´å–œæ¬¢ä½¿ç”¨ä»£ç çš„è¯ä½¿ç”¨ navigationController?.navigationBar.prefersLargeTitles = true æ¥è®¾ç½®ã€‚ ä¸ºäº†æ”¯æŒ safeAreaLayoutGuide topLayoutGuideå±žæ€§è¢«å¼ƒç”¨äº†ã€‚å®ƒæä¾›äº†æ‰€æœ‰è¾¹çš„è¾¹ç¼˜è€Œä¸ä»…ä»…æ˜¯é¡¶éƒ¨å’Œåº•éƒ¨ï¼Œè¿™å¯èƒ½é¢„ç¤ºæœªæ¥çš„ iPhone ä¸ºéžçŸ©å½¢å¸ƒå±€ â€”â€” å¸¦æœ‰æ²‰æµ¸å¼ç›¸æœºçš„å…¨å±å¹• iPhone 8ï¼Œæœ‰äººæœ‰å¼‚è®®å—ï¼Ÿ Stack views å¢žåŠ äº†ä¸€ä¸ª setCustomSpacing(_:after:) æ–¹æ³•ï¼Œè¿™å¯ä»¥è®©ä½ åœ¨ stack view æ·»åŠ ä½ æƒ³è¦çš„è€Œä¸æ˜¯ç»Ÿä¸€å¤§å°çš„ç©ºç™½ã€‚ æŽ¥ä¸‹æ¥å°±æ˜¯ XcodeXcode 9 æ˜¯æˆ‘è§è¿‡çš„æœ€ä»¤äººå…´å¥‹çš„ Xcode ç‰ˆæœ¬ â€”â€” å®ƒå……æ»¡äº†ä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ–°åŠŸèƒ½ï¼Œç”šè‡³å¯ä»¥ä½¿æœ€åšå®šçš„ Xcode æŠ±æ€¨è€…é‡æ–°è€ƒè™‘ã€‚ è¿™äº›æ˜¯æœ€å¸å¼•æˆ‘çš„åŠŸèƒ½æ›´æ–°ï¼š å¯ä»¥åœ¨ç¼–è¾‘å™¨å†…è¿›è¡Œ Swift å’Œ Objective-C çš„é‡æž„ï¼Œè¿™æ„å‘³ç€ä½ åªéœ€ç‚¹å‡»å‡ ä¸‹é¼ æ ‡å°±å¯ä»¥å¯¹ä½ çš„ä»£ç è¿›è¡Œå½»åº•çš„æ›´æ”¹ï¼ˆä¾‹å¦‚å¯¹æ–¹æ³•é‡å‘½åï¼‰ã€‚ iOS å’Œ tvOS æ”¯æŒæ— çº¿è°ƒè¯•äº†ã€‚ä¸ºäº†ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå…ˆä½¿ç”¨ USB è¿žæŽ¥ä½ çš„è®¾å¤‡ï¼Œå†åœ¨ Window èœå•é‡Œé€‰æ‹© Devices and Simulators ã€‚é€‰æ‹©ä½ çš„è®¾å¤‡ï¼Œæœ€åŽé€‰æ‹© â€œConnect via networkâ€ ã€‚å¦‚æžœç¬¬ä¸€æ¬¡ä¸èƒ½æˆåŠŸ ä¸å¿…æ„Ÿåˆ°æƒŠå¥‡ â€”â€” è¿™è¿˜æ˜¯ beta 1 ç‰ˆæœ¬ï¼ æºä»£ç ç¼–è¾‘å™¨ä½¿ç”¨ Swift è¿›è¡Œäº†é‡å†™ï¼Œå¸¦æ¥äº†æ»šåŠ¨å’Œæœç´¢çš„é€Ÿåº¦æžå¤§çš„æå‡ã€‚ä»¥åŠä¸€äº›å…¶ä»–æœ‰ç”¨çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æŒ‰ä½ Ctrl é”®æ—¶çš„èŒƒå›´é«˜äº®æ˜¾ç¤ºã€‚ ä½ çŽ°åœ¨å¯ä»¥å°†å‘½åé¢œè‰²æ·»åŠ åˆ° asset catalogsï¼Œè¿™æ ·ä½ å¯ä»¥å®šä¹‰ä¸€æ¬¡é¢œè‰²ï¼Œ åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨ UIColor(named:) æ–¹æ³•åˆå§‹åŒ–ã€‚ é»˜è®¤æƒ…å†µä¸‹å¯ç”¨äº†ä¸€ä¸ªæ–°çš„ä¸»çº¿ç¨‹æ£€æŸ¥å™¨ï¼Œå½“æ£€æµ‹åˆ°ä»»ä½•ä¸åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œçš„ UIKit æ–¹æ³•è°ƒç”¨æ—¶ï¼Œå®ƒå°†è‡ªåŠ¨å‘å‡ºè­¦å‘Š - è¿™æ˜¯å¸¸è§çš„é”™è¯¯æºå¤´ã€‚ ä½ çŽ°åœ¨å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªæ¨¡æ‹Ÿå™¨ï¼Œç”šè‡³å¯ä»¥è‡ªç”±è°ƒæ•´å®ƒä»¬çš„å¤§å°ã€‚ è‹¹æžœåœ¨æ¨¡æ‹Ÿå™¨å‘¨å›´æ·»åŠ äº†é¢å¤–çš„ç”¨æˆ·ç•Œé¢ï¼Œä»¥ä¾¿æˆ‘ä»¬è®¿é—®ç¡¬ä»¶æŽ§ä»¶ã€‚ å¦‚æžœæ‚¨ä¸æƒ³ç«‹å³ä½¿ç”¨ Swift 4ï¼Œåˆ™ä¼šæœ‰ä¸€ä¸ªæ–°çš„ â€œSwift Language Versionâ€ æž„å»ºè®¾ç½®ï¼Œæ‚¨å¯ä»¥é€‰æ‹© Swift 4.0 æˆ– Swift 3.2ã€‚ ä¸¤è€…éƒ½ä½¿ç”¨ç›¸åŒçš„ç¼–è¯‘å™¨ï¼Œä½†åœ¨å†…éƒ¨å¯ç”¨ä¸åŒçš„é€‰é¡¹ è®¤çœŸçš„ï¼Œæˆ‘å¸Œæœ›æˆ‘ä»Šå¹´åœ¨ WWDC çŽ°åœºï¼Œè¿™æ ·æˆ‘å°±ç»™ Xcode å·¥ç¨‹å¸ˆä¸€ä¸ªç†ŠæŠ± â€”â€” è¿™æ˜¯ä¸€ä¸ªç‚™æ‰‹å¯çƒ­çš„ç‰ˆæœ¬ï¼Œè®© Xcode åœ¨å¥”å‘ä¼Ÿå¤§çš„è·¯ä¸Šè¶Šè¡Œè¶Šè¿œã€‚ è¿˜åœ¨ç­‰ä»€ä¹ˆï¼ŸçŽ°åœ¨ä½ å·²ç»äº†è§£äº† iOS 11 ä¸­çš„æ–°åŠŸèƒ½ï¼Œä½ ä¹Ÿåº”è¯¥çœ‹ä¸€çœ‹æˆ‘çš„æ–°ä¹¦ï¼šPractical iOS 11ã€‚è¿™æ˜¯ä¸€æœ¬ç”¨å®žé™…é¡¹ç›®è®²è§£ iOS 11 ä¸­æ‰€æœ‰ä¸»è¦å˜åŒ–çš„ä¹¦ç±ï¼Œæ‹¥æœ‰å®ƒä½ å¯ä»¥å°½å¯èƒ½å¿«åœ°ç†Ÿæ‚‰ iOS 11ã€‚ Buy Practical iOS 11 for $30 è¯‘æ–‡å‡ºè‡ªï¼šæŽ˜é‡‘ç¿»è¯‘è®¡åˆ’ è¯‘è€…ï¼š Swants æ ¡å¯¹è€…ï¼š Danny1451 RichardLeeH]]></content>
      <tags>
        <tag>iOS 11</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é¿å…ä½¿ç”¨ç¬¬ä¸‰æ–¹UIåº“]]></title>
    <url>%2F2017%2F06%2F15%2F%E9%81%BF%E5%85%8D%E4%BD%BF%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9UI%E5%BA%93.html</url>
    <content type="text"><![CDATA[æœ€è¿‘ iOS ç¤¾åŒºä¸€äº›äººåœ¨è®¨è®ºå…³äºŽåº”è¯¥ èµžæˆè¿˜æ˜¯åå¯¹ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¾èµ–åº“ (å½“ç„¶, å¤§éƒ¨åˆ†äººæŒåå¯¹æ„è§). æˆ‘çœ‹åˆ°çš„è®¸å¤šäº‰è®ºçš„è§‚ç‚¹éƒ½æœ‰å¤±åé¢‡ -å®ƒä»¬æŠŠæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“éƒ½å½’äºŽä¸€ç±»æ··ä¸ºä¸€è°ˆ. å°±åƒå¤§å¤šæ•°äº‹æƒ…ä¸€æ ·,æ•´ä½“è€ƒè™‘ä¸æ˜¯é‚£ä¹ˆç®€å•çš„çš„äº‹,æ‰€ä»¥çŽ°åœ¨è®©æˆ‘ä»¬å°†ç›®å…‰æ”¾åœ¨ä¸€ä¸ªå°çš„è§‚ç‚¹ä¸Š: æˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨ ç¬¬ä¸‰æ–¹UIä¾èµ–åº“å—? è€ƒè™‘ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“çš„ç¼˜ç”±å¼€å‘è€…ä»¬è€ƒè™‘ä½¿ç”¨ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“é€šå¸¸æœ‰ä¸¤ä¸ªä¸»è¦åŽŸå› : ç¼ºä¹æŠ€èƒ½æˆ–è€…çŸ¥è¯†ã€‚ æ¯”æ–¹è¯´,ä½ æ­£åœ¨åšä¸€æ¬¾ç…§ç‰‡åˆ†äº«åŠŸèƒ½çš„ app. ä½ æ²¡æœ‰ä»Ž æŽ¨å‡ºè‡ªå·±çš„å¯†ç  å¼€å§‹ã€‚ ç¼ºä¹ä»Žäº‹æŸä»¶äº‹çš„æ—¶é—´æˆ–è€…å…´è¶£ã€‚ é™¤éžä½ åˆæ— é™çš„æ—¶é—´ä¸éœ€è¦åŽ»åˆ†æ¸…ä¸»æ¬¡ã€‚ å¤§éƒ¨åˆ†çš„ UI åº“(ä¸æ˜¯æ‰€æœ‰çš„!)éƒ½è¶‹å‘äºŽç¬¬äºŒä¸ªåŽŸå› .è¿™ä¸ªäº‹å„¿ä¸æ˜¯é«˜æ·±çš„äº‹,ä½†æ˜¯æŠŠå®ƒåšå¥½å´éœ€è¦èŠ±è´¹æ—¶é—´. ä»€ä¹ˆåº”è¯¥â€å¤–åŒ…â€é‚£ä¹ˆ,æˆ‘ä»¬é€šå¸¸åº”è¯¥æ€Žä¹ˆå†³å®šä»€ä¹ˆä»£ç åº”è¯¥æˆ‘ä»¬è‡ªå·±å†™,ä»€ä¹ˆåº”è¯¥äº¤ç»™ç¬¬ä¸‰æ–¹ç»„ä»¶å‘¢? è‘—åçš„ä¹”å°”å»ºè®®æä¾›äº†éžå¸¸å¥½çš„ä¾æ®: å¦‚æžœæ˜¯æ ¸å¿ƒå•†ä¸šåŠŸèƒ½çš„è¯ å°±è‡ªå·±åš ä¸ç®¡å®ƒæ˜¯ä»€ä¹ˆã€‚ ä¸€ä¸ªäº‹å®ž(å¹¶ä¸”æ¯”è¾ƒæ®‹é…·çš„)æ˜¯å‡ ä¹Žæ‰€æœ‰çš„ iOS app æ­£åœ¨å‘å‰ç«¯è€Œä¸æ˜¯åŽç«¯å‘å±•ã€‚,å› æ­¤æˆ‘ä»¬åº”è¯¥è€ƒè™‘åœ¨å†…éƒ¨å°½å¯èƒ½å¤šåœ°è¿›è¡Œ UI å¼€å‘ çœ‹èµ·æ¥å°±å°¤ä¸ºé‡è¦ã€‚ æœ‰äººå¯èƒ½ä¼šè¯´è¿™åªæ˜¯ä¸ªäººè§‚ç‚¹,æ‰€ä»¥è®©æˆ‘ä»¬é‡æ–°æ€è€ƒä½ æ˜¯å¯¹ç¬¬ä¸‰æ–¹ UI åº“ä½¿ç”¨çš„æ›´è¯¦ç»†åŽŸå› ã€‚ UIåº“è‡ªèº«çš„é—®é¢˜é€šç”¨ vs ç‰¹å®šæœ‰ä¸¤ç§ç±»åž‹çš„æŽ§ä»¶/è§†å›¾: é€šç”¨ å…è®¸ä½ åœ¨å¾ˆå¤šåœºæ™¯ ç”šè‡³æ˜¯æˆ‘ä»¬æƒ³ä¸åˆ°çš„åœºæ™¯ä¸‹ä½¿ç”¨ æ¯”å¦‚ UIKit ä¸­çš„ UICollectionView . ç‰¹å®š ä¸“é—¨ä¸ºä¸€äº›ç‰¹å®šçš„åœºæ™¯è®¾è®¡ æ¯”å¦‚ UIPickerView å¤§éƒ¨åˆ†ç¬¬ä¸‰æ–¹åº“å€¾å‘äºŽç¬¬äºŒä¸ªåˆ†ç±».è€Œä¸”å®ƒä»¬é€šå¸¸æ˜¯åœ¨ä¸€ä¸ªå·²å­˜åœ¨å¹¶ä¸”åœ¨ä¸æ–­ä¼˜åŒ–çš„ä»£ç åº“ä¸­å–å‡º.æ¯”å¦‚,è¿˜è®°å¾—ä¸Šä¸ªæœˆçœ‹åˆ°çš„é‚£ä¸ªçœ‹èµ·æ¥éžå¸¸é…·çš„ä¸‹æ‹‰åˆ·æ–°åº“å—?å¦‚æžœä¸ä¿®æ”¹æŽ§åˆ¶å™¨äº¤äº’æˆ–ä¸‹æ‹‰åç§»é‡çš„è¯,å®ƒå¯èƒ½ä¸å¤ªé€‚åˆä½  app çš„è®¾è®¡æˆ–ä½¿ç”¨åœºæ™¯. ä½¿ç”¨ç»§æ‰¿è¿›è¡Œä¸ªæ€§åŒ–å°±é¢å‘å¯¹è±¡è€Œè¨€,ç”±å­ç±»åŒ–è½¬å‘ç»„ä»¶åŒ–æ˜¯è¡Œä¸šè¶‹åŠ¿.å½“ä½ é€‰æ‹©ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™è¯·ç¡®ä¿æ²¡æœ‰è¿èƒŒè¿™ä¸ªè¶‹åŠ¿.åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ ä½ å¯ä»¥é€‰æ‹©å…¶ä»–äººåšçš„ä¸€ä¸ªç»„ä»¶,ä½ åªéœ€è¦ç»§æ‰¿æˆ–è€…ç›´æŽ¥ä¿®æ”¹ä»£ç å°±å¥½äº†.(ä»£ç†æ¨¡å¼ä¹Ÿæ˜¯æŽ¥è¿‘ç»„ä»¶åŒ–çš„æ–¹æ³•ä¹‹ä¸€.) çœ‹èµ·æ¥è¿‡äºŽå®šåˆ¶åŒ– ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“å†…å¯è§çš„ UI å…ƒç´ è¶Šå°‘è¶Šå¥½,è¿™å¬èµ·æ¥å¯èƒ½è§‰å¾—æœ‰æ‚–å¸¸ç†.é«˜åº¦å®šåˆ¶åŒ–çš„æŽ§ä»¶æˆ–ç•Œé¢å¸¦æ¥çš„é—®é¢˜å°±æ˜¯å®ƒä¸å¯èƒ½æ»¡è¶³æ‰€æœ‰çš„çš„éœ€æ±‚æ¥è¿Žåˆæ‰€æœ‰çš„ä½¿ç”¨æƒ…æ™¯. å¦‚æžœæœ‰å¤§é‡çš„è‡ªå®šä¹‰ UI ,ä½ å¯èƒ½æ— æ³•å›žé¦ˆä¸Šæ¸¸,å› ä¸ºä½ å¯¹äºŽå¤–è§‚æˆ–æ„Ÿè§‰çš„æƒ³æ³•å¯èƒ½å’Œåº“çš„ç»´æŠ¤è€…ä¸ä¸€æ ·.è¿™ä¸ªæ—¶å€™ä½ ä¼šè‡ªå·±ç»´æŠ¤ä¸€ä¸ªåº“çš„forkä»£ç .æˆ–è€…åœ¨ app å†…æ·»åŠ ä¸€ä¸ªä¸‘é™‹çš„é®ç›– ä»…ä»…æ˜¯ä¸ºäº†ç§»é™¤ä¸€æ¡é˜´å½±.è€Œåœ¨å¦ä¸€æ–¹é¢,ä¸€äº›åº“åœ¨UIå±‚è¿›è¡Œæ“ä½œ ä½†æ˜¯æ²¡æœ‰æˆ–è€…å‡ ä¹Žæ²¡æœ‰æä¾›ä»»ä½•æ ·å¼.æƒ³ä¸€æƒ³ SDWebImage æˆ–è€…æˆ‘çš„ SloppySwiper . å®ƒä»¬éƒ½å¯ä»¥ä¸éœ€è¦ä»»ä½•ä¿®æ”¹ç›´æŽ¥æ”¾è¿›ä½ çš„å·¥ç¨‹å†…. æœªçŸ¥çš„æ—©æœŸé¢„è®¾å¾ˆå¤šå›¢é˜Ÿéƒ½ä¼šå¯¹å†…éƒ¨ä»£ç è¿›è¡Œä»£ç å®¡æŸ¥, ä½†å¯èƒ½å°†ç¬¬ä¸‰æ–¹æºä»£ç çš„è´¨é‡è§†ä¸ºç†æ‰€å½“ç„¶ã€‚èŠ±è´¹ç‚¹æ—¶é—´åŽ»æµè§ˆç¬¬ä¸‰æ–¹åº“çš„æºä»£ç æ˜¯å€¼å¾—çš„.ä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€å †è­¦å‘Š æ¯”å¦‚åœ¨ä¸éœ€è¦çš„åœ°æ–¹ä½¿ç”¨æ–¹æ³•å®žçŽ°äº¤æ¢. å°è¯•ç€åŽ»äº†è§£ä¸‹åº“çš„ç»“æž„,ä½ èƒ½å¦æ ¹æ®æœªæ¥çš„éœ€æ±‚å°è¯•ç€åŽ»è°ƒæ•´åº“,æˆ–è€…å½“ MVP çš„æ—¶å€™åŽé‡å†™åº“å—? ä½ ä¹Ÿåº”è¯¥è€ƒè™‘ä¸‹åº“çš„ç»´æŠ¤æƒ…å†µ,æœ€è¿‘æœ‰å¤šå°‘æ¬¡æäº¤,å¤šå°‘ä¸ªé—®é¢˜ æ˜¯å¦åšè¿‡ä»»ä½•çš„å•å…ƒæµ‹è¯•æˆ–è€… UIæµ‹è¯•? å¿½ç•¥ GitHub çš„æ˜Ÿæ•°,å°½ç®¡å®ƒæœ‰æ—¶æ˜¯å¾ˆæœ‰æ„ä¹‰çš„. æƒ³æ³• &gt; ä»£ç  ?æˆ‘å–œæ¬¢å¼€æºå› ä¸ºå¼€æºå…è®¸æˆ‘åŽ»äº†è§£åˆ«äººæ˜¯æ€Žä¹ˆæ€è€ƒçš„,æ˜¯æ€Žä¹ˆè®¾è®¡ä»–ä»¬çš„æ–¹æ¡ˆçš„. é€šå¸¸å­¦ä¹ è¿™ä¸ªæƒ³æ³•æ¯”èŽ·å¾—è¿™ä¸ªä»£ç æœ¬èº«æ›´æœ‰æ„ä¹‰. å¦‚æžœä¸€ä¸ªåº“æŽ¥è§¦åˆ°äº† UI å¹¶ä¸”å¾ˆå°,é€šå¸¸ä»Žä»£ç ä¸­èŽ·å–çµæ„Ÿå¹¶ä¸”å¼€å‘ä¸€ä¸ªç»„ä»¶æ¥å®Œç¾Žé€‚åº”ä½ çš„å·¥ç¨‹æ˜¯æ›´æ˜Žæ™ºçš„åšæ³•. ä¸èƒ½å¿½ç•¥å®ƒç”±äºŽ UIKit çš„è®¾è®¡æ–¹å¼,ä½ å¯èƒ½å‡ ä¹Žä¸èƒ½å¤Ÿå¿½ç•¥æŽ‰ç¬¬ä¸‰æ–¹ UI åº“,æ¯”å¦‚ åœ¨ä¸€ä¸ªé€‚é…å™¨åŽé¢,ä¸€ä¸ªåº“å°†ä¼šå’Œä½ çš„ UI ä»£ç äº¤å‰åœ¨ä¸€èµ·,äº‹å®žä¸Šå·²ç»å˜æˆäº†ä½ å·¥ç¨‹é‡Œä¸€ç­‰å…¬æ°‘. æœªæ¥æ—¶é—´èŠ±è´¹UIKit ä¼šéšç€æ¯ä¸ª iOS ç‰ˆæœ¬è¿›è¡Œå˜åŒ–,è¿™æ—¶å€™å°±ç³Ÿäº†,ä½ çš„ç¬¬ä¸‰æ–¹ä¾èµ–å¹¶ä¸ä¼šåƒä½ æƒ³è±¡çš„é‚£æ ·å…äºŽç»´æŠ¤. ##ç»“è®ºåœ¨ç¼–ç¨‹ä¸­ç»å¸¸ä¼šå‡ºçŽ°è¿™ç§æƒ…å†µ,å¾ˆéš¾æä¾›ä¸€èˆ¬è§„åˆ™,æˆ‘ä»¬å¿…é¡»åœ¨ä»£ç åº“æ·»åŠ æ¯ä¸€è¡Œä»£ç çš„æ—¶å€™éƒ½è¦è€ƒè™‘ä¸€æ¡åˆä¸€æ¡çš„è§„åˆ™.æ ¹æ®æˆ‘çš„ä¸ªäººç»éªŒ,ä½¿ç”¨å¤§å¤šæ•°ç¬¬ä¸‰æ–¹UIåº“éƒ½æ˜¯é€šè¿‡ç‰ºç‰²çµæ´»æ€§æ¥èŠ‚çœä¸€äº›æ—¶é—´. æˆ‘ä»¬åˆ©ç”¨çŽ°æˆçš„ä»£ç æ¥æ›´å¿«åœ°å®žçŽ°éœ€æ±‚,ä½†æ˜¯è¿Ÿæ—©,æˆ‘ä»¬å°†ä¼šè¢«ç¬¬ä¸‰æ–¹åº“æ‰€é™åˆ¶ å¹¶ä½œå‡ºè‰°éš¾çš„å†³å®š:è€ƒè™‘æŽ¥ä¸‹æ¥æ€Žä¹ˆåŠž? åŽŸæ–‡åœ°å€: http://holko.pl/2017/05/31/avoiding-ui-libraries/ç¿»è¯‘: Swants]]></content>
  </entry>
  <entry>
    <title><![CDATA[iOS APP å´©æºƒæ—¥å¿—åˆ†æž]]></title>
    <url>%2F2017%2F05%2F11%2FiOS-APP-%E5%B4%A9%E6%BA%83%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90.html</url>
    <content type="text"><![CDATA[åœ¨æ—¥å¸¸å¼€å‘ä¸­,æˆ‘ä»¬éš¾å…é‡åˆ°å´©æºƒ.å¦‚æžœæ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æŽ¥é€šè¿‡ Xcode æ¥æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ã€‚å¦‚æžœæ˜¯åœ¨æµ‹è¯•çš„æ—¶å€™å´©æºƒï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è½»æ˜“çš„é€šè¿‡æµ‹è¯•æœºå¯¼å‡º crash è¿›è¡Œé—®é¢˜å®šä½ã€‚ å¯æ˜¯ä¸€æ—¦å½“äº§å“ä¸Šçº¿ä¹‹åŽï¼Œè¿™ä¸€åˆ‡å°±å˜å¾—ä¸é‚£ä¹ˆå®¹æ˜“äº†ã€‚åº†å¹¸çš„æ˜¯å¸‚åœºä¸Šå·²ç»å‡ºçŽ°äº†ä¸€äº›æ¯”è¾ƒå¥½çš„ç¬¬ä¸‰æ–¹ crash ç»Ÿè®¡æœåŠ¡æ¯”å¦‚ buglyã€‚ å¯ä»¥è®©æˆ‘è½»æ¾äº†è§£åˆ°crashæ—¶çš„å †æ ˆä¿¡æ¯ã€‚ ä½†æ˜¯buglyä¹Ÿæœ‰ç¬¦å·åŒ–ä¸åˆ°ä½çš„æƒ…å†µï¼Œ æ¯”å¦‚: é‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬åº”è¯¥æ€Žä¹ˆåŠžå‘¢? å´©æºƒæ—¥å¿—ç¬¦å·åŒ–ä½¿ç”¨xcodeç¬¦å·åŒ– æ¡ä»¶: (éœ€è¦å´©æºƒæ‰‹æœº) å¦‚æžœå‘ç”Ÿå´©æºƒçš„æ‰‹æœºåœ¨æ‰‹è¾¹.å¯ä»¥è¿žä¸Šç”µè„‘ åœ¨ Xcode ä¸­çš„ organizer&gt;device ä¸­ç›´æŽ¥æŸ¥çœ‹ç¬¦å·åŒ–å¥½çš„æ—¥å¿—.ä¼˜ç‚¹: æ“ä½œç®€å•ç¼ºç‚¹: å¦‚æžœå´©æºƒæ—¥å¿—è¾ƒå¤š è¿˜éœ€è¦å´©æºƒæ—¶é—´æ‰èƒ½ç¡®å®šæ˜¯å“ªä¸ªcrashæ–‡ä»¶. crashä¸å¥½ç»Ÿè®¡ ä½¿ç”¨symbolicatecrashç¬¦å·åŒ–æ¡ä»¶: crashæ–‡ä»¶ dsYM æ–‡ä»¶ symbolicatecrashsymbolicatecrash ä½ç½® 1(/Applications/Xcode.app/Contents/SharedFrameworks/DVTFoundation.framework/Versions/A/Resources/symbolicatecrash) æ–¹æ³•: å°†ä¸‰ä¸ªæ–‡ä»¶æ”¾åœ¨åŒçº§ä¸‹ ç„¶åŽæ‰“å¼€ç»ˆç«¯ è¿›å…¥æ–‡ä»¶å¤¹ç›®å½•ä¸‹ è®¾ç½®çŽ¯å¢ƒå˜é‡ 1export DEVELOPER_DIR=/Applications/Xcode.app/Contents/Developer ç¬¦å·åŒ– 12 ### symbol.crash å°±æ˜¯æœ€åŽç¬¦å·åŒ–å¥½çš„æ–‡ä»¶ ###../symbolicatecrash ../.crash ../.dsym &gt; ../symbol.crash ä¼˜ç‚¹:æ“ä½œç®€å•ç¼ºç‚¹:é€‚åˆé’ˆå¯¹å•ä¸ªcrash æ–‡ä»¶ç¬¦å·åŒ– ä½¿ç”¨ atos å‘½ä»¤ç¬¦å·åŒ–æ¡ä»¶: dSYM å’Œå †æ ˆä¿¡æ¯ä½¿ç”¨ grep å‘½ä»¤ èŽ·å–è¯¥æ¨¡å—çš„ æŒ‡ä»¤é›†å’ŒåŠ è½½èµ·å§‹åœ°å€ 1grep "name armv" ../*.crash ç„¶åŽç”¨èŽ·å¾—çš„æŒ‡ä»¤é›†(armv7) å’Œèµ·å§‹åœ°å€(0x4000) æ¥ç¬¦å·åŒ– 12345xcrun atos -o ../.dsYM/../name -l 0x4000(èµ·å§‹åœ°å€) -arch -armv7(æŒ‡ä»¤é›†) //è¾“å…¥ç›®æ ‡åœ°å€ 0x00352aee //å¾—åˆ°ç»“æžœ -[UIScrollView(UITouch) touchesEnded:withEvent:] (in appName) (UIScrollView+UITouch.h:26) æ³¨æ„ æ¨¡å—åªèƒ½å®šä½åˆ°æœ¬æ¨¡å—çš„ä½ç½® ä¸èƒ½è¶Šå±‚ å¦‚:AFN.framework.dSYM åªèƒ½å®šä½åˆ°AFNå†…çš„ç›®æ ‡åœ°å€ä½ç½®appName.app.dSYM åªèƒ½å®šä½åˆ°appå†…ä»£ç çš„åœ°å€ä½ç½® ä¼˜ç‚¹: åªéœ€è¦å †æ ˆä¿¡æ¯ å’Œç¬¦å·è¡¨å°±å¯ä»¥. å¯ä»¥åœ¨èŽ·å–ä¸åˆ°Crashæ–‡ä»¶ ä½†åœ¨buglyç­‰ç¬¬ä¸‰æ–¹ç»Ÿè®¡ä¸­èŽ·å¾—äº†å †æ ˆä¿¡æ¯çš„æƒ…å†µä¸‹ä½¿ç”¨.ç¼ºç‚¹: ä¸€æ¬¡åªèƒ½ç¬¦å·åŒ–ä¸€è¡Œ,æ¯”è¾ƒç¹ç.(å¯ä»¥ä½œä¸ºbuglyç¬¦å·åŒ–ä¸å®Œå…¨æƒ…å†µä¸‹çš„è¡¥å…….) æœ‰å…´è¶£çš„å¯ä»¥å®žé™…åŠ¨æ‰‹æ“ä½œä¸‹:Xcode è‡ªå¸¦ atos è„šæœ¬: symbolicatecrash ä¸‹è½½crash æ–‡ä»¶ : demoAPP.crash ä¸‹è½½ç¬¦å·è¡¨: demoAPP.app.dSYM ä¸‹è½½ç¬¬ä¸‰æ–¹æ¨¡å—ç¬¦å·è¡¨ RBPlayer.framework.dSYM ä¸‹è½½ crashæ–‡ä»¶ç»„æˆåˆ†æžè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€ä¸ªå®žé™…çš„ crash æ–‡ä»¶ç»„æˆ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126### 1.è¿›ç¨‹ä¿¡æ¯ ###Incident Identifier: CDDADF33-6F8A-44B3-90D1-52D9095ADA0CCrashReporter Key: ed6929203307e230288ce2a758bd7099d3a52e15Hardware Model: iPhone5,2Process: demoApp [9806]Path: /private/var/containers/Bundle/Application/0C5CCF0C-6A7F-4864-BD5A-0765725E0CCB/demoApp.app/demoAppIdentifier: com.yimiao100.demoAppVersion: 6 (1.6)Code Type: ARM (Native)Role: ForegroundParent Process: launchd [1]Coalition: com.yimiao100.demoApp [3588]### 2.åŸºæœ¬ä¿¡æ¯ ###Date/Time: 2017-05-10 10:37:51.2003 +0800Launch Time: 2017-05-10 10:36:26.0000 +0800OS Version: iPhone OS 10.3.1 (14E304)Report Version: 104### 3.å¼‚å¸¸ä¿¡æ¯ ###Exception Type: EXC_CRASH (SIGABRT)Exception Codes: 0x0000000000000000, 0x0000000000000000Exception Note: EXC_CORPSE_NOTIFYTriggered by Thread: 0Application Specific Information:abort() calledFiltered syslog:None foundLast Exception Backtrace:(0x1ceefb38 0x1c177062 0x1ceefa80 0x1fd6f826 0x1fd6f9de 0x1fd70044 0x148a244 0x14813e4 0x1ce9bdb4 0x1ce9b6f4 0x1ce9b4dc 0x1cef6304 0x1cdff030 0x1d74c0a8 0x1d750b26 0x147f440 0x237bff76 0x237c0622 0x237c1644 0x1c5bd792 0x1c5bd77e 0x1c5c1d00 0x1ceabd64 0x1cea9e14 0x1cdfd0ea 0x1cdfcf0c 0x1e5a7b3c 0x22181e7e 0x10b2a8 0x1c5ea4e6)### 4.çº¿ç¨‹å›žæº¯ ###Thread 0 name: Dispatch queue: com.apple.main-thread### Crashè°ƒç”¨å †æ ˆ ###Thread 0 Crashed:0 libsystem_kernel.dylib 0x1c6bdacc 0x1c6a8000 + 887801 libsystem_pthread.dylib 0x1c7760f6 0x1c771000 + 207262 libsystem_c.dylib 0x1c65295a 0x1c608000 + 3054983 libc++abi.dylib 0x1c157708 0x1c156000 + 58964 libc++abi.dylib 0x1c16e552 0x1c156000 + 996665 libobjc.A.dylib 0x1c17731e 0x1c170000 + 294706 demoApp 0x005b6e78 0x44000 + 57135287 libc++abi.dylib 0x1c16b98e 0x1c156000 + 884628 libc++abi.dylib 0x1c16b1a2 0x1c156000 + 864349 libobjc.A.dylib 0x1c177138 0x1c170000 + 2898410 CoreFoundation 0x1ceefa84 0x1cdf5000 + 102669211 QuartzCore 0x1fd6f82a 0x1fc7c000 + 99741812 QuartzCore 0x1fd6f9e2 0x1fc7c000 + 99785813 QuartzCore 0x1fd70048 0x1fc7c000 + 99949614 RBPlayer 0x0148a248 0x1477000 + 7840815 RBPlayer 0x014813e8 0x1477000 + 4196016 CoreFoundation 0x1ce9bdb8 0x1cdf5000 + 68344817 CoreFoundation 0x1ce9b6f8 0x1cdf5000 + 68172018 CoreFoundation 0x1ce9b4e0 0x1cdf5000 + 68118419 CoreFoundation 0x1cef6308 0x1cdf5000 + 105344820 CoreFoundation 0x1cdff034 0x1cdf5000 + 4101221 Foundation 0x1d74c0ac 0x1d746000 + 2474822 Foundation 0x1d750b2a 0x1d746000 + 4381823 RBPlayer 0x0147f444 0x1477000 + 3386024 AVFoundation 0x237bff7a 0x23759000 + 42175425 AVFoundation 0x237c0626 0x23759000 + 42346226 AVFoundation 0x237c1648 0x23759000 + 42759227 libdispatch.dylib 0x1c5bd796 0x1c5bc000 + 603828 libdispatch.dylib 0x1c5bd782 0x1c5bc000 + 601829 libdispatch.dylib 0x1c5c1d04 0x1c5bc000 + 2381230 CoreFoundation 0x1ceabd68 0x1cdf5000 + 74890431 CoreFoundation 0x1cea9e18 0x1cdf5000 + 74088832 CoreFoundation 0x1cdfd0ee 0x1cdf5000 + 3300633 CoreFoundation 0x1cdfcf10 0x1cdf5000 + 3252834 GraphicsServices 0x1e5a7b40 0x1e59e000 + 3974435 UIKit 0x22181e82 0x22110000 + 46656236 demoApp 0x0010b2ac 0x44000 + 81578837 libdyld.dylib 0x1c5ea4ea 0x1c5e7000 + 13546### å…¶ä»–çº¿ç¨‹ ###Thread 1 name: Dispatch queue: com.apple.root.default-qosThread 1:0 libsystem_kernel.dylib 0x1c6bde7c 0x1c6a8000 + 897241 libsystem_c.dylib 0x1c6120e8 0x1c608000 + 411922 Foundation 0x1d834c36 0x1d746000 + 9779743 demoApp 0x00228310 0x44000 + 19832484 libdispatch.dylib 0x1c5bd796 0x1c5bc000 + 60385 libdispatch.dylib 0x1c5cab1c 0x1c5bc000 + 601886 libdispatch.dylib 0x1c5cc1b4 0x1c5bc000 + 659727 libdispatch.dylib 0x1c5cc00e 0x1c5bc000 + 655508 libsystem_pthread.dylib 0x1c7728ec 0x1c771000 + 63809 libsystem_pthread.dylib 0x1c7724cc 0x1c771000 + 5324Thread 2 name: com.apple.uikit.eventfetch-threadThread 2:0 libsystem_kernel.dylib 0x1c6a8900 0x1c6a8000 + 23041 libsystem_kernel.dylib 0x1c6a86e0 0x1c6a8000 + 17602 CoreFoundation 0x1ceabbe2 0x1cdf5000 + 7485143 CoreFoundation 0x1ceaa064 0x1cdf5000 + 741476...Thread 3 name: com.apple.NSURLConnectionLoaderThread 3:0 libsystem_kernel.dylib 0x1c6a8900 0x1c6a8000 + 23041 libsystem_kernel.dylib 0x1c6a86e0 0x1c6a8000 + 17602 CoreFoundation 0x1ceabbe2 0x1cdf5000 + 7485143 CoreFoundation 0x1ceaa064 0x1cdf5000 + 7414764 CoreFoundation 0x1cdfd0ee 0x1cdf5000 + 33006...... ...Thread 0 crashed with ARM Thread State (32-bit): r0: 0x00000000 r1: 0x00000000 r2: 0x00000000 r3: 0x0000006e r4: 0x00000006 r5: 0x3a697e40 r6: 0x397d430c r7: 0x00c88044 r8: 0x00000002 r9: 0x00000000 r10: 0x40000000 r11: 0x158ee214 ip: 0x00000148 sp: 0x00c88038 lr: 0x1c7760f7 pc: 0x1c6bdacc cpsr: 0x00000010### 5.åŠ¨æ€åº“ä¿¡æ¯ ###Binary Images:0x44000 - 0x85ffff demoApp armv7 &lt;4d8140e3978f35d29c938c2659aa766d&gt; /var/containers/Bundle/Application/0C5CCF0C-6A7F-4864-BD5A-0765725E0CCB/demoApp.app/demoApp0xa4d000 - 0xa78fff AFNetworking armv7 &lt;f0d55a034b7f3eb7b90a1214a8639f1a&gt; /var/containers/Bundle/Application/0C5CCF0C-6A7F-4864-BD5A-0765725E0CCB/demoApp.app/Frameworks/AFNetworking.framework/AFNetworking0x1477000 - 0x1496fff RBPlayer armv7 &lt;f03427c9cf4e32ddae455c67d3a157ac&gt; /var/containers/Bundle/Application/0C5CCF0C-6A7F-4864-BD5A-0765725E0CCB/demoApp.app/Frameworks/RBPlayer.framework/RBPlayerEOF è¿›ç¨‹ä¿¡æ¯ç¬¬ä¸€éƒ¨åˆ†æ˜¯é—ªé€€è¿›ç¨‹çš„ç›¸å…³ä¿¡æ¯ã€‚ Incident Identifieræ˜¯å´©æºƒæŠ¥å‘Šçš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ CrashReporter Keyæ˜¯ä¸Žè®¾å¤‡æ ‡è¯†ç›¸å¯¹åº”çš„å”¯ä¸€é”®å€¼ã€‚è™½ç„¶å®ƒä¸æ˜¯çœŸæ­£çš„è®¾å¤‡æ ‡è¯†ç¬¦ï¼Œä½†ä¹Ÿæ˜¯ä¸€ä¸ªéžå¸¸æœ‰ç”¨çš„æƒ…æŠ¥:å¦‚æžœä½ çœ‹åˆ° 100 ä¸ªå´©æºƒæ—¥å¿—çš„ CrashReporter Key å€¼éƒ½æ˜¯ç›¸åŒçš„ï¼Œæˆ–è€…åªæœ‰å°‘æ•°å‡ ä¸ªä¸åŒçš„ CrashReport å€¼ï¼Œè¯´æ˜Žè¿™ä¸æ˜¯ä¸€ä¸ªæ™®éçš„é—®é¢˜ï¼Œåªå‘ç”Ÿåœ¨ä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªè®¾å¤‡ä¸Šã€‚ Hardware Model æ ‡è¯†è®¾å¤‡ç±»åž‹ã€‚ å¦‚æžœå¾ˆå¤šå´©æºƒæ—¥å¿—éƒ½æ˜¯æ¥è‡ªç›¸åŒçš„è®¾å¤‡ç±»åž‹ï¼Œè¯´æ˜Žåº”ç”¨åªåœ¨æŸç‰¹å®šç±»åž‹çš„è®¾å¤‡ä¸Šæœ‰é—®é¢˜ã€‚ä¸Šé¢çš„æ—¥å¿—é‡Œï¼Œå´©æºƒæ—¥å¿—äº§ç”Ÿçš„è®¾å¤‡æ˜¯ iPhone 5 ã€‚ Process æ˜¯åº”ç”¨åç§°ã€‚ä¸­æ‹¬å·é‡Œé¢çš„æ•°å­—æ˜¯é—ªé€€æ—¶åº”ç”¨çš„è¿›ç¨‹IDã€‚ åŸºæœ¬ä¿¡æ¯ VersionAPPçš„ç‰ˆæœ¬å· OS VersioniOSæ“ä½œç³»ç»Ÿç‰ˆæœ¬å· iPhone OS 10.3.1 (14E304)10.3.1ï¼šç³»ç»Ÿç‰ˆæœ¬14E304ï¼šbuild å·è¿™é‡Œè¦æ‰€ä»¥ä¸‹ build å·ã€‚æ¯ä¸ªç³»ç»Ÿç‰ˆæœ¬å·æœ‰å¯èƒ½ä¼šå¯¹åº”å¤šä¸ª build å·ã€‚å¦‚è‹¹æžœå‘å¸ƒçš„ 10.3.1 ä¼šæœ‰å‡ ä¸ªç‰ˆæœ¬ï¼Œå¦‚ï¼šç”µä¿¡ç‰ˆæœ¬ã€è”é€šç‰ˆæœ¬ç­‰ã€‚build å·æˆ‘ä»¬åŽé¢å¯¹æ—¥å¿—ç¬¦å·åŒ–çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚ å¼‚å¸¸ä¿¡æ¯åœ¨è¿™éƒ¨åˆ†ï¼Œä½ å¯ä»¥çœ‹åˆ°é—ªé€€å‘ç”Ÿæ—¶æŠ›å‡ºçš„å¼‚å¸¸ç±»åž‹ã€‚è¿˜èƒ½çœ‹åˆ°å¼‚å¸¸ç¼–ç å’ŒæŠ›å‡ºå¼‚å¸¸çš„çº¿ç¨‹ã€‚æ ¹æ®å´©æºƒæŠ¥å‘Šç±»åž‹çš„ä¸åŒï¼Œåœ¨è¿™éƒ¨åˆ†ä½ è¿˜èƒ½çœ‹åˆ°ä¸€äº›å¦å¤–çš„ä¿¡æ¯ã€‚ Crashed Threadcrash çº¿ç¨‹å·ã€‚å¯ä»¥æ ¹æ®è¿™ä¸ªç¼–å·æ‰¾åˆ°å¯¹åº”çš„ crash è°ƒç”¨å †æ ˆï¼Œå½“å‰crash çº¿ç¨‹çš„ç¼–å·ä¸º 0ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æŽ¥æ‰¾åˆ° crash çº¿ç¨‹çš„å †æ ˆä¿¡æ¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940Thread 0 name: Dispatch queue: com.apple.main-threadThread 0 Crashed:0 libsystem_kernel.dylib 0x1c6bdacc 0x1c6a8000 + 887801 libsystem_pthread.dylib 0x1c7760f6 0x1c771000 + 207262 libsystem_c.dylib 0x1c65295a 0x1c608000 + 3054983 libc++abi.dylib 0x1c157708 0x1c156000 + 58964 libc++abi.dylib 0x1c16e552 0x1c156000 + 996665 libobjc.A.dylib 0x1c17731e 0x1c170000 + 294706 demoApp 0x005b6e78 0x44000 + 57135287 libc++abi.dylib 0x1c16b98e 0x1c156000 + 884628 libc++abi.dylib 0x1c16b1a2 0x1c156000 + 864349 libobjc.A.dylib 0x1c177138 0x1c170000 + 2898410 CoreFoundation 0x1ceefa84 0x1cdf5000 + 102669211 QuartzCore 0x1fd6f82a 0x1fc7c000 + 99741812 QuartzCore 0x1fd6f9e2 0x1fc7c000 + 99785813 QuartzCore 0x1fd70048 0x1fc7c000 + 99949614 RBPlayer 0x0148a248 0x1477000 + 7840815 RBPlayer 0x014813e8 0x1477000 + 4196016 CoreFoundation 0x1ce9bdb8 0x1cdf5000 + 68344817 CoreFoundation 0x1ce9b6f8 0x1cdf5000 + 68172018 CoreFoundation 0x1ce9b4e0 0x1cdf5000 + 68118419 CoreFoundation 0x1cef6308 0x1cdf5000 + 105344820 CoreFoundation 0x1cdff034 0x1cdf5000 + 4101221 Foundation 0x1d74c0ac 0x1d746000 + 2474822 Foundation 0x1d750b2a 0x1d746000 + 4381823 RBPlayer 0x0147f444 0x1477000 + 3386024 AVFoundation 0x237bff7a 0x23759000 + 42175425 AVFoundation 0x237c0626 0x23759000 + 42346226 AVFoundation 0x237c1648 0x23759000 + 42759227 libdispatch.dylib 0x1c5bd796 0x1c5bc000 + 603828 libdispatch.dylib 0x1c5bd782 0x1c5bc000 + 601829 libdispatch.dylib 0x1c5c1d04 0x1c5bc000 + 2381230 CoreFoundation 0x1ceabd68 0x1cdf5000 + 74890431 CoreFoundation 0x1cea9e18 0x1cdf5000 + 74088832 CoreFoundation 0x1cdfd0ee 0x1cdf5000 + 3300633 CoreFoundation 0x1cdfcf10 0x1cdf5000 + 3252834 GraphicsServices 0x1e5a7b40 0x1e59e000 + 3974435 UIKit 0x22181e82 0x22110000 + 46656236 demoApp 0x0010b2ac 0x44000 + 81578837 libdyld.dylib 0x1c5ea4ea 0x1c5e7000 + 13546 çº¿ç¨‹å›žæº¯çº¿ç¨‹å›žæº¯è¿™éƒ¨åˆ†æä¾›åº”ç”¨ä¸­æ‰€æœ‰çº¿ç¨‹çš„å›žæº¯æ—¥å¿—ã€‚ å›žæº¯æ˜¯é—ªé€€å‘ç”Ÿæ—¶æ‰€æœ‰æ´»åŠ¨å¸§æ¸…å•ã€‚å®ƒåŒ…å«é—ªé€€å‘ç”Ÿæ—¶è°ƒç”¨å‡½æ•°çš„æ¸…å•ã€‚Crash è°ƒç”¨å †æ ˆè¿™ä¸€éƒ¨åˆ†æ˜¯æˆ‘ä»¬åˆ†æž crash æœ€é‡è¦çš„ä¿¡æ¯ã€‚ä¸€èˆ¬æˆ‘ä»¬ä¼šæŠŠç„¦ç‚¹æ”¾åœ¨ crash çº¿ç¨‹çš„å †æ ˆä¸Šã€‚å› ä¸ºè¿™æ ·å¯ä»¥å¸®æˆ‘æœ€å¿«çš„æ‰¾åˆ° crash çš„åŽŸå› ã€‚ çœ‹ä¸‹é¢è¿™è¡Œæ—¥å¿—: 16 demoApp 0x005b6e78 0x44000 + 5713528 è¿™æ¡è°ƒç”¨æ ˆåŒ…æ‹¬ä¸‹é¢å››éƒ¨åˆ†ï¼š æ¨¡å—å·ï¼šè¿™é‡Œæ˜¯ 6 äºŒè¿›åˆ¶åº“åï¼šè¿™é‡Œæ˜¯ demoApp è°ƒç”¨æ–¹æ³•çš„åœ°å€ï¼šè¿™é‡Œæ˜¯ 0x005b6e78 ç¬¬å››éƒ¨åˆ†åˆ†ä¸ºä¸¤åˆ—ï¼ŒåŸºåœ°å€å’Œåç§»åœ°å€ã€‚æ­¤å¤„åŸºåœ°å€ä¸º 0x66000ï¼Œåç§»åœ°å€ä¸º 19244367ã€‚åŸºåœ°å€æŒ‡å‘ crash çš„æ¨¡å—ï¼ˆä¹Ÿæ˜¯æ¨¡å—çš„ load åœ°å€ï¼‰å¦‚ UIKitã€‚åç§»åœ°å€æŒ‡å‘ crash ä»£ç çš„è¡Œæ•°ã€‚å¦‚ä½•è½¬æ¢æˆ‘ä»¬åŽé¢è®¨è®ºã€‚è¿™äº›ä¿¡æ¯éƒ½ä¿å­˜åœ¨ dsym æ–‡ä»¶ä¸­ã€‚ åŠ¨æ€åº“ä¿¡æ¯è¿™äº›ä¿¡æ¯åŒ…æ‹¬åŠ¨æ€åº“åç§°ã€UUIDã€æ¨¡å—èµ·å§‹åœ°å€ã€æ¨¡å—ç»“æŸåœ°å€ã€æŒ‡ä»¤é›†ç§ç±»ã€å®‰è£…è·¯å¾„ç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯éƒ½æ˜¯åœ¨ç¬¦å·åŒ–å †æ ˆç”¨åˆ°çš„ã€‚åŽé¢æˆ‘ä»¬è®¨è®ºæ€Žä¹ˆç”¨ã€‚ ç‰¹åˆ«æ³¨æ„ æ³¨æ„: ä½ å¿…éœ€åŒæ—¶ä¿ç•™åº”ç”¨äºŒè¿›åˆ¶æ–‡ä»¶å’Œ .dSYM æ–‡ä»¶æ‰èƒ½å°†å´©æºƒæ—¥å¿—å®Œæ•´ç¬¦å·åŒ–ã€‚æ¯æ¬¡æäº¤åˆ° iTunes Connect çš„æž„å»ºéƒ½å¿…éœ€å½’æ¡£ä¿å­˜ã€‚.dSYM æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ç‰¹å®šç»‘å®šäºŽæ¯ä¸€æ¬¡æž„å»ºå’ŒåŽç»­æž„å»ºçš„ï¼Œå³ä½¿æ¥è‡ªç›¸åŒçš„æºä»£ç æ–‡ä»¶ï¼Œæ¯ä¸€æ¬¡æž„å»ºä¹Ÿä¸Žå…¶ä»–æž„å»ºä¸åŒï¼Œä¸èƒ½ç›¸äº’æ›¿æ¢ã€‚å¦‚æžœä½ ä½¿ç”¨ Build å’Œ Archive å‘½ä»¤,è¿™äº›æ–‡ä»¶ä¼šè‡ªåŠ¨æ”¾åœ¨é€‚å½“ä½ç½®ã€‚ å¦‚æžœä¸æ˜¯ä½¿ç”¨ Build å’Œ Archive å‘½ä»¤ï¼Œæœ€å¥½æ”¾åˆ°å•ç‹¬çš„æ–‡ä»¶å¤¹ä¿å­˜ã€‚ é™„å½•ç¬¦å·åŒ–å¥½çš„crashæ–‡ä»¶ 12345678910111213141516171819202122232425262728293031 Last Exception Backtrace:0 CoreFoundation 0x1ceefb38 __exceptionPreprocess + 1241 libobjc.A.dylib 0x1c177062 objc_exception_throw + 342 CoreFoundation 0x1ceefa80 +[NSException raise:format:] + 1043 QuartzCore 0x1fd6f826 CA::Layer::set_position(CA::Vec2&lt;double&gt; const&amp;, bool) + 2344 QuartzCore 0x1fd6f9de -[CALayer setPosition:] + 505 QuartzCore 0x1fd70044 -[CALayer setFrame:] + 4846 RBPlayer 0x01483244 -[RBPlayerSlider setValue:] (RBPlayerSlider.m:194)7 RBPlayer 0x0147a3e4 -[RBPlayerBottomMask playerUpdateCurrentSeconds] (RBPlayerBottomMask.m:111)8 CoreFoundation 0x1ce9bdb4 __CFNOTIFICATIONCENTER_IS_CALLING_OUT_TO_AN_OBSERVER__ + 69 CoreFoundation 0x1ce9b6f4 _CFXRegistrationPost + 37810 CoreFoundation 0x1ce9b4dc ___CFXNotificationPost_block_invoke + 3611 CoreFoundation 0x1cef6304 -[_CFXNotificationRegistrar find:object:observer:enumerator:] + 123812 CoreFoundation 0x1cdff030 _CFXNotificationPost + 53613 Foundation 0x1d74c0a8 -[NSNotificationCenter postNotificationName:object:userInfo:] + 6214 Foundation 0x1d750b26 -[NSNotificationCenter postNotificationName:object:] + 2615 RBPlayer 0x01478440 __32-[RBCorePlayer addTimerObserver]_block_invoke (RBCorePlayer.m:243)16 AVFoundation 0x237bff76 -[AVPeriodicTimebaseObserver _fireBlockForTime:] + 6417 AVFoundation 0x237c0622 -[AVPeriodicTimebaseObserver _handleTimeDiscontinuity] + 23418 AVFoundation 0x237c1644 __AVTimebaseObserver_timebaseNotificationCallback_block_invoke + 12219 libdispatch.dylib 0x1c5bd792 _dispatch_call_block_and_release + 620 libdispatch.dylib 0x1c5bd77e _dispatch_client_callout + 1821 libdispatch.dylib 0x1c5c1d00 _dispatch_main_queue_callback_4CF + 89822 CoreFoundation 0x1ceabd64 __CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__ + 423 CoreFoundation 0x1cea9e14 __CFRunLoopRun + 84424 CoreFoundation 0x1cdfd0ea CFRunLoopRunSpecific + 46625 CoreFoundation 0x1cdfcf0c CFRunLoopRunInMode + 10026 GraphicsServices 0x1e5a7b3c GSEventRunModal + 7627 UIKit 0x22181e7e UIApplicationMain + 14628 VaccineSale 0x001042a8 main (main.m:15)29 libdyld.dylib 0x1c5ea4e6 _dyld_process_info_notify_release + 26 ä»Žç¬¦å·åŒ–å®Œçš„å †æ ˆä¿¡æ¯å¯ä»¥æ¸…æ¥šçš„çœ‹å‡º å´©æºƒæ˜¯ç”± RBPlayer ç±» RBPlayerSlider æ–‡ä»¶ setValue: æ–¹æ³•ä¸­ ç¬¬ 194 è¡Œå¼•èµ·çš„. è¯¥è¡Œå¯¹ layer çš„ frame å’Œ position è¿›è¡Œèµ‹å€¼æ“ä½œæ—¶å¼•èµ·äº†å´©æºƒ. â€“åŽŸåˆ›æ‰€æœ‰,è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ã€‚]]></content>
      <tags>
        <tag>crash ç¬¦å·åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CALayer å…¥é—¨æŒ‡å¼•]]></title>
    <url>%2F2016%2F10%2F04%2FCALayer-%E5%85%A5%E9%97%A8%E6%8C%87%E5%BC%95.html</url>
    <content type="text"><![CDATA[æœ¬ç¯‡æ–‡ç« å°†ä¼šä»‹ç» iOS ä¸­ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„è¯é¢˜: layers .ä½ å¯èƒ½å·²ç»ç†Ÿæ‚‰iOSä¸­å„ç§å„æ ·çš„views,ä½†å¯èƒ½è¿˜ä¸çŸ¥é“æ¯ä¸€ä¸ªviewèƒŒåŽéƒ½æœ‰ä¸€ä¸ªå«åš layer çš„ä¸œè¥¿å­˜åœ¨.è€Œlayersæ˜¯ç»„æˆ Core Animation framework çš„é‡è¦ä¸€éƒ¨åˆ†. ä½ å¯èƒ½è¿˜ä¸äº†è§£ layer çš„ä½œç”¨,ç”šè‡³è§‰å¾—è‡ªå·±ä»Žæ¥ä¸æ›¾ä½¿ç”¨è¿‡ layer ,å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæ— è¶³è½»é‡çš„ä¸œè¥¿, ä¸ç®¡ä½ æ˜¯å¦äº†è§£ layer ,ä½ çš„appä¸­åˆ°å¤„éƒ½æ˜¯ layer çš„èº«å½±.ä½ appä¸­æ¯ä¸ª view çš„èƒŒåŽéƒ½æœ‰ä¸ª layer åœ¨æ”¯æ’‘.æ˜¯å®ƒè®©ä½ çš„ app è½»æ¾åœ°å°†æ¯ä¸ª view çš„ä½å›¾ä¿¡æ¯æä¾›ç»™æ‰‹æœº GPUs ç»˜åˆ¶.ä¸‹é¢çš„è¿™å¼ å›¾ç‰‡æ¸…æ¥šçš„å±•ç¤ºäº† Core Animation åœ¨ iOS ç»˜åˆ¶å±‚çº§ä¸­çš„ä½ç½®. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ Layers?åœ¨æ™ºèƒ½æ‰‹æœºä¸Š,ç”¨æˆ·å¸Œæœ›èƒ½å¤Ÿé£žé€Ÿçš„è¿›è¡Œå„ç§æ“ä½œ.æ‰€ä»¥ä¿æŒç•Œé¢ç¨³å®šçš„åˆ·æ–°å¸§çŽ‡ç»™ç”¨æˆ·ä¸æ»‘èˆ¬çš„æ„Ÿè§‰å°±æ˜¾å¾—å°¤ä¸ºé‡è¦.åœ¨ iOS ç³»ç»Ÿä¸­å±å¹•å¹³å‡æ¯ç§’é’Ÿåˆ·æ–° 60 æ¬¡,ä¸ºäº†ä¿è¯ç³»ç»Ÿåœ¨è¿™ä¸ªå¸§çŽ‡ä¸‹ç¨³å®šè¿è¡Œ,æœ€åŸºæœ¬åŒæ—¶ä¹Ÿæœ€å¼ºå¤§çš„èƒ½å¤Ÿåœ¨ GPU ä¸Šç²¾å‡†è¿è¡Œçš„ OpenGL å°±è¯žç”Ÿäº†.OpenGL æä¾›äº†æ‰‹æœºå›¾å½¢ç¡¬ä»¶æœ€ä½Žå±‚ä½†ä¹Ÿæ˜¯æœ€å¿«çš„æƒé™.ä½†è¿™ä¹Ÿæ˜¯éœ€è¦æƒè¡¡çš„,OpenGLè¿‡äºŽä½Žå±‚,ç”šè‡³å®Œæˆæœ€ç®€å•çš„ä»»åŠ¡éƒ½éœ€è¦å¤§é‡çš„ä»£ç . ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜, Core Graphocs å°±è¯žç”Ÿäº†. Core Graphocs å¯ä»¥ç”¨æ›´å°‘çš„ä»£ç æä¾›æ›´è½»é‡çš„é«˜å±‚æ¬¡çš„åŠŸèƒ½.ä¸ºäº†è®© Core Graphocs ä½¿ç”¨èµ·æ¥æ›´ç®€å•, Core Animation ä¹Ÿå‡ºçŽ°äº†. Core Animation æä¾›äº† CALayer ç±»,å¹¶ä¸”èƒ½å¤Ÿä½¿ç”¨ä¸€äº›åŸºæœ¬çš„çš„å›¾å½¢èƒ½åŠ›. åŽæ¥è‹¹æžœå…¬å¸å‘çŽ° Core Animation å¼ºå¤§çš„åŠŸèƒ½å¤§éƒ¨åˆ†åœ¨å¸¸è§„appå†…å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°.äºŽæ˜¯è‹¹æžœå…¬å¸ä¾¿æŽ¨å‡ºäº†å…·æœ‰æ›´é«˜å±‚æ¬¡å›¾å½¢æƒé™çš„ UIKit. è¿™ä¹ˆè®¾è®¡çš„å¥½å¤„å°±æ˜¯ä½ çš„ app å¯ä»¥æ ¹æ®éœ€æ±‚è‡ªç”±é€‰æ‹©ä¸åŒçš„å›¾å½¢å±‚æ¬¡åŠŸèƒ½.å…è®¸çµæ´»é€‰æ‹©éœ€è¦å®žçŽ°çš„åŠŸèƒ½æœ‰æ•ˆçš„é˜²æ­¢äº†ä¸å¿…è¦çš„ä»£ç äº§ç”Ÿ. UIKit ç¼ºç‚¹å°±æ˜¯é«˜å±‚æ¬¡çš„å›¾å½¢ API æ‰€èƒ½æä¾›çš„åŠŸèƒ½æ¯”è¾ƒå°‘.æˆ‘ä»¬å¯ä»¥è¿™ä»¶äº‹ä¸­çŸ¥é“: CALayer å¯ä»¥è®© iOS ç³»ç»Ÿå¿«é€Ÿä¾¿æ·åœ°èŽ·å¾— app é¡µé¢ä¸Š views çš„ä½å›¾ä¿¡æ¯, è¿™äº›ä¿¡æ¯å°†ä¼šäº¤ä»˜ç»™ Core Graphics ç”šè‡³ OpenGLå¤„ç† ç„¶åŽé€šè¿‡ GPU ç»˜åˆ¶åœ¨ä½ çš„æ‰‹æœºå±å¹•ä¸Š. è™½ç„¶åœ¨å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦ç›´æŽ¥ä½¿ç”¨ CALayer, ä½†æ˜¯ä½Žå±‚æ¬¡çš„ APIs æä¾›ç»™å¼€å‘è€…å¾ˆå¤šçµæ´»å¯å®šåˆ¶çš„åŠŸèƒ½,æˆ‘ä»¬åœ¨æ–‡ç« åŽé¢å°†ä¼šæåˆ°. èŽ·å¾— CALayeré€šè¿‡è®¨è®º layers ä¸ºä»€ä¹ˆå­˜åœ¨ä¹‹åŽ, è®©æˆ‘ä»¬æ¥å­¦ç€åŽ»ä½¿ç”¨! å°±åƒæˆ‘åˆšæ‰æåˆ°çš„, æ¯ä¸€ä¸ª view çš„èƒŒåŽéƒ½æœ‰ä¸ª layer æ”¯æ’‘. æˆ‘ä»¬å¯ä»¥é€šè¿‡ UIView çš„å±žæ€§æ¥èŽ·å¾—è¿™ä¸ª layer. å‡ä½¿æˆ‘ä»¬æœ‰ä¸€ä¸ª myView å¯¹è±¡, æˆ‘ä»¬å¯ä»¥å¾—åˆ°å®ƒçš„ layer å°±åƒè¿™æ ·: 1myView.layer å¥½äº†, å½“æˆ‘ä»¬æ‹¿åˆ° view çš„ layer ä¹‹åŽéƒ½èƒ½åšäº›ä»€ä¹ˆæ“ä½œå‘¢? ä½ å°†ä¼šå¯¹ä¹‹åŽæˆ‘ä»¬èƒ½åšçš„äº‹ä¹‹å¤šæ„Ÿåˆ°æƒŠå¥‡. åœ¨æŽ¥ä¸‹æ¥çš„æ–‡ç« ä¸­æˆ‘ä»¬å°†ä¼šçœ‹åˆ° layer çš„ä¸€äº›ä½¿ç”¨æ–¹æ³•å’Œæ‰€èƒ½è¾¾åˆ°çš„æ•ˆæžœ. Demo Projecté¦–å…ˆ, æ‰“å¼€ ç¤ºä¾‹å·¥ç¨‹ ,å­¦ä¹ çš„æœ€å¥½æ–¹æ³•å°±æ˜¯å®žè·µ,æŽ¥ä¸‹æ¥æˆ‘ä»¬å°†è¦åœ¨ app å†…çš„ layer ä¸Šæ·»åŠ ä¸€äº›è‡ªå®šä¹‰çš„æ•ˆæžœ. æ‰“å¼€å·¥ç¨‹ ä½ å°†ä¼šçœ‹åˆ°ç•Œé¢å¾ˆç®€æ´,ä¸€ä¸ªç©ºç™½çš„ view ä¸­é—´æœ‰ä¸€ä¸ªæ–¹å—çš„ subview. è®©æˆ‘ä»¬æ¥å¸®å®ƒç¾ŽåŒ–ä¸‹. æ‰“å¼€ ViewController.swift å¼€å§‹æ“ä½œå§. åˆ‡åœ†è§’ä½ å¯ä»¥ä½¿ç”¨ CALayer çš„ cornerRadius å±žæ€§æ¥åˆ¶ä½œåœ†è§’. è®©æˆ‘ä»¬è¯•ä¸€ä¸‹å§. åœ¨ viewDidLoad() å†… æ·»åŠ å¦‚ä¸‹ä»£ç : 1box.layer.cornerRadius = 5 æ­£å¦‚æœŸæœ›çš„é‚£æ ·,è¿™è¡Œä»£ç åœ¨ box çš„ layer ä¸Šæ·»åŠ äº†ä¸€ä¸ª 5ä¸ªç‚¹å•ä½çš„åœ†è§’. å°±æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­: è¿˜ä¸é”™å§! å¢žåŠ åœ†è§’å¼§åº¦ä¼šè®© layer æ›´åŠ çš„åœ†æ»‘,ç›¸åå‡å°‘åœ†è§’å¼§åº¦ ä¼šè®©layer æ›´åŠ çš„æ£±è§’åˆ†æ˜Ž. æ‰€æœ‰çš„ layer é»˜è®¤çš„åœ†è§’å¼§åº¦æ˜¯ 0 . å¢žåŠ é˜´å½±æ•ˆæžœé˜´å½±å¯ä»¥è®©æˆ‘ä»¬çš„ app æ›´æœ‰ç«‹ä½“æ„Ÿ,å¹¶ä¸”é˜´å½±åœ¨è®¾è®¡ç•Œé¢çš„æ—¶å€™æ˜¯éžå¸¸æœ‰å¸®åŠ©çš„.åœ¨é˜´å½±æ•ˆæžœä¸‹ æˆ‘ä»¬å¯ä»¥è®© views çœ‹èµ·æ¥åƒæ¼‚æµ®åœ¨å±å¹•ä¸Š. è®©æˆ‘ä»¬ç ”ç©¶ä¸‹ç”¨ CALayer å¦‚ä½•åˆ¶ä½œå‡ºéšå½¢æ•ˆæžœ. æŠŠä¸‹é¢ä»£ç æ’å…¥åˆ° ViewController çš„ viewDidLoad æ–¹æ³•ä¸­: 1234box.layer.shadowOffset = CGSizeMake(5, 5)box.layer.shadowOpacity = 0.7box.layer.shadowRadius = 5box.layer.shadowColor = UIColor(red: 44.0/255.0, green: 62.0/255.0, blue: 80.0/255.0, alpha: 1.0).CGColor ç¬¬ä¸€è¡Œ è®¾ç½® layer çš„é˜´å½±åç§»é‡æ˜¯ (5,5). å°†é˜´å½±çš„ layer.shadowOffset è®¾ç½®(5,5), æ„å‘³ç€è¿™ä¸ª layer çš„é˜´å½±æ˜¯åˆ° box.layer å³è¾¹ 5 ä¸ªç‚¹å•ä½è·ç¦», ä¸‹è¾¹ 5 ä¸ªå•ä½çš„è·ç¦».ç¬¬äºŒè¡Œ è®¾ç½® layer çš„é˜´å½±é€æ˜Žåº¦æ˜¯ 0.7 . æ„å‘³ç€è¿™ä¸ªé˜´å½±åº”è¯¥æ˜¯70%çš„ä¸é€æ˜Žåº¦.ç¬¬ä¸‰è¡Œ è®¾ç½®çš„æ˜¯ layer çš„é˜´å½±åŠå¾„æ˜¯5ä¸ªç‚¹. é˜´å½±çš„èŒƒå›´æ˜¯ box.layer çš„æ¨¡ç³Šå¼§åº¦å†³å®šçš„.æ›´é«˜çš„å¼§åº¦ä¼šè®©é˜´å½±çš„èŒƒå›´æ›´å¹¿,ä½†æ˜¯æ›´åŠ æ¨¡ç³Šä¸å¯è§.æ›´ä½Žçš„å¼§åº¦ä¼šè®©é˜´å½±æ›´åŠ æ¸…æ™°å¯è§åº¦æ›´é«˜. ç¬¬å››è¡Œ è®¾ç½®çš„æ˜¯é˜´å½±çš„é¢œè‰²æ˜¯æ·±è“. æ³¨æ„è¿™é‡Œçš„é¢œè‰²å±žæ€§æ˜¯ CGColor ç±»åž‹. è€Œä¸æ˜¯ UIColor. è¿™ä¸¤ä¸ªé¢œè‰²ç±»çš„è½¬æ¢æ˜¯éžå¸¸ç®€å•çš„,ä½ åªéœ€è¦å†™æˆ myUIColor.CGColor. è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ•ˆæžœ: æ·»åŠ è¾¹æ¡† æˆ‘ä»¬èƒ½å¤Ÿè½»æ˜“åœ°ä½¿ç”¨ CALayer æ·»åŠ è¾¹æ¡†.è®©æˆ‘ä»¬ç»™ box æ·»åŠ ä¸€ä¸ªè¾¹æ¡†. 12box.layer.borderColor = UIColor.blueColor().CGColorbox.layer.borderWidth = 3 ç¬¬ä¸€è¡Œ è®¾ç½® box çš„è¾¹æ¡†é¢œè‰²æ˜¯è“è‰².è¿™å°†ä¼šè®© box çš„æ‰€æœ‰è¾¹æ¡†éƒ½æ˜¯è“è‰²çš„.ç¬¬äºŒè¡Œ è®¾ç½®è¾¹æ¡†çº¿æ¡çš„å®½åº¦æ˜¯ 3 ç‚¹. ä¹Ÿå°±æ˜¯ box çš„è¾¹æ¡†åŽšåº¦æ˜¯ 3 ä¸ªç‚¹çš„å•ä½. è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ boxæ·»åŠ è¾¹æ¡†ä¹‹åŽçš„æ•ˆæžœ: æ¸²æŸ“å›¾ç‰‡ä½ ä¹Ÿå¯ä»¥å§ä¸€å¼ å›¾ç‰‡èµ‹å€¼ç»™ layer è¿™æ · layer å°±ä¼šå°†è¿™å¼ å›¾ç‰‡æ¸²æŸ“å‡ºæ¥. åœ¨è¿™é‡Œæœ‰ä¸€å¼ æ ‘çš„å›¾ç‰‡, è®©æˆ‘ä»¬è¯•ç€ç”¨ layer æ¥æ˜¾ç¤ºè¿™å¼ å›¾ç‰‡.æŠŠä¸‹é¢çš„ä»£ç æ’å…¥åˆ° viewDidLoad: 123box.layer.contents = UIImage(named: &quot;tree.jpg&quot;)?.CGImagebox.layer.contentsGravity = kCAGravityResizebox.layer.masksToBounds = true ç¬¬ä¸€è¡Œ å°†å›¾ç‰‡èµ‹å€¼ç»™ layer çš„ contents å±žæ€§.ç¬¬äºŒè¡Œ å°† layer çš„å†…å®¹è¿™æ˜¯æˆè‡ªé€‚åº”å¤§å°, å›¾ç‰‡ä¼šè‡ªé€‚åº” layer å¤§å°.ç¬¬ä¸‰è¡Œ å°† layer çš„ä»»ä½• æ‰©å±•åˆ° layer å¤–çš„å­ layer éƒ¨åˆ†éƒ½å‰ªåˆ‡æŽ‰.å¦‚æžœä½ ä¸æ˜Žç™½æ˜¯ä»€ä¹ˆæ„æ€.ä½ å¯ä»¥å°† masksToBounds è®¾ç½®æˆ false æ¥çœ‹çœ‹ä»–ä»¬çš„åŒºåˆ« (é˜´å½±è¢«è£å‰ªæŽ‰äº†): èƒŒæ™¯é¢œè‰²å’Œä¸é€æ˜Žåº¦ç ”ç©¶äº†åœ¨ layer æ·»åŠ ä¸€äº› UIKit æ— æ³•å®žçŽ°çš„ç‰¹æ®Šæ•ˆæžœ. æˆ‘ä»¬ä¹Ÿåº”è¯¥è®¨è®ºä¸‹é€šè¿‡ CALayer æ¥ä¿®æ”¹ UIKit ç±»çš„å±žæ€§çš„å¯èƒ½æ€§. æ¯”å¦‚ ä½ å¯ä»¥ä¿®æ”¹ view çš„èƒŒæ™¯é¢œè‰²å’Œä¸é€æ˜Žåº¦: 12box.layer.backgroundColor = UIColor.blueColor().CGColorbox.layer.opacity = 0.5 CALayer çš„æ€§èƒ½åœ¨ layers ä¸Šæ·»åŠ å¤ªå¤šçš„ç‰¹æ®Šæ•ˆæžœä¼šå½±å“åˆ°æ€§èƒ½, çŽ°åœ¨æˆ‘ä»¬æ¥èŠä¸€èŠå¯ä»¥å¸®åŠ©æˆ‘ä»¬æé«˜ app æ€§èƒ½çš„ 2 ä¸ª CALayer å±žæ€§. é¦–å…ˆæ˜¯ drawsAsynchronously å±žæ€§.è¿™ä¸ªå±žæ€§å†³å®š CPU æ˜¯å¦åº”è¯¥åœ¨å­çº¿ç¨‹é‡Œæ¸²æŸ“ layer. å¦‚æžœè®¾ç½®æˆ true, è¿™ä¸ª layer çœ‹èµ·æ¥åƒæˆ‘ä»¬å¹³æ—¶çœ‹åˆ°çš„æ ·å­, ä½†æ˜¯ CPU éœ€è¦åœ¨å­çº¿ç¨‹ä¸­æ¥è®¡ç®—å’Œæ¸²æŸ“å®ƒ.å¦‚æžœä½ çš„ app é‡Œé¢æœ‰ä¸€ä¸ª view éœ€è¦é¢‘ç¹é‡ç»˜(æ¯”å¦‚ä¸€ä¸ªåœ°å›¾view æˆ–è€… tableView),ä½ éœ€è¦å°†è¿™ä¸ªå±žæ€§è®¾ç½®ä¸º true; ç¬¬äºŒä¸ªå±žæ€§æ˜¯ shouldRasterize,è¿™ä¸ªå±žæ€§å†³å®šè¿™ layer æ˜¯å¦ä¼šæ …æ ¼åŒ–.å½“è¿™ä¸ªå±žæ€§è®¾ç½®ä¸º true åŽ,è¿™ä¸ª layer åªä¼šè¢«ç»˜åˆ¶ä¸€æ¬¡,å½“å®ƒå…·æœ‰åŠ¨ç”»æ—¶ layerä¸ä¼šè¢«æ¸²æŸ“ å¹¶ä¸”ç¬¬ä¸€æ¬¡ç»˜åˆ¶çš„ä½å›¾ä¿¡æ¯å°†ä¼šè¢«å›žæ”¶.å½“ä½ çš„appæœ‰ä¸€ä¸ªä¸éœ€è¦é¢‘ç¹ç»˜åˆ¶çš„ view æ—¶ ä½ å¯ä»¥æŠŠè¿™ä¸ªå±žæ€§è®¾ç½®ä¸º true. æ³¨æ„ å½“ä½ è®¾ç½®äº†shouldRasterizeå±žæ€§åŽ,layer çš„å¤–è§‚å¯èƒ½åœ¨ Retina å±ä¸Šæœ‰é”¯é½¿. è¿™æ˜¯å› ä¸º layer æœ‰ä¸€ä¸ªæŽ§åˆ¶ layer çš„æ …æ ¼åŒ–å› å­ rasterizationScale.ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µ. å°† layer çš„ rasterizationScale è®¾ç½®æˆ UIScreen.mainScreen().scale è¿™æ ·å°±ä¸ä¼šå‡ºçŽ°é”¯é½¿äº†. æ …æ ¼åŒ– æ˜¯PSä¸­çš„ä¸€ä¸ªä¸“ä¸šæœ¯è¯­ï¼Œæ …æ ¼å³åƒç´ ï¼Œæ …æ ¼åŒ–å³å°†çŸ¢é‡å›¾å½¢è½¬åŒ–ä¸ºä½å›¾ã€‚å¼€å¯ shouldRasterize åŽ, CALayer ä¼šè¢«æ …æ ¼åŒ–ä¸º bitmap , layer çš„é˜´å½±ç­‰æ•ˆæžœä¹Ÿä¼šè¢«ä¿å­˜åˆ° bitmap ä¸­ã€‚ é¿å… shouldRasterize å’Œ drawsAsynchronously çš„è¿‡åº¦ä½¿ç”¨å½“æˆ‘ä»¬å¼€å¯å…‰æ …åŒ–åŽ,éœ€è¦æ³¨æ„ä¸‰ç‚¹é—®é¢˜ã€‚ å¦‚æžœæˆ‘ä»¬æ›´æ–°å·²å…‰æ …åŒ–çš„layer,ä¼šé€ æˆå¤§é‡çš„ offscreen æ¸²æŸ“ã€‚ offscreen rendringæŒ‡çš„æ˜¯åœ¨å›¾åƒåœ¨ç»˜åˆ¶åˆ°å½“å‰å±å¹•å‰,éœ€è¦å…ˆè¿›è¡Œä¸€æ¬¡æ¸²æŸ“,ä¹‹åŽæ‰ç»˜åˆ¶åˆ°å½“å‰å±å¹•ã€‚offscreenæ¸²æŸ“ä¼šè€—è´¹å¤§é‡èµ„æº. å› æ­¤ CALayer çš„å…‰æ …åŒ–é€‰é¡¹çš„å¼€å¯ä¸Žå¦éœ€è¦æˆ‘ä»¬ä»”ç»†è¡¡é‡ä½¿ç”¨åœºæ™¯ã€‚ åªèƒ½ç”¨åœ¨å›¾åƒå†…å®¹ä¸å˜çš„å‰æä¸‹çš„ï¼š ç”¨äºŽé¿å…é™æ€å†…å®¹çš„å¤æ‚ç‰¹æ•ˆçš„é‡ç»˜,ä¾‹å¦‚å‰é¢è®²åˆ°çš„UIBlurEffectç”¨äºŽé¿å…å¤šä¸ªViewåµŒå¥—çš„å¤æ‚Viewçš„é‡ç»˜ã€‚è€Œå¯¹äºŽç»å¸¸å˜åŠ¨çš„å†…å®¹,è¿™ä¸ªæ—¶å€™ä¸è¦å¼€å¯,å¦åˆ™ä¼šé€ æˆæ€§èƒ½çš„æµªè´¹ã€‚ ä¾‹å¦‚æˆ‘ä»¬æ—¥ç¨‹ç»å¸¸æ‰“äº¤é“çš„ TableViewCell ,å› ä¸º TableViewCell çš„é‡ç»˜æ˜¯å¾ˆé¢‘ç¹çš„ï¼ˆå› ä¸ºCell çš„å¤ç”¨ï¼‰,å¦‚æžœCellçš„å†…å®¹ä¸æ–­å˜åŒ–,åˆ™ Cell éœ€è¦ä¸æ–­é‡ç»˜,å¦‚æžœæ­¤æ—¶è®¾ç½®äº†cell.layer å¯å…‰æ …åŒ–ã€‚åˆ™ä¼šé€ æˆå¤§é‡çš„ offscreen æ¸²æŸ“,é™ä½Žå›¾å½¢æ€§èƒ½ã€‚ å½“ç„¶,åˆç†åˆ©ç”¨çš„è¯,æ˜¯èƒ½å¤Ÿå¾—åˆ°ä¸å°‘æ€§èƒ½çš„æé«˜çš„,å› ä¸ºä½¿ç”¨ shouldRasterize åŽ layer ä¼šç¼“å­˜ä¸ºBitmapä½å›¾,å¯¹ä¸€äº›æ·»åŠ äº† shawdow ç­‰æ•ˆæžœçš„è€—è´¹èµ„æºè¾ƒå¤šçš„é™æ€å†…å®¹è¿›è¡Œç¼“å­˜,èƒ½å¤Ÿå¾—åˆ°æ€§èƒ½çš„æå‡ã€‚ ä¸è¦è¿‡åº¦ä½¿ç”¨,ç³»ç»Ÿé™åˆ¶äº†ç¼“å­˜çš„å¤§å°ä¸º 2.5 x Screen Size.å¦‚æžœè¿‡åº¦ä½¿ç”¨,è¶…å‡ºç¼“å­˜ä¹‹åŽ,åŒæ ·ä¼šé€ æˆå¤§é‡çš„ offscreen æ¸²æŸ“ã€‚è¢«å…‰æ …åŒ–çš„å›¾ç‰‡å¦‚æžœè¶…è¿‡ 100ms æ²¡æœ‰è¢«ä½¿ç”¨,åˆ™ä¼šè¢«ç§»é™¤ å› æ­¤æˆ‘ä»¬åº”è¯¥åªå¯¹è¿žç»­ä¸æ–­ä½¿ç”¨çš„å›¾ç‰‡è¿›è¡Œç¼“å­˜ã€‚å¯¹äºŽä¸å¸¸ä½¿ç”¨çš„å›¾ç‰‡ç¼“å­˜æ˜¯æ²¡æœ‰æ„ä¹‰,ä¸”è€—è´¹èµ„æºçš„ã€‚ åŸºäºŽ 99% çš„æƒ…å†µä¸‹ ä½ éƒ½ä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®è¿™ä¸¤ä¸ªå±žæ€§.ä¸å½“çš„è®¾ç½®å®ƒä»¬å¯èƒ½ä¼šåè€Œå¯¼è‡´ä½  app çš„æ€§èƒ½å˜å¾—æ›´ç³Ÿ. é¢˜å¤– å…³äºŽ offscreen rendering æ³¨æ„åˆ°ä¸Šé¢æåˆ°çš„ offscreen rendering ã€‚æˆ‘ä»¬éœ€è¦æ³¨æ„ shouldRasterize çš„åœ°æ–¹å°±æ˜¯ä¼šé€ æˆ offscreen rendering çš„åœ°æ–¹,é‚£ä¹ˆä¸ºä»€ä¹ˆéœ€è¦é¿å…å‘¢ï¼ŸWWDC 2011 Understanding UIKit Rendering æŒ‡å‡ºä¸€èˆ¬å¯¼è‡´å›¾å½¢æ€§èƒ½çš„é—®é¢˜å¤§éƒ¨åˆ†éƒ½å‡ºåœ¨äº† offscreen rendering ,å› æ­¤å¦‚æžœæˆ‘ä»¬å‘çŽ°åˆ—è¡¨æ»šåŠ¨ä¸æµç•…,åŠ¨ç”»å¡é¡¿ç­‰é—®é¢˜,å°±å¯ä»¥æƒ³æƒ³å’Œæ‰¾å‡ºæˆ‘ä»¬å“ªéƒ¨åˆ†ä»£ç å¯¼è‡´äº†å¤§é‡çš„ offscreen æ¸²æŸ“ã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆ offscreen æ¸²æŸ“ä¼šè€—è´¹å¤§é‡èµ„æºå‘¢ï¼ŸåŽŸå› æ˜¯æ˜¾å¡éœ€è¦å¦å¤– alloc ä¸€å—å†…å­˜æ¥è¿›è¡Œæ¸²æŸ“,æ¸²æŸ“å®Œæ¯•åŽåœ¨ç»˜åˆ¶åˆ°å½“å‰å±å¹•,è€Œä¸”å¯¹äºŽæ˜¾å¡æ¥è¯´, onscreen åˆ° offscreen çš„ä¸Šä¸‹æ–‡çŽ¯å¢ƒåˆ‡æ¢æ˜¯éžå¸¸æ˜‚è´µçš„(æ¶‰åŠåˆ° OpenGL çš„ pipelines å’Œ barrier ç­‰),æˆ‘ä»¬åœ¨å¼€å‘åº”ç”¨,æé«˜æ€§èƒ½é€šå¸¸è¦æ³¨æ„çš„æ˜¯é¿å… offscreen rendering ã€‚ä¸éœ€è¦çº ç»“å’Œæ‹˜æ³¥äºŽå®ƒçš„å®šä¹‰.æœ‰å…´è¶£å¯ä»¥ç»§ç»­é˜…è¯» Andy Matuschak , å‰ UIKit team æˆå‘˜å…³äºŽoffscreen rendering çš„ è¯„è®º ã€‚ æ€»ä¹‹,æˆ‘ä»¬é€šå¸¸éœ€è¦é¿å…å¤§é‡çš„offscreen rendering.ä¼šé€ æˆ offscreen renderingçš„åŽŸå› æœ‰ï¼šAny layer with a mask (layer.mask)Any layer with layer.masksToBounds being trueAny layer with layer.allowsGroupOpacity set to YES and layer.opacity is less than 1.0Any layer with a drop shadow (layer.shadow*).Any layer with layer.shouldRasterize being trueAny layer with layer.cornerRadius, layer.edgeAntialiasingMask,layer.allowsEdgeAntialiasing å› æ­¤,å¯¹äºŽä¸€äº›éœ€è¦ä¼˜åŒ–å›¾åƒæ€§èƒ½çš„åœºæ™¯,æˆ‘ä»¬å¯ä»¥æ£€æŸ¥æˆ‘ä»¬æ˜¯å¦è§¦å‘äº† offscreen rendering ã€‚å¹¶ç”¨æ›´é«˜æ•ˆçš„å®žçŽ°æ‰‹æ®µæ¥æ›¿æ¢ã€‚é˜´å½±ç»˜åˆ¶:è£å‰ªå›¾ç‰‡ä¸ºåœ†:Blending çš„è¿‡å¤šä½¿ç”¨æ£€æŸ¥æœ‰æ— è¿‡å¤šoffscreenæ¸²æŸ“æ£€æŸ¥æœ‰æ— è¿‡å¤šBlendingæ£€æŸ¥æœ‰æ— ä¸æ­£ç¡®å›¾ç‰‡æ ¼å¼,å›¾ç‰‡æ˜¯å¦è¢«æ”¾ç¼©,åƒç´ æ˜¯å¦å¯¹é½ã€‚æ£€æŸ¥æœ‰æ— ä½¿ç”¨å¤æ‚çš„å›¾å½¢æ•ˆæžœã€‚ â€“ åŽŸåˆ›æ‰€æœ‰,è½¬è½½è¯·æ³¨æ˜Žå‡ºå¤„ã€‚]]></content>
      <tags>
        <tag>CALayer</tag>
      </tags>
  </entry>
</search>